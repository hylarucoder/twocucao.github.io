{"pageProps":{"post":{"tags":["Python"],"path":"20150317_扇贝背单词小助手.md","title":"背单词小助手","slug":"背单词小助手","date":"2017-12-01","category":"Python","lastMod":"2020-01-01","description":"这篇文章展示了基本的 Markdown 语法和格式.","thumbnail":"","content":"<h1 id=\"背单词小助手\"><a class=\"v-toc-item\" href=\"#背单词小助手\">#</a> 背单词小助手</h1>\n<h2 id=\"0x01-本文内容\"><a class=\"v-toc-item\" href=\"#0x01-本文内容\">#</a> 0x01 本文内容</h2>\n<h3 id=\"思路\"><a class=\"v-toc-item\" href=\"#思路\">#</a> 思路</h3>\n<ul>\n<li>英文单词的处理</li>\n<li>shanbay 单词本的提交</li>\n</ul>\n<h3 id=\"英文单词的处理\"><a class=\"v-toc-item\" href=\"#英文单词的处理\">#</a> 英文单词的处理</h3>\n<p>正则表达式进行提取，然后通过 Python 的自然语言处理工具 ntlk 进行单词原型的转换</p>\n<h3 id=\"shanbay-单词的处理\"><a class=\"v-toc-item\" href=\"#shanbay-单词的处理\">#</a> shanbay 单词的处理</h3>\n<p>由于使用了传说中的 requests，使得代码简洁程度大大提升。</p>\n<!--more-->\n<h3 id=\"代码如下\"><a class=\"v-toc-item\" href=\"#代码如下\">#</a> 代码如下</h3>\n<p>英文单词处理模块</p>\n<p>shanbay 登录以及单词的提交</p>\n<p>这是 v0.1 版本，有不少细节需要调整。有时间我会继续更新<br>\n代码 9 逻辑比较简单，自己阅读代码吧</p>\n<p><a href=\"https://github.com/twocucao/PyTools\">请来 github 这里</a></p>\n<pre><code class=\"language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> re\n\n__author__ <span class=\"token operator\">=</span> <span class=\"token string\">'micheal'</span>\n\nfrom nltk<span class=\"token punctuation\">.</span>stem <span class=\"token keyword\">import</span> WordNetLemmatizer\n\nlemmatizer <span class=\"token operator\">=</span> <span class=\"token function\">WordNetLemmatizer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n## 常量设置\n\n<span class=\"token constant\">BOOKS_FOLDER</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"Books/\"</span>\n\n<span class=\"token constant\">OUTPUTS_FOLDER</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"OutPuts/\"</span>\n\n<span class=\"token constant\">COVER_FILE</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"cover.jpg\"</span>\n\n<span class=\"token constant\">EXCLUDED_LIB_FILE</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"excluded_libs.txt\"</span>\n\n<span class=\"token constant\">SUMMARY_FILE</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"SUMMARY.json\"</span>\n\n<span class=\"token constant\">ALL_LIB_FILE</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"all.txt\"</span>\n\n### 初始化数据，\n# 创建 ALLFile\ndef <span class=\"token function\">createMergeFile</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>\n    fo <span class=\"token operator\">=</span> <span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token constant\">ALL_LIB_FILE</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'w'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">for</span> name <span class=\"token keyword\">in</span> os<span class=\"token punctuation\">.</span><span class=\"token function\">listdir</span><span class=\"token punctuation\">(</span><span class=\"token constant\">BOOKS_FOLDER</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>\n        fi <span class=\"token operator\">=</span> <span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token constant\">BOOKS_FOLDER</span> <span class=\"token operator\">+</span> name<span class=\"token punctuation\">,</span> <span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">while</span> True<span class=\"token operator\">:</span>\n            s <span class=\"token operator\">=</span> fi<span class=\"token punctuation\">.</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span> <span class=\"token operator\">*</span> <span class=\"token number\">1024</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">if</span> not s<span class=\"token operator\">:</span>\n                <span class=\"token keyword\">break</span>\n            fo<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span>\n        fi<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    fo<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    pass\n\ndef <span class=\"token function\">get_sorted_words_list_from</span><span class=\"token punctuation\">(</span>txt_path<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>\n    <span class=\"token keyword\">with</span> <span class=\"token function\">open</span><span class=\"token punctuation\">(</span>txt_path<span class=\"token punctuation\">,</span> <span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token operator\">:</span>\n        strs <span class=\"token operator\">=</span> f<span class=\"token punctuation\">.</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        s <span class=\"token operator\">=</span> re<span class=\"token punctuation\">.</span><span class=\"token function\">findall</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\w+\"</span><span class=\"token punctuation\">,</span> str<span class=\"token punctuation\">.</span><span class=\"token function\">lower</span><span class=\"token punctuation\">(</span>strs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> flags<span class=\"token operator\">=</span>re<span class=\"token punctuation\">.</span><span class=\"token constant\">ASCII</span><span class=\"token punctuation\">)</span>\n\n    ss <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">for</span> item <span class=\"token keyword\">in</span> s<span class=\"token operator\">:</span>\n        ss<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>lemmatizer<span class=\"token punctuation\">.</span><span class=\"token function\">lemmatize</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    l <span class=\"token operator\">=</span> <span class=\"token function\">sorted</span><span class=\"token punctuation\">(</span><span class=\"token function\">list</span><span class=\"token punctuation\">(</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>ss<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    ll <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> l<span class=\"token operator\">:</span>\n        m <span class=\"token operator\">=</span> re<span class=\"token punctuation\">.</span><span class=\"token function\">search</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\d+\"</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span>\n        n <span class=\"token operator\">=</span> re<span class=\"token punctuation\">.</span><span class=\"token function\">search</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\W+\"</span><span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">,</span> flags<span class=\"token operator\">=</span>re<span class=\"token punctuation\">.</span><span class=\"token constant\">ASCII</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> not m and not n and <span class=\"token function\">len</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">4</span><span class=\"token operator\">:</span>\n            ll<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span>\n            # 不属于数字也不属于非（英文 <span class=\"token operator\">+</span> 数字）并且字母长度大于 <span class=\"token number\">4</span> 的集合\n\n    <span class=\"token keyword\">return</span> ll\n\ndef <span class=\"token function\">WordCountInit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>\n    <span class=\"token function\">createMergeFile</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    excluded_words <span class=\"token operator\">=</span> <span class=\"token function\">get_sorted_words_list_from</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"excluded_libs.txt\"</span><span class=\"token punctuation\">)</span>\n\n    file <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n    folder_list <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span><span class=\"token function\">listdir</span><span class=\"token punctuation\">(</span><span class=\"token constant\">BOOKS_FOLDER</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">for</span> item <span class=\"token keyword\">in</span> folder_list<span class=\"token operator\">:</span>\n        file<span class=\"token punctuation\">[</span>item<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">get_sorted_words_list_from</span><span class=\"token punctuation\">(</span><span class=\"token constant\">BOOKS_FOLDER</span> <span class=\"token operator\">+</span> item<span class=\"token punctuation\">)</span>\n\n        words <span class=\"token operator\">=</span> file<span class=\"token punctuation\">[</span>item<span class=\"token punctuation\">]</span>\n\n        real_words <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n        <span class=\"token keyword\">for</span> word <span class=\"token keyword\">in</span> words<span class=\"token operator\">:</span>\n            <span class=\"token keyword\">if</span> word not <span class=\"token keyword\">in</span> excluded_words<span class=\"token operator\">:</span>\n                real_words<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>word<span class=\"token punctuation\">)</span>\n\n        # <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"excluded_words\\n\"</span><span class=\"token operator\">+</span><span class=\"token function\">str</span><span class=\"token punctuation\">(</span>excluded_words<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"real_words\\n\"</span> <span class=\"token operator\">+</span> <span class=\"token function\">str</span><span class=\"token punctuation\">(</span>real_words<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n        excluded_words<span class=\"token punctuation\">.</span><span class=\"token function\">extend</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">[</span>item<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">with</span> <span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token constant\">OUTPUTS_FOLDER</span> <span class=\"token operator\">+</span> item<span class=\"token punctuation\">,</span> <span class=\"token string\">\"w\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token operator\">:</span>\n            f<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token function\">str</span><span class=\"token punctuation\">(</span><span class=\"token function\">sorted</span><span class=\"token punctuation\">(</span><span class=\"token function\">list</span><span class=\"token punctuation\">(</span>real_words<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">return</span> True\n\n    # <span class=\"token function\">print</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span>\n\n</code></pre>\n<pre><code class=\"language-python\">from datetime <span class=\"token keyword\">import</span> datetime\n<span class=\"token keyword\">import</span> json\n<span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> requests\nfrom WordsCount <span class=\"token keyword\">import</span> get_sorted_words_list_from<span class=\"token punctuation\">,</span> WordCountInit\n\n__author__ <span class=\"token operator\">=</span> <span class=\"token string\">'micheal'</span>\n\nword_book_url <span class=\"token operator\">=</span> <span class=\"token string\">\"http://www.shanbay.com/wordbook/99004/\"</span>\n\nfrom nltk<span class=\"token punctuation\">.</span>stem <span class=\"token keyword\">import</span> WordNetLemmatizer\n\nlemmatizer <span class=\"token operator\">=</span> <span class=\"token function\">WordNetLemmatizer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">ShanBay</span><span class=\"token operator\">:</span>\n    # 初始化 shanbay 的基本信息\n    # <span class=\"token number\">1.</span> 登录，\n\n    # <span class=\"token number\">2</span>，创建 wordbook\n    # <span class=\"token number\">3</span>，创建 wordlist，\n    # <span class=\"token number\">4</span>，用集合填充 wordlist\n    # <span class=\"token number\">5</span>，填充策略\n    #\n\n    def <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>\n        <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"基本数据正在初始化\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token function\">WordCountInit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"初始化完毕\"</span><span class=\"token punctuation\">)</span>\n\n        self<span class=\"token punctuation\">.</span>headers <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"User-Agent\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/40.0.2214.93 Safari/537.36\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Accept\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Content-Type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"application/x-www-form-urlencoded; charset=UTF-8\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Accept-Language\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"en-US,en;q=0.5\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Accept-Encoding\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"gzip, deflate\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Connection\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"keep-alive\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"Cache-Control\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"max-age=0\"</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span>\n\n        self<span class=\"token punctuation\">.</span>index_url <span class=\"token operator\">=</span> <span class=\"token string\">\"http://www.shanbay.com/\"</span>\n\n        self<span class=\"token punctuation\">.</span>login_url <span class=\"token operator\">=</span> <span class=\"token string\">\"http://www.shanbay.com/accounts/login/\"</span>\n\n        self<span class=\"token punctuation\">.</span>sb_session <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span><span class=\"token function\">Session</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>sb_session<span class=\"token punctuation\">.</span>headers<span class=\"token punctuation\">.</span><span class=\"token function\">update</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>headers<span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>sb_session<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>login_url<span class=\"token punctuation\">)</span>\n        # 开始登录\n        # 初始化登录\n\n        <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"正在登录中\"</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span><span class=\"token function\">doLogin</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"test\"</span><span class=\"token punctuation\">)</span>\n\n        <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"单词书  情况如下 \\n\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">with</span> <span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"SUMMARY.json\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"r\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> f<span class=\"token operator\">:</span>\n            decodejson <span class=\"token operator\">=</span> json<span class=\"token punctuation\">.</span><span class=\"token function\">loads</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">.</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            self<span class=\"token punctuation\">.</span>book_info_title <span class=\"token operator\">=</span> decodejson<span class=\"token punctuation\">[</span><span class=\"token string\">\"title\"</span><span class=\"token punctuation\">]</span>\n            self<span class=\"token punctuation\">.</span>book_info_category <span class=\"token operator\">=</span> decodejson<span class=\"token punctuation\">[</span><span class=\"token string\">\"category\"</span><span class=\"token punctuation\">]</span>\n            self<span class=\"token punctuation\">.</span>book_info_description <span class=\"token operator\">=</span> decodejson<span class=\"token punctuation\">[</span><span class=\"token string\">\"description\"</span><span class=\"token punctuation\">]</span>\n            self<span class=\"token punctuation\">.</span>book_info_price <span class=\"token operator\">=</span> decodejson<span class=\"token punctuation\">[</span><span class=\"token string\">\"price\"</span><span class=\"token punctuation\">]</span>\n            <span class=\"token function\">print</span><span class=\"token punctuation\">(</span>\n                <span class=\"token string\">\"标题：\"</span> <span class=\"token operator\">+</span> self<span class=\"token punctuation\">.</span>book_info_title <span class=\"token operator\">+</span> <span class=\"token string\">\"\\n 类型：\"</span> <span class=\"token operator\">+</span> self<span class=\"token punctuation\">.</span>book_info_category <span class=\"token operator\">+</span> <span class=\"token string\">\"\\n 描述：\"</span> <span class=\"token operator\">+</span> self<span class=\"token punctuation\">.</span>book_info_description <span class=\"token operator\">+</span> <span class=\"token string\">\"\\n 价格：\"</span> <span class=\"token operator\">+</span> self<span class=\"token punctuation\">.</span>book_info_price<span class=\"token punctuation\">)</span>\n\n        self<span class=\"token punctuation\">.</span><span class=\"token function\">createWordBook</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n        ## 判断有多少个路进然后接着进行一系列的操作\n        word_list_list <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span><span class=\"token function\">listdir</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Books/\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">for</span> word_list <span class=\"token keyword\">in</span> word_list_list<span class=\"token operator\">:</span>\n            <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"正在创建\"</span> <span class=\"token operator\">+</span> word_list<span class=\"token punctuation\">)</span>\n\n            dt <span class=\"token operator\">=</span> datetime<span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n            list_id <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span><span class=\"token function\">createWordList</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>word_book_id<span class=\"token punctuation\">,</span> <span class=\"token string\">\"List\"</span> <span class=\"token operator\">+</span> dt<span class=\"token punctuation\">.</span><span class=\"token function\">strftime</span><span class=\"token punctuation\">(</span><span class=\"token string\">'%Y%m%d%H%M%S'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                                          <span class=\"token string\">\"这仅仅是一个比较简单的描述\"</span> <span class=\"token operator\">+</span> dt<span class=\"token punctuation\">.</span><span class=\"token function\">strftime</span><span class=\"token punctuation\">(</span><span class=\"token string\">'%Y%m%d%H%M%S'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n            self<span class=\"token punctuation\">.</span><span class=\"token function\">fillWordListById</span><span class=\"token punctuation\">(</span>list_id<span class=\"token punctuation\">,</span> <span class=\"token function\">get_sorted_words_list_from</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"OutPuts/\"</span> <span class=\"token operator\">+</span> word_list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n            # <span class=\"token function\">print</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>sb_session<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>index_url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span>\n\n    def <span class=\"token function\">doLogin</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> username<span class=\"token punctuation\">,</span> password<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>\n        self<span class=\"token punctuation\">.</span>login_form <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"csrfmiddlewaretoken\"</span><span class=\"token operator\">:</span> self<span class=\"token punctuation\">.</span>sb_session<span class=\"token punctuation\">.</span>cookies<span class=\"token punctuation\">[</span><span class=\"token string\">\"csrftoken\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"username\"</span><span class=\"token operator\">:</span> username<span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"password\"</span><span class=\"token operator\">:</span> password<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span>\n\n        self<span class=\"token punctuation\">.</span>sb_session<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">.</span>login_url<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">.</span>login_form<span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">return</span> True\n\n    def <span class=\"token function\">fillWordListById</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> _id<span class=\"token punctuation\">,</span> words<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>\n        # <span class=\"token string\">\"172981\"</span>\n        <span class=\"token keyword\">for</span> word <span class=\"token keyword\">in</span> words<span class=\"token operator\">:</span>\n            post_data <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token string\">\"id\"</span><span class=\"token operator\">:</span> _id<span class=\"token punctuation\">,</span>\n                <span class=\"token string\">\"word\"</span><span class=\"token operator\">:</span> word<span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span>\n            self<span class=\"token punctuation\">.</span>sb_session<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"http://www.shanbay.com/api/v1/wordlist/vocabulary/\"</span><span class=\"token punctuation\">,</span> post_data<span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">return</span> <span class=\"token number\">0</span>\n\n    def <span class=\"token function\">createWordBook</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>\n        # http<span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>www<span class=\"token punctuation\">.</span>shanbay<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>wordbook<span class=\"token operator\">/</span>create<span class=\"token operator\">/</span>basicinfo<span class=\"token operator\">/</span>\n\n        createWordBookForm <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"csrfmiddlewaretoken\"</span><span class=\"token operator\">:</span> self<span class=\"token punctuation\">.</span>sb_session<span class=\"token punctuation\">.</span>cookies<span class=\"token punctuation\">[</span><span class=\"token string\">\"csrftoken\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"title\"</span><span class=\"token operator\">:</span> self<span class=\"token punctuation\">.</span>book_info_title<span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"category\"</span><span class=\"token operator\">:</span> self<span class=\"token punctuation\">.</span>book_info_category<span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"description\"</span><span class=\"token operator\">:</span> self<span class=\"token punctuation\">.</span>book_info_description<span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"price\"</span><span class=\"token operator\">:</span> self<span class=\"token punctuation\">.</span>book_info_price<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span>\n\n        t <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>sb_session<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"http://www.shanbay.com/wordbook/create/basicinfo/\"</span><span class=\"token punctuation\">,</span> createWordBookForm<span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>word_book_id <span class=\"token operator\">=</span> <span class=\"token function\">str</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span>\n\n        # 封面没有办法提交<span class=\"token operator\">...</span><span class=\"token operator\">...</span> 以后再说\n        coverFiles <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"csrfmiddlewaretoken\"</span><span class=\"token operator\">:</span> self<span class=\"token punctuation\">.</span>sb_session<span class=\"token punctuation\">.</span>cookies<span class=\"token punctuation\">[</span><span class=\"token string\">\"csrftoken\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"cover\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'cover.jpg'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'cover.jpg'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'rb'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'image/jpeg'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'Expires'</span><span class=\"token operator\">:</span> <span class=\"token string\">'0'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"wordbook_id\"</span><span class=\"token operator\">:</span> self<span class=\"token punctuation\">.</span>word_book_id<span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"description\"</span><span class=\"token operator\">:</span> self<span class=\"token punctuation\">.</span>book_info_description<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span>\n        # files <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'file'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'report.xls'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'report.xls'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'rb'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'application/vnd.ms-excel'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'Expires'</span><span class=\"token operator\">:</span> <span class=\"token string\">'0'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n\n        self<span class=\"token punctuation\">.</span>sb_session<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"http://www.shanbay.com/wordbook/create/\"</span> <span class=\"token operator\">+</span> self<span class=\"token punctuation\">.</span>word_book_id <span class=\"token operator\">+</span> <span class=\"token string\">\"/uploadcover/\"</span><span class=\"token punctuation\">,</span>\n                             files<span class=\"token operator\">=</span>coverFiles<span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">return</span> True\n\n    def <span class=\"token function\">doMenu</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>\n        # <span class=\"token keyword\">while</span> True<span class=\"token operator\">:</span>\n        #\n        # <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span>\"\\\n        #\n        # 请输入相关操作：\n        # <span class=\"token number\">1.</span>createWordBook\n        # <span class=\"token number\">2.</span>createWordList\n        #\n        #\n        #     <span class=\"token string\">\"\"</span>\"<span class=\"token punctuation\">)</span>\n        #     self<span class=\"token punctuation\">.</span>word_book_id <span class=\"token operator\">=</span> <span class=\"token function\">input</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"word_book_id\"</span><span class=\"token punctuation\">)</span>\n        #\n        #\n        #\n\n        pass\n\n    def <span class=\"token function\">createWordList</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> _id<span class=\"token punctuation\">,</span> name<span class=\"token punctuation\">,</span> desc<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>\n        createWordListFrom <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"name\"</span><span class=\"token operator\">:</span> name<span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"description\"</span><span class=\"token operator\">:</span> desc<span class=\"token punctuation\">,</span>\n            <span class=\"token string\">\"wordbook_id\"</span><span class=\"token operator\">:</span> _id<span class=\"token punctuation\">,</span>\n\n        <span class=\"token punctuation\">}</span>\n        r <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>sb_session<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"http://www.shanbay.com/api/v1/wordbook/wordlist/\"</span><span class=\"token punctuation\">,</span> createWordListFrom<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>json<span class=\"token punctuation\">.</span><span class=\"token function\">loads</span><span class=\"token punctuation\">(</span>r<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"data\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"wordlist\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n        pass\n\nsss <span class=\"token operator\">=</span> <span class=\"token function\">ShanBay</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n</code></pre>\n<p>这个程序还是比较简单的。</p>\n<hr>\n<p>ChangeLog:</p>\n<ul>\n<li><strong>2020-11-30</strong> 重修文字</li>\n</ul>\n","toc":"<ul class=\"v-article-toc\">\n<li><a href=\"#%E8%83%8C%E5%8D%95%E8%AF%8D%E5%B0%8F%E5%8A%A9%E6%89%8B\">背单词小助手</a>\n<ul>\n<li><a href=\"#0x01-%E6%9C%AC%E6%96%87%E5%86%85%E5%AE%B9\">0x01 本文内容</a>\n<ul>\n<li><a href=\"#%E6%80%9D%E8%B7%AF\">思路</a></li>\n<li><a href=\"#%E8%8B%B1%E6%96%87%E5%8D%95%E8%AF%8D%E7%9A%84%E5%A4%84%E7%90%86\">英文单词的处理</a></li>\n<li><a href=\"#shanbay-%E5%8D%95%E8%AF%8D%E7%9A%84%E5%A4%84%E7%90%86\">shanbay 单词的处理</a></li>\n<li><a href=\"#%E4%BB%A3%E7%A0%81%E5%A6%82%E4%B8%8B\">代码如下</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n"}},"__N_SSG":true}