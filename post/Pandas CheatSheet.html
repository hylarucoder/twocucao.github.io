<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Pandas CheatSheet | 海拉鲁编程客</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/49455a07b6dd33600cdf.css" as="style"/><link rel="stylesheet" href="/_next/static/css/49455a07b6dd33600cdf.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a54b4f32bdc1ef890ddd.js"></script><script src="/_next/static/chunks/webpack-20d43e08bea62467b090.js" defer=""></script><script src="/_next/static/chunks/framework-0441fae7fd130f37dee1.js" defer=""></script><script src="/_next/static/chunks/main-4777350f2a9ff73ea2b0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-3050679c6e5142ffcaf5.js" defer=""></script><script src="/_next/static/chunks/ea88be26-9bcf6ead520f4ac26973.js" defer=""></script><script src="/_next/static/chunks/421-f2f33a86b546237f0325.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-173fe2de48c90365db9d.js" defer=""></script><script src="/_next/static/oDi_oBCBuu3qj6v7hDnrL/_buildManifest.js" defer=""></script><script src="/_next/static/oDi_oBCBuu3qj6v7hDnrL/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="v-page"><nav class="shadow"><div class="flex flex-col container mx-auto h-12 px-40 md:flex-row md:items-center md:justify-between"><div class="flex justify-between items-center"><div><a class="text-gray-800 text-xl md:text-xl leading-5" href="/">海拉鲁编程客</a></div><div><button type="button" class="block text-gray-800 hover:text-gray-600 focus:text-gray-600 focus:outline-none md:hidden"><svg viewBox="0 0 24 24" class="h-6 w-6 fill-current"><path d="M4 5h16a1 1 0 0 1 0 2H4a1 1 0 1 1 0-2zm0 6h16a1 1 0 0 1 0 2H4a1 1 0 0 1 0-2zm0 6h16a1 1 0 0 1 0 2H4a1 1 0 0 1 0-2z"></path></svg></button></div></div><div class="md:flex flex-col md:flex-row md:-mx-4 hidden"><a class="my-1 text-gray-800 hover:text-blue-500 md:mx-4 md:my-0" href="/">首页</a><a class="my-1 text-gray-800 hover:text-blue-500 md:mx-4 md:my-0" href="/archive">归档</a><a class="my-1 text-gray-800 hover:text-blue-500 md:mx-4 md:my-0" href="/about">关于我</a><button style="cursor:pointer;overflow:hidden;width:50px;height:23.5px;appearance:none;-moz-appearance:none;-webkit-appearance:none;border:none;background-color:transparent;padding:0" aria-hidden="true"><div style="display:flex;align-items:center;justify-content:center;margin-top:-28.749999999999996px;margin-left:-16px;width:82.5px;height:82.5px"><div></div></div></button></div></div></nav><div class="v-article"><div class="v-article-main" style="margin:auto;width:786px"><div><h2 id="0x00-前言"><a class="v-toc-item" href="#0x00-前言">#</a> 0x00 前言</h2>
<p>本文为 Cheatsheet 类型文章，用于记录我在日常编程中经常使用的 Pandas 相关语句。</p>
<p>主要包含：</p>
<ul>
<li>Pandas 中 Series 的一些常见操作和技巧</li>
<li>Pandas 中 Dateframe 的一些常见操作和技巧</li>
<li>Python 里的可视化技巧</li>
<li>Pandas 使用过程中的一些细节</li>
</ul>
<p>不定期更新。</p>
<!-- more -->
<blockquote>
<p>SQL 是一种面向集合的处理工具 / 语言<br>
Pandas 是一种面向数组的处理工具</p>
</blockquote>
<blockquote>
<p><strong>而一般处理 pandas 的数据往往以二维表的形式存在。所以，可以类比为更加强大的 SQL 语言。</strong></p>
</blockquote>
<p>而依据 Pandas 的作者之言，牛逼的 Pandas 使用者必须要精通 numpy; 当然，关于 Numpy, 留待之后开一篇文章做笔记好了。</p>
<h2 id="0x01-series-相关"><a class="v-toc-item" href="#0x01-series-相关">#</a> 0x01 Series 相关</h2>
<p>Series 接近于 ndarray 的用法，区别仅仅在于会带上 label 而已</p>
<blockquote>
<p>关于 ndarray, 请参考 我的另一篇文章 Numpy Cheatsheet</p>
</blockquote>
<h2 id="0x02-dataframe-相关"><a class="v-toc-item" href="#0x02-dataframe-相关">#</a> 0x02 DataFrame 相关</h2>
<h3 id="21-对象创建"><a class="v-toc-item" href="#21-对象创建">#</a> 2.1 对象创建</h3>
<pre><code class="language-python">
# <span class="token number">1.</span> 内存变量转 Dataframe
## <span class="token number">1.1</span><span class="token punctuation">.</span> 通过二位矩阵 <span class="token punctuation">,</span> index <span class="token punctuation">,</span> columns
dates <span class="token operator">=</span> pd<span class="token punctuation">.</span><span class="token function">date_range</span><span class="token punctuation">(</span><span class="token string">'20130101'</span><span class="token punctuation">,</span> periods<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">)</span>
pd <span class="token operator">=</span> pd<span class="token punctuation">.</span><span class="token function">DataFrame</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span><span class="token function">randn</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span> index<span class="token operator">=</span>dates<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token string">'ABCD'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
## <span class="token number">1.2</span><span class="token punctuation">.</span> 通过字典 Key 为 Column <span class="token punctuation">,</span> Value 为 list<span class="token punctuation">,</span>timestamp<span class="token punctuation">,</span>np<span class="token punctuation">.</span>array<span class="token punctuation">,</span>value
df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span><span class="token function">DataFrame</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string">'A'</span> <span class="token operator">:</span> <span class="token number">1.</span><span class="token punctuation">,</span>
                     <span class="token string">'B'</span> <span class="token operator">:</span> pd<span class="token punctuation">.</span><span class="token function">Timestamp</span><span class="token punctuation">(</span><span class="token string">'20130102'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                     <span class="token string">'C'</span> <span class="token operator">:</span> pd<span class="token punctuation">.</span><span class="token function">Series</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token function">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>dtype<span class="token operator">=</span><span class="token string">'float32'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                     <span class="token string">'D'</span> <span class="token operator">:</span> np<span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">,</span>dtype<span class="token operator">=</span><span class="token string">'int32'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                     <span class="token string">'E'</span> <span class="token operator">:</span> pd<span class="token punctuation">.</span><span class="token function">Categorical</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"test"</span><span class="token punctuation">,</span><span class="token string">"train"</span><span class="token punctuation">,</span><span class="token string">"test"</span><span class="token punctuation">,</span><span class="token string">"train"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                     <span class="token string">'F'</span> <span class="token operator">:</span> <span class="token string">'foo'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
# 长度无需统一，会自动填充

# <span class="token number">2.</span> 从文件中读取
pd<span class="token punctuation">.</span><span class="token function">read_excel</span><span class="token punctuation">(</span><span class="token string">"./data_set.xlsx"</span><span class="token punctuation">,</span>index_col<span class="token operator">=</span>False<span class="token punctuation">)</span> # 关掉 Index

# <span class="token number">3.</span> 合并多个同样的 DataFrame
df_items <span class="token operator">=</span> <span class="token punctuation">[</span>df_item1<span class="token punctuation">,</span>df_item2<span class="token punctuation">,</span><span class="token operator">...</span><span class="token punctuation">]</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>df_items<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">drop_duplicates</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span>data_set_df<span class="token punctuation">,</span> left_on<span class="token operator">=</span><span class="token string">"lno"</span><span class="token punctuation">,</span> right_on<span class="token operator">=</span><span class="token string">"rno"</span><span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">"outer"</span><span class="token punctuation">)</span>

# <span class="token number">4.</span>series to dataframe
df <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">to_frame</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre>
<p>选择数据<br>
Getting<br>
Selection by Label<br>
Selection by Position<br>
Boolean Indexing<br>
Setting<br>
缺失数据<br>
数据操作<br>
Operations<br>
Stats<br>
Apply<br>
Histogramming<br>
String Methods<br>
数据合并<br>
Concat<br>
Join<br>
Append<br>
Grouping<br>
Reshaping<br>
Stack<br>
Pivot Tables<br>
Time Series<br>
Categoricals<br>
Plotting</p>
<h3 id="22-浏览数据"><a class="v-toc-item" href="#22-浏览数据">#</a> 2.2 浏览数据</h3>
<pre><code class="language-python"># <span class="token number">1.</span> 查看表结构

df<span class="token punctuation">.</span><span class="token function">head</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span><span class="token function">tail</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>index
# df<span class="token punctuation">.</span>index <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'日期'</span><span class="token punctuation">,</span><span class="token string">'小时'</span><span class="token punctuation">]</span>
df<span class="token punctuation">.</span>columns
df<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token function">map</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span>lower<span class="token punctuation">,</span> df<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>

df<span class="token punctuation">.</span>values

df<span class="token punctuation">[</span><span class="token string">'col'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'col'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">astype</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">convert_objects</span><span class="token punctuation">(</span>convert_numeric<span class="token operator">=</span>True<span class="token punctuation">)</span>

# <span class="token number">2.</span> 删除 col_name

df<span class="token punctuation">.</span><span class="token function">drop</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'col_name_1'</span><span class="token punctuation">,</span><span class="token string">'col_name_2'</span><span class="token punctuation">,</span><span class="token operator">...</span><span class="token punctuation">,</span><span class="token string">'col_name_N'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span>True<span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>errors<span class="token operator">=</span><span class="token string">'ignore'</span><span class="token punctuation">)</span>

del df<span class="token punctuation">[</span><span class="token string">'cola'</span><span class="token punctuation">]</span>

# <span class="token number">3.</span> 修改元数据
df<span class="token punctuation">.</span><span class="token function">rename</span><span class="token punctuation">(</span>columns<span class="token operator">=</span>lambda x<span class="token operator">:</span> x<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span>True<span class="token punctuation">)</span>
df<span class="token punctuation">.</span><span class="token function">rename</span><span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'oldName1'</span><span class="token operator">:</span> <span class="token string">'newName1'</span><span class="token punctuation">,</span> <span class="token string">'oldName2'</span><span class="token operator">:</span> <span class="token string">'newName2'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span>True<span class="token punctuation">)</span>
df<span class="token punctuation">.</span><span class="token function">rename</span><span class="token punctuation">(</span>columns <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token operator">:</span> <span class="token string">'cola'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token string">'colb'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">:</span> <span class="token string">'colc'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span>True<span class="token punctuation">)</span>

# <span class="token number">2.</span>
## <span class="token number">2.</span> 遍历
<span class="token keyword">for</span> index<span class="token punctuation">,</span> row <span class="token keyword">in</span> df<span class="token punctuation">.</span><span class="token function">iterrows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>
    print row<span class="token punctuation">[</span><span class="token string">"c1"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> row<span class="token punctuation">[</span><span class="token string">"c2"</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> df<span class="token punctuation">.</span><span class="token function">itertuples</span><span class="token punctuation">(</span>index<span class="token operator">=</span>True<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'Pandas'</span><span class="token punctuation">)</span><span class="token operator">:</span>
    print <span class="token function">getattr</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token string">"c1"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">getattr</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> <span class="token string">"c2"</span><span class="token punctuation">)</span>
<span class="token operator">=</span> <span class="token constant">IF</span><span class="token punctuation">(</span><span class="token punctuation">[</span>@price<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"未知"</span><span class="token punctuation">,</span><span class="token constant">IF</span><span class="token punctuation">(</span><span class="token punctuation">[</span>@price<span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">30000</span><span class="token punctuation">,</span> <span class="token string">"三万以下"</span><span class="token punctuation">,</span> <span class="token constant">IF</span><span class="token punctuation">(</span><span class="token punctuation">[</span>@price<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">50000</span><span class="token punctuation">,</span> <span class="token string">"三万到五万"</span><span class="token punctuation">,</span> <span class="token constant">IF</span><span class="token punctuation">(</span><span class="token punctuation">[</span>@price<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">100000</span><span class="token punctuation">,</span> <span class="token string">"五万到十万"</span><span class="token punctuation">,</span> <span class="token constant">IF</span><span class="token punctuation">(</span><span class="token punctuation">[</span>@price<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">10000000</span><span class="token punctuation">,</span> <span class="token string">"十万以上"</span><span class="token punctuation">,</span> <span class="token string">"其他"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<h3 id="23-修改表内容"><a class="v-toc-item" href="#23-修改表内容">#</a> 2.3 修改表内容</h3>
<pre><code class="language-python">df<span class="token punctuation">.</span><span class="token function">drop_duplicates</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'col_a'</span><span class="token punctuation">,</span><span class="token string">'col_b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre>
<h3 id="24-查看表内容"><a class="v-toc-item" href="#24-查看表内容">#</a> 2.4 查看表内容</h3>
<pre><code class="language-python"># 选择
df<span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">]</span> # 列选
df<span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">30</span><span class="token punctuation">]</span> # 行选
df<span class="token punctuation">[</span><span class="token string">'20130102'</span><span class="token operator">:</span><span class="token string">'20130104'</span><span class="token punctuation">]</span> # 行选
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'20130102'</span><span class="token operator">:</span><span class="token string">'20130104'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'A'</span><span class="token punctuation">,</span><span class="token string">'B'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> # by label
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>condition<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'cola'</span><span class="token punctuation">,</span><span class="token string">'colb'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'ri01'</span><span class="token punctuation">,</span><span class="token string">'ri02'</span><span class="token punctuation">]</span> <span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">"cola"</span><span class="token punctuation">,</span><span class="token string">"colb"</span><span class="token punctuation">,</span><span class="token string">"colc"</span><span class="token punctuation">]</span><span class="token punctuation">]</span>

df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">:</span><span class="token number">4</span><span class="token punctuation">]</span> # by position
df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token operator">:</span> <span class="token punctuation">,</span> <span class="token number">0</span><span class="token operator">:</span><span class="token number">7</span><span class="token punctuation">]</span> # 全部列，<span class="token number">0</span><span class="token operator">-</span><span class="token number">7</span> 索引

df<span class="token punctuation">.</span>ix<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'ri02'</span><span class="token punctuation">,</span> <span class="token string">'ri09'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> # 选取行

total_rows<span class="token operator">=</span><span class="token function">len</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
total_cols<span class="token operator">=</span><span class="token function">len</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

df<span class="token punctuation">.</span><span class="token function">sample</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span> # 随机抽取 <span class="token number">3000</span> 行，可以用于快速验证算法

criterion <span class="token operator">=</span> df2<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>lambda x<span class="token operator">:</span> x<span class="token punctuation">.</span><span class="token function">startswith</span><span class="token punctuation">(</span><span class="token string">'t'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
df2<span class="token punctuation">[</span>criterion<span class="token punctuation">]</span>

df2<span class="token punctuation">[</span><span class="token punctuation">[</span>x<span class="token punctuation">.</span><span class="token function">startswith</span><span class="token punctuation">(</span><span class="token string">'t'</span><span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> df2<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
# select <span class="token operator">*</span> from df limit <span class="token number">5</span>
df<span class="token punctuation">.</span><span class="token function">head</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
# select a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c from df
df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">head</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
# select a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c from df where a <span class="token operator">=</span> <span class="token number">11</span> and b <span class="token operator">=</span> <span class="token string">'xx'</span>
df<span class="token punctuation">[</span> <span class="token punctuation">(</span> df<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span> df<span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'xx'</span><span class="token punctuation">)</span> <span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
df<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">value_counts</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

# <span class="token constant">SELECT</span> <span class="token operator">*</span> <span class="token constant">FROM</span> df <span class="token constant">ORDER</span> <span class="token constant">BY</span> a <span class="token constant">DESC</span> <span class="token constant">LIMIT</span> <span class="token number">10</span> <span class="token constant">OFFSET</span> <span class="token number">5</span><span class="token punctuation">;</span>
df<span class="token punctuation">.</span><span class="token function">nlargest</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">+</span><span class="token number">5</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tail</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>

df<span class="token punctuation">.</span>column<span class="token punctuation">.</span>str<span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">]</span>
df<span class="token punctuation">.</span>column_name<span class="token punctuation">.</span>str<span class="token punctuation">.</span><span class="token function">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
two_groups <span class="token operator">=</span> <span class="token string">'(?P&lt;letter>[a-z])(?P&lt;digit>[0-9])'</span>
s<span class="token punctuation">.</span>str<span class="token punctuation">.</span><span class="token function">extract</span><span class="token punctuation">(</span>two_groups<span class="token punctuation">,</span> expand<span class="token operator">=</span>True<span class="token punctuation">)</span>

# 排序

df<span class="token punctuation">.</span><span class="token function">sort_index</span><span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span>False<span class="token punctuation">)</span>
df<span class="token punctuation">.</span><span class="token function">sort_values</span><span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">'B'</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> df<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'col1'</span><span class="token punctuation">,</span><span class="token string">'col2'</span><span class="token punctuation">,</span><span class="token string">'col3'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>ascending<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
#

# window <span class="token keyword">function</span>
# <span class="token constant">SELECT</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> <span class="token function">rank</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token constant">OVER</span> <span class="token punctuation">(</span><span class="token constant">PARTITION</span> <span class="token constant">BY</span> a <span class="token constant">ORDER</span> <span class="token constant">BY</span> b <span class="token constant">DESC</span><span class="token punctuation">)</span> <span class="token keyword">as</span> rn <span class="token constant">FROM</span> df<span class="token punctuation">;</span>
# 如果没有这个 window <span class="token keyword">function</span> 的话，可以 groupby 一下，然后生成表和原有表进行 <span class="token constant">JOIN</span>
tips<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>rn<span class="token operator">=</span>tips<span class="token punctuation">.</span><span class="token function">sort_values</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span>False<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">groupby</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">cumcount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>

# Top <span class="token constant">N</span> rows per group
# rank 代表等级 如果两人并列第一名，则不存在第二名，直接是第三名 <span class="token punctuation">,</span> row_number 代表排名，即即便两个人分数一样，也无法并列第一名

# PostGRESQL's <span class="token constant">ROW_NUMBER</span><span class="token punctuation">(</span><span class="token punctuation">)</span> analytic <span class="token keyword">function</span>
<span class="token constant">SELECT</span> <span class="token operator">*</span> <span class="token constant">FROM</span> <span class="token punctuation">(</span>
  <span class="token constant">SELECT</span>
    t<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
    <span class="token constant">ROW_NUMBER</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token constant">OVER</span><span class="token punctuation">(</span><span class="token constant">PARTITION</span> <span class="token constant">BY</span> day <span class="token constant">ORDER</span> <span class="token constant">BY</span> total_bill <span class="token constant">DESC</span><span class="token punctuation">)</span> <span class="token constant">AS</span> rn
  <span class="token constant">FROM</span> tips t
<span class="token punctuation">)</span> tt
<span class="token constant">WHERE</span> rn <span class="token operator">&lt;</span> <span class="token number">3</span>
<span class="token constant">ORDER</span> <span class="token constant">BY</span> day<span class="token punctuation">,</span> rn<span class="token punctuation">;</span>

<span class="token punctuation">(</span>tips<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>rn<span class="token operator">=</span>tips<span class="token punctuation">.</span><span class="token function">sort_values</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'total_bill'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span>False<span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">groupby</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'day'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">cumcount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
     <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">'rn &lt; 3'</span><span class="token punctuation">)</span>
     <span class="token punctuation">.</span><span class="token function">sort_values</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'day'</span><span class="token punctuation">,</span><span class="token string">'rn'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token punctuation">(</span>tips<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>rnk<span class="token operator">=</span>tips<span class="token punctuation">.</span><span class="token function">groupby</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'day'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'total_bill'</span><span class="token punctuation">]</span>
                     <span class="token punctuation">.</span><span class="token function">rank</span><span class="token punctuation">(</span>method<span class="token operator">=</span><span class="token string">'first'</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span>False<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">'rnk &lt; 3'</span><span class="token punctuation">)</span>
     <span class="token punctuation">.</span><span class="token function">sort_values</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'day'</span><span class="token punctuation">,</span><span class="token string">'rnk'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

# PostGRESQL's <span class="token constant">RANK</span><span class="token punctuation">(</span><span class="token punctuation">)</span> analytic <span class="token keyword">function</span>
<span class="token constant">SELECT</span> <span class="token operator">*</span> <span class="token constant">FROM</span> <span class="token punctuation">(</span>
  <span class="token constant">SELECT</span>
    t<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
    <span class="token constant">RANK</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token constant">OVER</span><span class="token punctuation">(</span><span class="token constant">PARTITION</span> <span class="token constant">BY</span> sex <span class="token constant">ORDER</span> <span class="token constant">BY</span> tip<span class="token punctuation">)</span> <span class="token constant">AS</span> rnk
  <span class="token constant">FROM</span> tips t
  <span class="token constant">WHERE</span> tip <span class="token operator">&lt;</span> <span class="token number">2</span>
<span class="token punctuation">)</span>
<span class="token constant">WHERE</span> rnk <span class="token operator">&lt;</span> <span class="token number">3</span>
<span class="token constant">ORDER</span> <span class="token constant">BY</span> sex<span class="token punctuation">,</span> rnk<span class="token punctuation">;</span>

<span class="token punctuation">(</span>tips<span class="token punctuation">[</span>tips<span class="token punctuation">[</span><span class="token string">'tip'</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">]</span>
     <span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>rnk_min<span class="token operator">=</span>tips<span class="token punctuation">.</span><span class="token function">groupby</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'sex'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'tip'</span><span class="token punctuation">]</span>
                         <span class="token punctuation">.</span><span class="token function">rank</span><span class="token punctuation">(</span>method<span class="token operator">=</span><span class="token string">'min'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">'rnk_min &lt; 3'</span><span class="token punctuation">)</span>
     <span class="token punctuation">.</span><span class="token function">sort_values</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'sex'</span><span class="token punctuation">,</span><span class="token string">'rnk_min'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

# where 语句
df<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">isnull</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">isin</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span>

# groupby
df<span class="token punctuation">.</span><span class="token function">groupby</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> # 计算 a
df<span class="token punctuation">.</span><span class="token function">groupby</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> # 同上计算 a
df<span class="token punctuation">.</span><span class="token function">groupby</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> # 计算所有 cols
agg_fun_dict <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'tip'</span><span class="token operator">:</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">,</span> <span class="token string">'day'</span><span class="token operator">:</span> np<span class="token punctuation">.</span>size<span class="token punctuation">}</span>
agg_fun_dict_new <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'tip'</span><span class="token operator">:</span> <span class="token punctuation">[</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">,</span> np<span class="token punctuation">.</span>size<span class="token punctuation">]</span><span class="token punctuation">}</span>
df<span class="token punctuation">.</span><span class="token function">groupby</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">agg</span><span class="token punctuation">(</span>agg_fun_dict<span class="token punctuation">)</span>
df<span class="token punctuation">.</span><span class="token function">groupby</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">describe</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>age<span class="token punctuation">.</span><span class="token function">agg</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'min'</span><span class="token punctuation">,</span> <span class="token string">'max'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span><span class="token function">applymap</span><span class="token punctuation">(</span>multiply_10_for_every_int<span class="token punctuation">)</span> #

calc_groups <span class="token operator">=</span> df<span class="token punctuation">.</span><span class="token function">groupby</span><span class="token punctuation">(</span><span class="token punctuation">[</span>date<span class="token punctuation">]</span><span class="token punctuation">)</span>
calc_groups<span class="token punctuation">[</span><span class="token string">'id_aa'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">nunique</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reset_index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">to_excel</span><span class="token punctuation">(</span><span class="token string">"123.xlsx"</span><span class="token punctuation">)</span>

# pivot
pd<span class="token punctuation">.</span><span class="token function">pivot_table</span><span class="token punctuation">(</span>data<span class="token operator">=</span>df<span class="token punctuation">,</span>values<span class="token operator">=</span><span class="token string">'value_col'</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token string">'A_FROM'</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token string">'B_TO'</span><span class="token punctuation">,</span> aggfunc<span class="token operator">=</span>lambda x<span class="token operator">:</span> <span class="token function">len</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">unique</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>margins<span class="token operator">=</span>True<span class="token punctuation">)</span>

# <span class="token constant">CONCAT</span>
append
# <span class="token constant">JOIN</span>
pd<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span>df1<span class="token punctuation">,</span> df2<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">'key'</span><span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">'outer'</span><span class="token punctuation">)</span>

# <span class="token constant">UPDATE</span> tips <span class="token constant">SET</span> tip <span class="token operator">=</span> tip<span class="token operator">*</span><span class="token number">2</span> <span class="token constant">WHERE</span> tip <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">;</span>
tips<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>tips<span class="token punctuation">[</span><span class="token string">'tip'</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'tip'</span><span class="token punctuation">]</span> <span class="token operator">*=</span> <span class="token number">2</span>

# <span class="token constant">TODO</span><span class="token operator">:</span>
</code></pre>
<h3 id="25-表变换"><a class="v-toc-item" href="#25-表变换">#</a> 2.5 表变换</h3>
<pre><code class="language-python"># apply <span class="token punctuation">,</span> apply map
DataFrame<span class="token punctuation">.</span>apply operates on entire rows or columns at a time<span class="token punctuation">.</span>
DataFrame<span class="token punctuation">.</span>applymap<span class="token punctuation">,</span> Series<span class="token punctuation">.</span>apply<span class="token punctuation">,</span> and Series<span class="token punctuation">.</span>map operate on one element at time<span class="token punctuation">.</span>
</code></pre>
<h3 id="26-表遍历"><a class="v-toc-item" href="#26-表遍历">#</a> 2.6 表遍历</h3>
<pre><code class="language-python">df<span class="token punctuation">.</span><span class="token function">iterrows</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span><span class="token function">itertuples</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<h2 id="数据导入导出"><a class="v-toc-item" href="#数据导入导出">#</a> 数据导入导出</h2>
<h3 id="sql"><a class="v-toc-item" href="#sql">#</a> SQL</h3>
<pre><code class="language-python">from sqlalchemy <span class="token keyword">import</span> create_engine
from sqlalchemy<span class="token punctuation">.</span>engine<span class="token punctuation">.</span>url <span class="token keyword">import</span> <span class="token constant">URL</span>
<span class="token constant">DATABASE</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'drivername'</span><span class="token operator">:</span> <span class="token string">'postgres'</span><span class="token punctuation">,</span>
    <span class="token string">'host'</span><span class="token operator">:</span> <span class="token string">'localhost'</span><span class="token punctuation">,</span>
    <span class="token string">'port'</span><span class="token operator">:</span> <span class="token string">'5432'</span><span class="token punctuation">,</span>
    <span class="token string">'username'</span><span class="token operator">:</span> <span class="token string">'yourusername'</span><span class="token punctuation">,</span>
    <span class="token string">'password'</span><span class="token operator">:</span> <span class="token string">'yourpass'</span><span class="token punctuation">,</span>
    <span class="token string">'database'</span><span class="token operator">:</span> <span class="token string">'yourdb'</span>
<span class="token punctuation">}</span>
# 这里并不建议直接写数据库连接字符串，而是使用 <span class="token constant">URL</span> 函数，这样可以避免转义字符带来的坑，比如 @ 在数据库连接字符串是 <span class="token operator">%</span><span class="token number">40</span>
engine <span class="token operator">=</span> <span class="token function">create_engine</span><span class="token punctuation">(</span><span class="token constant">URL</span><span class="token punctuation">(</span><span class="token operator">**</span><span class="token constant">DATABASE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

# 读一整张表
<span class="token keyword">with</span> engine<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> conn<span class="token punctuation">,</span> conn<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>
    data <span class="token operator">=</span> pd<span class="token punctuation">.</span><span class="token function">read_sql_table</span><span class="token punctuation">(</span><span class="token string">'yourtablehere'</span><span class="token punctuation">,</span> conn<span class="token punctuation">)</span>
    <span class="token function">processyourdata</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>

# 按照 <span class="token constant">SQL</span> 语句来读
<span class="token keyword">with</span> engine<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> conn<span class="token punctuation">,</span> conn<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span>
    data <span class="token operator">=</span> pd<span class="token punctuation">.</span><span class="token function">read_sql</span><span class="token punctuation">(</span><span class="token string">""</span>"
    yoursqlquery
    <span class="token string">""</span>"<span class="token punctuation">,</span> conn<span class="token punctuation">)</span>
    <span class="token function">processyourdata</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
</code></pre>
<h3 id="csv"><a class="v-toc-item" href="#csv">#</a> CSV</h3>
<p>日常数据处理用 CSV 的比较多，因为这种格式语法简洁，类二维表，读写速度快，而且配合 gzip 压缩解压。</p>
<p>pandas 在 windows 上好像不能读取中文路径？</p>
<p>而且，pandas 读取的时候要注意指定编码。因为在日常导出 CSV 的时往往使用的是 utf-8, 而 windows 默认打开文本文件时候使用的是 gbk</p>
<p>read_csv 有几十个参数，挑几个说一下：</p>
<ul>
<li>sep 可以指定分隔符，默认为’,', 但有的人导出的数据以 tab 为空格。</li>
<li>dtype 可以指定某些列的值类型为 int,float 的类型从而减少 object 的创建 , 但是对 str/object 没有什么暖用</li>
<li>parse_dates 可以指定 date 列</li>
<li>header 如果 CSV 没有 Header, 可以指定为 None</li>
<li>usecols 可以指定几列，相当于数据库中的 SELECT a_col,b_col</li>
</ul>
<p>其中还有一些比较有趣的东西，比如说，iterator=True<br>
值得注意的是，通过</p>
<h3 id="excel"><a class="v-toc-item" href="#excel">#</a> Excel</h3>
<p>Gotchas</p>
<h2 id="0x02-可视化技术"><a class="v-toc-item" href="#0x02-可视化技术">#</a> 0x02 可视化技术</h2>
<pre><code class="language-python"># 绘制
df<span class="token punctuation">.</span><span class="token function">plot</span><span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">'bar'</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span><span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token string">'xlable'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span><span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token string">'ylable'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">'title name'</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

df<span class="token punctuation">[</span><span class="token string">'数量'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">plot</span><span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">'bar'</span><span class="token punctuation">)</span>

# 批量创建图
g <span class="token operator">=</span> sns<span class="token punctuation">.</span><span class="token function">FacetGrid</span><span class="token punctuation">(</span>customers<span class="token punctuation">,</span> col<span class="token operator">=</span><span class="token string">"cola"</span><span class="token punctuation">)</span>
g<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>plt<span class="token punctuation">.</span>scatter<span class="token punctuation">,</span> <span class="token string">"数量"</span><span class="token punctuation">,</span> <span class="token string">"单位"</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
g<span class="token punctuation">.</span><span class="token function">add_legend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ttbill <span class="token operator">=</span> sns<span class="token punctuation">.</span><span class="token function">distplot</span><span class="token punctuation">(</span>tips<span class="token punctuation">[</span><span class="token string">"总价格"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ttbill<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>xlabel <span class="token operator">=</span> <span class="token string">'价值'</span><span class="token punctuation">,</span> ylabel <span class="token operator">=</span> <span class="token string">'频率'</span><span class="token punctuation">,</span> title <span class="token operator">=</span> <span class="token string">"标题名"</span><span class="token punctuation">)</span>
sns<span class="token punctuation">.</span><span class="token function">despine</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

sns<span class="token punctuation">.</span><span class="token function">jointplot</span><span class="token punctuation">(</span>x <span class="token operator">=</span><span class="token string">"total_bill"</span><span class="token punctuation">,</span> y <span class="token operator">=</span><span class="token string">"tip"</span><span class="token punctuation">,</span> data <span class="token operator">=</span> tips<span class="token punctuation">)</span>
# https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>guipsamora<span class="token operator">/</span>pandas_exercises<span class="token operator">/</span>blob<span class="token operator">/</span>master<span class="token operator">/</span><span class="token number">07</span>_Visualization<span class="token operator">/</span>Tips<span class="token operator">/</span>Exercises_with_code_and_solutions<span class="token punctuation">.</span>ipynb

plt<span class="token punctuation">.</span><span class="token function">pie</span><span class="token punctuation">(</span>
    <span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'男'</span><span class="token punctuation">,</span> <span class="token string">'女'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    shadow <span class="token operator">=</span> False<span class="token punctuation">,</span>
    colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'blue'</span><span class="token punctuation">,</span><span class="token string">'red'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    explode <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0.15</span> <span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    startangle <span class="token operator">=</span> <span class="token number">90</span><span class="token punctuation">,</span>
    autopct <span class="token operator">=</span> <span class="token string">'%1.1f%%'</span>
    <span class="token punctuation">)</span>
plt<span class="token punctuation">.</span><span class="token function">axis</span><span class="token punctuation">(</span><span class="token string">'equal'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">"男女比例"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span><span class="token function">tight_layout</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<h2 id="0x03-asd1"><a class="v-toc-item" href="#0x03-asd1">#</a> 0x03 asd1</h2>
<h2 id="0x07-performance-tips"><a class="v-toc-item" href="#0x07-performance-tips">#</a> 0x07 Performance Tips</h2>
<p>最近遇到了数据量比较大的数据处理，数据条数差不多在 3 千万条。加载到内存中大约 1GB.</p>
<h3 id="71-精简行列"><a class="v-toc-item" href="#71-精简行列">#</a> 7.1 精简行列</h3>
<ol>
<li>读入 dataframe 的时候就排除多余的行列。</li>
<li>Merge 时候需要精简行列。</li>
</ol>
<pre><code class="language-python">df1<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span>df2<span class="token punctuation">[</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token string">'xab'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
pandas<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span>dataframe1<span class="token punctuation">,</span> dataframe2<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">'left'</span><span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">'key'</span><span class="token punctuation">)</span>
</code></pre>
<h3 id="72-大文件的处理"><a class="v-toc-item" href="#72-大文件的处理">#</a> 7.2 大文件的处理</h3>
<blockquote>
<p>参考我的文章 记一次小机器的 Python 大数据分析</p>
</blockquote>
<h2 id="0x-踩坑集合"><a class="v-toc-item" href="#0x-踩坑集合">#</a> 0x 踩坑集合</h2>
<h2 id="0x08-踩坑集合"><a class="v-toc-item" href="#0x08-踩坑集合">#</a> 0x08 踩坑集合</h2>
<h3 id="81-io-类"><a class="v-toc-item" href="#81-io-类">#</a> 8.1 IO 类</h3>
<h4 id=""><a class="v-toc-item" href="#">#</a> </h4>
<h3 id="82-io-类"><a class="v-toc-item" href="#82-io-类">#</a> 8.2 IO 类</h3>
<h2 id="0xee-参考链接"><a class="v-toc-item" href="#0xee-参考链接">#</a> 0xEE 参考链接</h2>
<hr>
<p>ChangeLog:</p>
<ul>
<li><strong>2017-06-03</strong> 初始化本文</li>
<li><strong>2018-02-03</strong> 重修文字</li>
</ul>
</div></div><div><ul class="v-article-toc">
<li>
<ul>
<li><a href="#0x00-%E5%89%8D%E8%A8%80">0x00 前言</a></li>
<li><a href="#0x01-series-%E7%9B%B8%E5%85%B3">0x01 Series 相关</a></li>
<li><a href="#0x02-dataframe-%E7%9B%B8%E5%85%B3">0x02 DataFrame 相关</a>
<ul>
<li><a href="#21-%E5%AF%B9%E8%B1%A1%E5%88%9B%E5%BB%BA">2.1 对象创建</a></li>
<li><a href="#22-%E6%B5%8F%E8%A7%88%E6%95%B0%E6%8D%AE">2.2 浏览数据</a></li>
<li><a href="#23-%E4%BF%AE%E6%94%B9%E8%A1%A8%E5%86%85%E5%AE%B9">2.3 修改表内容</a></li>
<li><a href="#24-%E6%9F%A5%E7%9C%8B%E8%A1%A8%E5%86%85%E5%AE%B9">2.4 查看表内容</a></li>
<li><a href="#25-%E8%A1%A8%E5%8F%98%E6%8D%A2">2.5 表变换</a></li>
<li><a href="#26-%E8%A1%A8%E9%81%8D%E5%8E%86">2.6 表遍历</a></li>
</ul>
</li>
<li><a href="#%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA">数据导入导出</a>
<ul>
<li><a href="#sql">SQL</a></li>
<li><a href="#csv">CSV</a></li>
<li><a href="#excel">Excel</a></li>
</ul>
</li>
<li><a href="#0x02-%E5%8F%AF%E8%A7%86%E5%8C%96%E6%8A%80%E6%9C%AF">0x02 可视化技术</a></li>
<li><a href="#0x03-asd1">0x03 asd1</a></li>
<li><a href="#0x07-performance-tips">0x07 Performance Tips</a>
<ul>
<li><a href="#71-%E7%B2%BE%E7%AE%80%E8%A1%8C%E5%88%97">7.1 精简行列</a></li>
<li><a href="#72-%E5%A4%A7%E6%96%87%E4%BB%B6%E7%9A%84%E5%A4%84%E7%90%86">7.2 大文件的处理</a></li>
</ul>
</li>
<li><a href="#0x-%E8%B8%A9%E5%9D%91%E9%9B%86%E5%90%88">0x 踩坑集合</a></li>
<li><a href="#0x08-%E8%B8%A9%E5%9D%91%E9%9B%86%E5%90%88">0x08 踩坑集合</a>
<ul>
<li><a href="#81-io-%E7%B1%BB">8.1 IO 类</a><br>
*</li>
<li><a href="#82-io-%E7%B1%BB">8.2 IO 类</a></li>
</ul>
</li>
<li><a href="#0xee-%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5">0xEE 参考链接</a></li>
</ul>
</li>
</ul>
</div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"tags":["数据分析"],"path":"20170603_PandasCheatSheet.md","title":"Pandas CheatSheet","slug":"Pandas CheatSheet","date":"2017-06-03","category":"Python","lastMod":"2020-01-01","description":"这篇文章展示了基本的 Markdown 语法和格式.","thumbnail":"","content":"\u003ch2 id=\"0x00-前言\"\u003e\u003ca class=\"v-toc-item\" href=\"#0x00-前言\"\u003e#\u003c/a\u003e 0x00 前言\u003c/h2\u003e\n\u003cp\u003e本文为 Cheatsheet 类型文章，用于记录我在日常编程中经常使用的 Pandas 相关语句。\u003c/p\u003e\n\u003cp\u003e主要包含：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003ePandas 中 Series 的一些常见操作和技巧\u003c/li\u003e\n\u003cli\u003ePandas 中 Dateframe 的一些常见操作和技巧\u003c/li\u003e\n\u003cli\u003ePython 里的可视化技巧\u003c/li\u003e\n\u003cli\u003ePandas 使用过程中的一些细节\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e不定期更新。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003cblockquote\u003e\n\u003cp\u003eSQL 是一种面向集合的处理工具 / 语言\u003cbr\u003e\nPandas 是一种面向数组的处理工具\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003e而一般处理 pandas 的数据往往以二维表的形式存在。所以，可以类比为更加强大的 SQL 语言。\u003c/strong\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e而依据 Pandas 的作者之言，牛逼的 Pandas 使用者必须要精通 numpy; 当然，关于 Numpy, 留待之后开一篇文章做笔记好了。\u003c/p\u003e\n\u003ch2 id=\"0x01-series-相关\"\u003e\u003ca class=\"v-toc-item\" href=\"#0x01-series-相关\"\u003e#\u003c/a\u003e 0x01 Series 相关\u003c/h2\u003e\n\u003cp\u003eSeries 接近于 ndarray 的用法，区别仅仅在于会带上 label 而已\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e关于 ndarray, 请参考 我的另一篇文章 Numpy Cheatsheet\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2 id=\"0x02-dataframe-相关\"\u003e\u003ca class=\"v-toc-item\" href=\"#0x02-dataframe-相关\"\u003e#\u003c/a\u003e 0x02 DataFrame 相关\u003c/h2\u003e\n\u003ch3 id=\"21-对象创建\"\u003e\u003ca class=\"v-toc-item\" href=\"#21-对象创建\"\u003e#\u003c/a\u003e 2.1 对象创建\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-python\"\u003e\n# \u003cspan class=\"token number\"\u003e1.\u003c/span\u003e 内存变量转 Dataframe\n## \u003cspan class=\"token number\"\u003e1.1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e 通过二位矩阵 \u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e index \u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e columns\ndates \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e pd\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003edate_range\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'20130101'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e periods\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token number\"\u003e6\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\npd \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e pd\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eDataFrame\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003enp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003erandom\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003erandn\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e6\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e index\u003cspan class=\"token operator\"\u003e=\u003c/span\u003edates\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e columns\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token function\"\u003elist\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'ABCD'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n## \u003cspan class=\"token number\"\u003e1.2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e 通过字典 Key 为 Column \u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e Value 为 list\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003etimestamp\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003enp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003earray\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003evalue\ndf2 \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e pd\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eDataFrame\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token string\"\u003e'A'\u003c/span\u003e \u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e1.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n                     \u003cspan class=\"token string\"\u003e'B'\u003c/span\u003e \u003cspan class=\"token operator\"\u003e:\u003c/span\u003e pd\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eTimestamp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'20130102'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n                     \u003cspan class=\"token string\"\u003e'C'\u003c/span\u003e \u003cspan class=\"token operator\"\u003e:\u003c/span\u003e pd\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eSeries\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003eindex\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token function\"\u003elist\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token function\"\u003erange\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003edtype\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e'float32'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n                     \u003cspan class=\"token string\"\u003e'D'\u003c/span\u003e \u003cspan class=\"token operator\"\u003e:\u003c/span\u003e np\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003earray\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e3\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003edtype\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e'int32'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n                     \u003cspan class=\"token string\"\u003e'E'\u003c/span\u003e \u003cspan class=\"token operator\"\u003e:\u003c/span\u003e pd\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eCategorical\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"test\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"train\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"test\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"train\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n                     \u003cspan class=\"token string\"\u003e'F'\u003c/span\u003e \u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'foo'\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n# 长度无需统一，会自动填充\n\n# \u003cspan class=\"token number\"\u003e2.\u003c/span\u003e 从文件中读取\npd\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eread_excel\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"./data_set.xlsx\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003eindex_col\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eFalse\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e # 关掉 Index\n\n# \u003cspan class=\"token number\"\u003e3.\u003c/span\u003e 合并多个同样的 DataFrame\ndf_items \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003edf_item1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003edf_item2\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token operator\"\u003e...\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\ndf \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e pd\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003econcat\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edf_items\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003edrop_duplicates\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003emerge\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edata_set_df\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e left_on\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"lno\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e right_on\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"rno\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e how\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"outer\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n# \u003cspan class=\"token number\"\u003e4.\u003c/span\u003eseries to dataframe\ndf \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e s\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eto_frame\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e选择数据\u003cbr\u003e\nGetting\u003cbr\u003e\nSelection by Label\u003cbr\u003e\nSelection by Position\u003cbr\u003e\nBoolean Indexing\u003cbr\u003e\nSetting\u003cbr\u003e\n缺失数据\u003cbr\u003e\n数据操作\u003cbr\u003e\nOperations\u003cbr\u003e\nStats\u003cbr\u003e\nApply\u003cbr\u003e\nHistogramming\u003cbr\u003e\nString Methods\u003cbr\u003e\n数据合并\u003cbr\u003e\nConcat\u003cbr\u003e\nJoin\u003cbr\u003e\nAppend\u003cbr\u003e\nGrouping\u003cbr\u003e\nReshaping\u003cbr\u003e\nStack\u003cbr\u003e\nPivot Tables\u003cbr\u003e\nTime Series\u003cbr\u003e\nCategoricals\u003cbr\u003e\nPlotting\u003c/p\u003e\n\u003ch3 id=\"22-浏览数据\"\u003e\u003ca class=\"v-toc-item\" href=\"#22-浏览数据\"\u003e#\u003c/a\u003e 2.2 浏览数据\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-python\"\u003e# \u003cspan class=\"token number\"\u003e1.\u003c/span\u003e 查看表结构\n\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ehead\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003etail\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e3\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eindex\n# df\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eindex \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'日期'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'小时'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ecolumns\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ecolumns \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003emap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003estr\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elower\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e df\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ecolumns\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003evalues\n\ndf\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'col'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e df\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'col'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eastype\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003estr\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003econvert_objects\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003econvert_numeric\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eTrue\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n# \u003cspan class=\"token number\"\u003e2.\u003c/span\u003e 删除 col_name\n\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003edrop\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'col_name_1'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'col_name_2'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token operator\"\u003e...\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'col_name_N'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003einplace\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eTrue\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003eaxis\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003eerrors\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e'ignore'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\ndel df\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'cola'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\n# \u003cspan class=\"token number\"\u003e3.\u003c/span\u003e 修改元数据\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003erename\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecolumns\u003cspan class=\"token operator\"\u003e=\u003c/span\u003elambda x\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003esplit\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'.'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e inplace\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eTrue\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003erename\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecolumns\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token string\"\u003e'oldName1'\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'newName1'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'oldName2'\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'newName2'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e inplace\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eTrue\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003erename\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecolumns \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'cola'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'colb'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'colc'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e inplace\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eTrue\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n# \u003cspan class=\"token number\"\u003e2.\u003c/span\u003e\n## \u003cspan class=\"token number\"\u003e2.\u003c/span\u003e 遍历\n\u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e index\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e row \u003cspan class=\"token keyword\"\u003ein\u003c/span\u003e df\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eiterrows\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e\n    print row\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"c1\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e row\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"c2\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e row \u003cspan class=\"token keyword\"\u003ein\u003c/span\u003e df\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eitertuples\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eindex\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eTrue\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e name\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e'Pandas'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e\n    print \u003cspan class=\"token function\"\u003egetattr\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003erow\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"c1\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token function\"\u003egetattr\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003erow\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"c2\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token constant\"\u003eIF\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e@price\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"未知\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token constant\"\u003eIF\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e@price\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"token number\"\u003e30000\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"三万以下\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token constant\"\u003eIF\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e@price\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u0026lt;=\u003c/span\u003e \u003cspan class=\"token number\"\u003e50000\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"三万到五万\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token constant\"\u003eIF\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e@price\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u0026lt;=\u003c/span\u003e \u003cspan class=\"token number\"\u003e100000\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"五万到十万\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token constant\"\u003eIF\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e@price\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u0026lt;=\u003c/span\u003e \u003cspan class=\"token number\"\u003e10000000\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"十万以上\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"其他\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"23-修改表内容\"\u003e\u003ca class=\"v-toc-item\" href=\"#23-修改表内容\"\u003e#\u003c/a\u003e 2.3 修改表内容\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-python\"\u003edf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003edrop_duplicates\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'col_a'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'col_b'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"24-查看表内容\"\u003e\u003ca class=\"v-toc-item\" href=\"#24-查看表内容\"\u003e#\u003c/a\u003e 2.4 查看表内容\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-python\"\u003e# 选择\ndf\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'A'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e # 列选\ndf\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e\u003cspan class=\"token number\"\u003e30\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e # 行选\ndf\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'20130102'\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e\u003cspan class=\"token string\"\u003e'20130104'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e # 行选\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eloc\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'20130102'\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e\u003cspan class=\"token string\"\u003e'20130104'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'A'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'B'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e # by label\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eloc\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003econdition\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'cola'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'colb'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eloc\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'ri01'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'ri02'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"cola\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"colb\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"colc\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eiloc\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e\u003cspan class=\"token number\"\u003e5\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e\u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e # by position\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eiloc\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e\u003cspan class=\"token number\"\u003e7\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e # 全部列，\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e7\u003c/span\u003e 索引\n\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eix\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'ri02'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'ri09'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e # 选取行\n\ntotal_rows\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token function\"\u003elen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eaxes\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\ntotal_cols\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token function\"\u003elen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eaxes\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003esample\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e3000\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e # 随机抽取 \u003cspan class=\"token number\"\u003e3000\u003c/span\u003e 行，可以用于快速验证算法\n\ncriterion \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e df2\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'a'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003emap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003elambda x\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e x\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003estartswith\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e't'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\ndf2\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ecriterion\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\ndf2\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ex\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003estartswith\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e't'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e x \u003cspan class=\"token keyword\"\u003ein\u003c/span\u003e df2\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'a'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n# select \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e from df limit \u003cspan class=\"token number\"\u003e5\u003c/span\u003e\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ehead\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n# select a\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003eb\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003ec from df\ndf\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'a'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'b'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'c'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ehead\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n# select a\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003eb\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003ec from df where a \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e11\u003c/span\u003e and b \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'xx'\u003c/span\u003e\ndf\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e df\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'a'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e==\u003c/span\u003e \u003cspan class=\"token number\"\u003e11\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e df\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'b'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e==\u003c/span\u003e \u003cspan class=\"token string\"\u003e'xx'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'a'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'b'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'c'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\ndf\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'a'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003evalue_counts\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n# \u003cspan class=\"token constant\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token constant\"\u003eFROM\u003c/span\u003e df \u003cspan class=\"token constant\"\u003eORDER\u003c/span\u003e \u003cspan class=\"token constant\"\u003eBY\u003c/span\u003e a \u003cspan class=\"token constant\"\u003eDESC\u003c/span\u003e \u003cspan class=\"token constant\"\u003eLIMIT\u003c/span\u003e \u003cspan class=\"token number\"\u003e10\u003c/span\u003e \u003cspan class=\"token constant\"\u003eOFFSET\u003c/span\u003e \u003cspan class=\"token number\"\u003e5\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003enlargest\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e10\u003c/span\u003e\u003cspan class=\"token operator\"\u003e+\u003c/span\u003e\u003cspan class=\"token number\"\u003e5\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e columns\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e'a'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003etail\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e10\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ecolumn\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003estr\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e\u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ecolumn_name\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003estr\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003elen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\ntwo_groups \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'(?P\u0026lt;letter\u003e[a-z])(?P\u0026lt;digit\u003e[0-9])'\u003c/span\u003e\ns\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003estr\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eextract\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etwo_groups\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e expand\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eTrue\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n# 排序\n\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003esort_index\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eaxis\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ascending\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eFalse\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003esort_values\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eby\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e'B'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\ndf \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e df\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003esort\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'col1'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'col2'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'col3'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003eascending\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n#\n\n# window \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e\n# \u003cspan class=\"token constant\"\u003eSELECT\u003c/span\u003e a\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e b\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e c\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token function\"\u003erank\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token constant\"\u003eOVER\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token constant\"\u003ePARTITION\u003c/span\u003e \u003cspan class=\"token constant\"\u003eBY\u003c/span\u003e a \u003cspan class=\"token constant\"\u003eORDER\u003c/span\u003e \u003cspan class=\"token constant\"\u003eBY\u003c/span\u003e b \u003cspan class=\"token constant\"\u003eDESC\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e rn \u003cspan class=\"token constant\"\u003eFROM\u003c/span\u003e df\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n# 如果没有这个 window \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e 的话，可以 groupby 一下，然后生成表和原有表进行 \u003cspan class=\"token constant\"\u003eJOIN\u003c/span\u003e\ntips\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eassign\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ern\u003cspan class=\"token operator\"\u003e=\u003c/span\u003etips\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003esort_values\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'b'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ascending\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eFalse\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egroupby\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'a'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ecumcount\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n# Top \u003cspan class=\"token constant\"\u003eN\u003c/span\u003e rows per group\n# rank 代表等级 如果两人并列第一名，则不存在第二名，直接是第三名 \u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e row_number 代表排名，即即便两个人分数一样，也无法并列第一名\n\n# PostGRESQL's \u003cspan class=\"token constant\"\u003eROW_NUMBER\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e analytic \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e\n\u003cspan class=\"token constant\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token constant\"\u003eFROM\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  \u003cspan class=\"token constant\"\u003eSELECT\u003c/span\u003e\n    t\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token constant\"\u003eROW_NUMBER\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token constant\"\u003eOVER\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token constant\"\u003ePARTITION\u003c/span\u003e \u003cspan class=\"token constant\"\u003eBY\u003c/span\u003e day \u003cspan class=\"token constant\"\u003eORDER\u003c/span\u003e \u003cspan class=\"token constant\"\u003eBY\u003c/span\u003e total_bill \u003cspan class=\"token constant\"\u003eDESC\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token constant\"\u003eAS\u003c/span\u003e rn\n  \u003cspan class=\"token constant\"\u003eFROM\u003c/span\u003e tips t\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e tt\n\u003cspan class=\"token constant\"\u003eWHERE\u003c/span\u003e rn \u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"token number\"\u003e3\u003c/span\u003e\n\u003cspan class=\"token constant\"\u003eORDER\u003c/span\u003e \u003cspan class=\"token constant\"\u003eBY\u003c/span\u003e day\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e rn\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etips\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eassign\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ern\u003cspan class=\"token operator\"\u003e=\u003c/span\u003etips\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003esort_values\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'total_bill'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ascending\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eFalse\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n                    \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egroupby\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'day'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n                    \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ecumcount\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003equery\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'rn \u0026lt; 3'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003esort_values\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'day'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'rn'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etips\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eassign\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ernk\u003cspan class=\"token operator\"\u003e=\u003c/span\u003etips\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egroupby\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'day'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'total_bill'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n                     \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003erank\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emethod\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e'first'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ascending\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eFalse\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003equery\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'rnk \u0026lt; 3'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003esort_values\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'day'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'rnk'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n# PostGRESQL's \u003cspan class=\"token constant\"\u003eRANK\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e analytic \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e\n\u003cspan class=\"token constant\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token constant\"\u003eFROM\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  \u003cspan class=\"token constant\"\u003eSELECT\u003c/span\u003e\n    t\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token constant\"\u003eRANK\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token constant\"\u003eOVER\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token constant\"\u003ePARTITION\u003c/span\u003e \u003cspan class=\"token constant\"\u003eBY\u003c/span\u003e sex \u003cspan class=\"token constant\"\u003eORDER\u003c/span\u003e \u003cspan class=\"token constant\"\u003eBY\u003c/span\u003e tip\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token constant\"\u003eAS\u003c/span\u003e rnk\n  \u003cspan class=\"token constant\"\u003eFROM\u003c/span\u003e tips t\n  \u003cspan class=\"token constant\"\u003eWHERE\u003c/span\u003e tip \u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token constant\"\u003eWHERE\u003c/span\u003e rnk \u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"token number\"\u003e3\u003c/span\u003e\n\u003cspan class=\"token constant\"\u003eORDER\u003c/span\u003e \u003cspan class=\"token constant\"\u003eBY\u003c/span\u003e sex\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e rnk\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etips\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003etips\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'tip'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n     \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eassign\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ernk_min\u003cspan class=\"token operator\"\u003e=\u003c/span\u003etips\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egroupby\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'sex'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'tip'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n                         \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003erank\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emethod\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e'min'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003equery\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'rnk_min \u0026lt; 3'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n     \u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003esort_values\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'sex'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'rnk_min'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n# where 语句\ndf\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'a'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eisnull\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\ndf\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'a'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eisin\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003earr\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n# groupby\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egroupby\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'a'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003esize\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e # 计算 a\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egroupby\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'a'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'b'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ecount\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e # 同上计算 a\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egroupby\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'a'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ecount\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e # 计算所有 cols\nagg_fun_dict \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token string\"\u003e'tip'\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e np\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003emean\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'day'\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e np\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003esize\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\nagg_fun_dict_new \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token string\"\u003e'tip'\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003enp\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003emean\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e np\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003esize\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egroupby\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'a'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'b'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'c'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eagg\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eagg_fun_dict\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egroupby\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'a'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'b'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003edescribe\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eage\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eagg\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'min'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'max'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eapplymap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emultiply_10_for_every_int\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e #\n\ncalc_groups \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e df\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egroupby\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003edate\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\ncalc_groups\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'id_aa'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003enunique\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ereset_index\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eto_excel\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"123.xlsx\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n# pivot\npd\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003epivot_table\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edata\u003cspan class=\"token operator\"\u003e=\u003c/span\u003edf\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003evalues\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e'value_col'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e index\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e'A_FROM'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e columns\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e'B_TO'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e aggfunc\u003cspan class=\"token operator\"\u003e=\u003c/span\u003elambda x\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token function\"\u003elen\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ex\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eunique\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003emargins\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eTrue\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n# \u003cspan class=\"token constant\"\u003eCONCAT\u003c/span\u003e\nappend\n# \u003cspan class=\"token constant\"\u003eJOIN\u003c/span\u003e\npd\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003emerge\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edf1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e df2\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e on\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e'key'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e how\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e'outer'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n# \u003cspan class=\"token constant\"\u003eUPDATE\u003c/span\u003e tips \u003cspan class=\"token constant\"\u003eSET\u003c/span\u003e tip \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e tip\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token number\"\u003e2\u003c/span\u003e \u003cspan class=\"token constant\"\u003eWHERE\u003c/span\u003e tip \u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\ntips\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eloc\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003etips\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'tip'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'tip'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*=\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\n\n# \u003cspan class=\"token constant\"\u003eTODO\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"25-表变换\"\u003e\u003ca class=\"v-toc-item\" href=\"#25-表变换\"\u003e#\u003c/a\u003e 2.5 表变换\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-python\"\u003e# apply \u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e apply map\nDataFrame\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eapply operates on entire rows or columns at a time\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\nDataFrame\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eapplymap\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e Series\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eapply\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e and Series\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003emap operate on one element at time\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"26-表遍历\"\u003e\u003ca class=\"v-toc-item\" href=\"#26-表遍历\"\u003e#\u003c/a\u003e 2.6 表遍历\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-python\"\u003edf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eiterrows\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eitertuples\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"数据导入导出\"\u003e\u003ca class=\"v-toc-item\" href=\"#数据导入导出\"\u003e#\u003c/a\u003e 数据导入导出\u003c/h2\u003e\n\u003ch3 id=\"sql\"\u003e\u003ca class=\"v-toc-item\" href=\"#sql\"\u003e#\u003c/a\u003e SQL\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-python\"\u003efrom sqlalchemy \u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e create_engine\nfrom sqlalchemy\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eengine\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eurl \u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token constant\"\u003eURL\u003c/span\u003e\n\u003cspan class=\"token constant\"\u003eDATABASE\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token string\"\u003e'drivername'\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'postgres'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token string\"\u003e'host'\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'localhost'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token string\"\u003e'port'\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'5432'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token string\"\u003e'username'\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'yourusername'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token string\"\u003e'password'\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'yourpass'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token string\"\u003e'database'\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'yourdb'\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n# 这里并不建议直接写数据库连接字符串，而是使用 \u003cspan class=\"token constant\"\u003eURL\u003c/span\u003e 函数，这样可以避免转义字符带来的坑，比如 @ 在数据库连接字符串是 \u003cspan class=\"token operator\"\u003e%\u003c/span\u003e\u003cspan class=\"token number\"\u003e40\u003c/span\u003e\nengine \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003ecreate_engine\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token constant\"\u003eURL\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e**\u003c/span\u003e\u003cspan class=\"token constant\"\u003eDATABASE\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n# 读一整张表\n\u003cspan class=\"token keyword\"\u003ewith\u003c/span\u003e engine\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003econnect\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e conn\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e conn\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ebegin\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e\n    data \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e pd\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eread_sql_table\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'yourtablehere'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e conn\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003eprocessyourdata\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edata\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n# 按照 \u003cspan class=\"token constant\"\u003eSQL\u003c/span\u003e 语句来读\n\u003cspan class=\"token keyword\"\u003ewith\u003c/span\u003e engine\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003econnect\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e conn\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e conn\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ebegin\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e\n    data \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e pd\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eread_sql\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"\"\u003c/span\u003e\"\n    yoursqlquery\n    \u003cspan class=\"token string\"\u003e\"\"\u003c/span\u003e\"\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e conn\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token function\"\u003eprocessyourdata\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edata\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"csv\"\u003e\u003ca class=\"v-toc-item\" href=\"#csv\"\u003e#\u003c/a\u003e CSV\u003c/h3\u003e\n\u003cp\u003e日常数据处理用 CSV 的比较多，因为这种格式语法简洁，类二维表，读写速度快，而且配合 gzip 压缩解压。\u003c/p\u003e\n\u003cp\u003epandas 在 windows 上好像不能读取中文路径？\u003c/p\u003e\n\u003cp\u003e而且，pandas 读取的时候要注意指定编码。因为在日常导出 CSV 的时往往使用的是 utf-8, 而 windows 默认打开文本文件时候使用的是 gbk\u003c/p\u003e\n\u003cp\u003eread_csv 有几十个参数，挑几个说一下：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003esep 可以指定分隔符，默认为’,', 但有的人导出的数据以 tab 为空格。\u003c/li\u003e\n\u003cli\u003edtype 可以指定某些列的值类型为 int,float 的类型从而减少 object 的创建 , 但是对 str/object 没有什么暖用\u003c/li\u003e\n\u003cli\u003eparse_dates 可以指定 date 列\u003c/li\u003e\n\u003cli\u003eheader 如果 CSV 没有 Header, 可以指定为 None\u003c/li\u003e\n\u003cli\u003eusecols 可以指定几列，相当于数据库中的 SELECT a_col,b_col\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e其中还有一些比较有趣的东西，比如说，iterator=True\u003cbr\u003e\n值得注意的是，通过\u003c/p\u003e\n\u003ch3 id=\"excel\"\u003e\u003ca class=\"v-toc-item\" href=\"#excel\"\u003e#\u003c/a\u003e Excel\u003c/h3\u003e\n\u003cp\u003eGotchas\u003c/p\u003e\n\u003ch2 id=\"0x02-可视化技术\"\u003e\u003ca class=\"v-toc-item\" href=\"#0x02-可视化技术\"\u003e#\u003c/a\u003e 0x02 可视化技术\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"language-python\"\u003e# 绘制\ndf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eplot\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ekind\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e'bar'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\nplt\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003exlabel\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'xlable'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nplt\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eylabel\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'ylable'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nplt\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003etitle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'title name'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\nplt\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eshow\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\ndf\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'数量'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eplot\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ekind\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e'bar'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n# 批量创建图\ng \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e sns\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eFacetGrid\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecustomers\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e col\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"cola\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\ng\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003emap\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eplt\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003escatter\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"数量\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"单位\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e alpha\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\ng\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eadd_legend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\nttbill \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e sns\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003edistplot\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etips\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"总价格\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\nttbill\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eset\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003exlabel \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'价值'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e ylabel \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'频率'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e title \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"标题名\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nsns\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003edespine\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\nsns\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ejointplot\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ex \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"total_bill\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e y \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"tip\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e data \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e tips\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n# https\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e\u003cspan class=\"token operator\"\u003e/\u003c/span\u003e\u003cspan class=\"token operator\"\u003e/\u003c/span\u003egithub\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ecom\u003cspan class=\"token operator\"\u003e/\u003c/span\u003eguipsamora\u003cspan class=\"token operator\"\u003e/\u003c/span\u003epandas_exercises\u003cspan class=\"token operator\"\u003e/\u003c/span\u003eblob\u003cspan class=\"token operator\"\u003e/\u003c/span\u003emaster\u003cspan class=\"token operator\"\u003e/\u003c/span\u003e\u003cspan class=\"token number\"\u003e07\u003c/span\u003e_Visualization\u003cspan class=\"token operator\"\u003e/\u003c/span\u003eTips\u003cspan class=\"token operator\"\u003e/\u003c/span\u003eExercises_with_code_and_solutions\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eipynb\n\nplt\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003epie\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e100\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token number\"\u003e300\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    labels \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'男'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'女'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    shadow \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e False\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    colors \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'blue'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e'red'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    explode \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e0.15\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    startangle \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e90\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    autopct \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'%1.1f%%'\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nplt\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eaxis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'equal'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nplt\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003etitle\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"男女比例\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nplt\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003etight_layout\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nplt\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eshow\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"0x03-asd1\"\u003e\u003ca class=\"v-toc-item\" href=\"#0x03-asd1\"\u003e#\u003c/a\u003e 0x03 asd1\u003c/h2\u003e\n\u003ch2 id=\"0x07-performance-tips\"\u003e\u003ca class=\"v-toc-item\" href=\"#0x07-performance-tips\"\u003e#\u003c/a\u003e 0x07 Performance Tips\u003c/h2\u003e\n\u003cp\u003e最近遇到了数据量比较大的数据处理，数据条数差不多在 3 千万条。加载到内存中大约 1GB.\u003c/p\u003e\n\u003ch3 id=\"71-精简行列\"\u003e\u003ca class=\"v-toc-item\" href=\"#71-精简行列\"\u003e#\u003c/a\u003e 7.1 精简行列\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e读入 dataframe 的时候就排除多余的行列。\u003c/li\u003e\n\u003cli\u003eMerge 时候需要精简行列。\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode class=\"language-python\"\u003edf1\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003emerge\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edf2\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token function\"\u003elist\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'xab'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\npandas\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003emerge\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edataframe1\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e dataframe2\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eiloc\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e\u003cspan class=\"token number\"\u003e5\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e how\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e'left'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e on\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e'key'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"72-大文件的处理\"\u003e\u003ca class=\"v-toc-item\" href=\"#72-大文件的处理\"\u003e#\u003c/a\u003e 7.2 大文件的处理\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e参考我的文章 记一次小机器的 Python 大数据分析\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch2 id=\"0x-踩坑集合\"\u003e\u003ca class=\"v-toc-item\" href=\"#0x-踩坑集合\"\u003e#\u003c/a\u003e 0x 踩坑集合\u003c/h2\u003e\n\u003ch2 id=\"0x08-踩坑集合\"\u003e\u003ca class=\"v-toc-item\" href=\"#0x08-踩坑集合\"\u003e#\u003c/a\u003e 0x08 踩坑集合\u003c/h2\u003e\n\u003ch3 id=\"81-io-类\"\u003e\u003ca class=\"v-toc-item\" href=\"#81-io-类\"\u003e#\u003c/a\u003e 8.1 IO 类\u003c/h3\u003e\n\u003ch4 id=\"\"\u003e\u003ca class=\"v-toc-item\" href=\"#\"\u003e#\u003c/a\u003e \u003c/h4\u003e\n\u003ch3 id=\"82-io-类\"\u003e\u003ca class=\"v-toc-item\" href=\"#82-io-类\"\u003e#\u003c/a\u003e 8.2 IO 类\u003c/h3\u003e\n\u003ch2 id=\"0xee-参考链接\"\u003e\u003ca class=\"v-toc-item\" href=\"#0xee-参考链接\"\u003e#\u003c/a\u003e 0xEE 参考链接\u003c/h2\u003e\n\u003chr\u003e\n\u003cp\u003eChangeLog:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e2017-06-03\u003c/strong\u003e 初始化本文\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003e2018-02-03\u003c/strong\u003e 重修文字\u003c/li\u003e\n\u003c/ul\u003e\n","toc":"\u003cul class=\"v-article-toc\"\u003e\n\u003cli\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#0x00-%E5%89%8D%E8%A8%80\"\u003e0x00 前言\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#0x01-series-%E7%9B%B8%E5%85%B3\"\u003e0x01 Series 相关\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#0x02-dataframe-%E7%9B%B8%E5%85%B3\"\u003e0x02 DataFrame 相关\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#21-%E5%AF%B9%E8%B1%A1%E5%88%9B%E5%BB%BA\"\u003e2.1 对象创建\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#22-%E6%B5%8F%E8%A7%88%E6%95%B0%E6%8D%AE\"\u003e2.2 浏览数据\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#23-%E4%BF%AE%E6%94%B9%E8%A1%A8%E5%86%85%E5%AE%B9\"\u003e2.3 修改表内容\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#24-%E6%9F%A5%E7%9C%8B%E8%A1%A8%E5%86%85%E5%AE%B9\"\u003e2.4 查看表内容\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#25-%E8%A1%A8%E5%8F%98%E6%8D%A2\"\u003e2.5 表变换\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#26-%E8%A1%A8%E9%81%8D%E5%8E%86\"\u003e2.6 表遍历\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA\"\u003e数据导入导出\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#sql\"\u003eSQL\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#csv\"\u003eCSV\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#excel\"\u003eExcel\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#0x02-%E5%8F%AF%E8%A7%86%E5%8C%96%E6%8A%80%E6%9C%AF\"\u003e0x02 可视化技术\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#0x03-asd1\"\u003e0x03 asd1\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#0x07-performance-tips\"\u003e0x07 Performance Tips\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#71-%E7%B2%BE%E7%AE%80%E8%A1%8C%E5%88%97\"\u003e7.1 精简行列\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#72-%E5%A4%A7%E6%96%87%E4%BB%B6%E7%9A%84%E5%A4%84%E7%90%86\"\u003e7.2 大文件的处理\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#0x-%E8%B8%A9%E5%9D%91%E9%9B%86%E5%90%88\"\u003e0x 踩坑集合\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#0x08-%E8%B8%A9%E5%9D%91%E9%9B%86%E5%90%88\"\u003e0x08 踩坑集合\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#81-io-%E7%B1%BB\"\u003e8.1 IO 类\u003c/a\u003e\u003cbr\u003e\n*\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#82-io-%E7%B1%BB\"\u003e8.2 IO 类\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#0xee-%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5\"\u003e0xEE 参考链接\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n"}},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"Pandas CheatSheet"},"buildId":"oDi_oBCBuu3qj6v7hDnrL","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>