<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Python 中的数据压缩和存档 | 海拉鲁编程客</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/49455a07b6dd33600cdf.css" as="style"/><link rel="stylesheet" href="/_next/static/css/49455a07b6dd33600cdf.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a54b4f32bdc1ef890ddd.js"></script><script src="/_next/static/chunks/webpack-20d43e08bea62467b090.js" defer=""></script><script src="/_next/static/chunks/framework-0441fae7fd130f37dee1.js" defer=""></script><script src="/_next/static/chunks/main-4777350f2a9ff73ea2b0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-3050679c6e5142ffcaf5.js" defer=""></script><script src="/_next/static/chunks/ea88be26-9bcf6ead520f4ac26973.js" defer=""></script><script src="/_next/static/chunks/421-f2f33a86b546237f0325.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-173fe2de48c90365db9d.js" defer=""></script><script src="/_next/static/uCwe9m-iio9bnoWMgWDqE/_buildManifest.js" defer=""></script><script src="/_next/static/uCwe9m-iio9bnoWMgWDqE/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="v-page"><nav class="shadow"><div class="flex flex-col container mx-auto h-12 px-40 md:flex-row md:items-center md:justify-between"><div class="flex justify-between items-center"><div><a class="text-gray-800 text-xl md:text-xl leading-5" href="/">海拉鲁编程客</a></div><div><button type="button" class="block text-gray-800 hover:text-gray-600 focus:text-gray-600 focus:outline-none md:hidden"><svg viewBox="0 0 24 24" class="h-6 w-6 fill-current"><path d="M4 5h16a1 1 0 0 1 0 2H4a1 1 0 1 1 0-2zm0 6h16a1 1 0 0 1 0 2H4a1 1 0 0 1 0-2zm0 6h16a1 1 0 0 1 0 2H4a1 1 0 0 1 0-2z"></path></svg></button></div></div><div class="md:flex flex-col md:flex-row md:-mx-4 hidden"><a class="my-1 text-gray-800 hover:text-blue-500 md:mx-4 md:my-0" href="/">首页</a><a class="my-1 text-gray-800 hover:text-blue-500 md:mx-4 md:my-0" href="/archive">归档</a><a class="my-1 text-gray-800 hover:text-blue-500 md:mx-4 md:my-0" href="/about">关于我</a><button style="cursor:pointer;overflow:hidden;width:50px;height:23.5px;appearance:none;-moz-appearance:none;-webkit-appearance:none;border:none;background-color:transparent;padding:0" aria-hidden="true"><div style="display:flex;align-items:center;justify-content:center;margin-top:-28.749999999999996px;margin-left:-16px;width:82.5px;height:82.5px"><div></div></div></button></div></div></nav><div class="v-article"><div class="v-article-main" style="margin:auto;width:786px"><div><h2 id="0x00-前言"><a class="v-toc-item" href="#0x00-前言">#</a> 0x00 前言</h2>
<p>在一次数据分析过程中，对方扔过来 40GB 的数据 – data.tar.gz .</p>
<p>我想着能不能直接用 pandas 直接读取这个文件呢？查找了一些资料，于是有了本文。</p>
<p>Python 中支持如下：</p>
<ul>
<li>数据压缩算法：zlib, gzip, bzip2 and lzma</li>
<li>存档格式：zip 以及 tar</li>
</ul>
<h2 id="0x01-压缩是怎么回事"><a class="v-toc-item" href="#0x01-压缩是怎么回事">#</a> 0x01 压缩是怎么回事？</h2>
<h2 id="0x02-zlib-与-gzip"><a class="v-toc-item" href="#0x02-zlib-与-gzip">#</a> 0x02 zlib 与 gzip</h2>
<p>gzip 依赖于 zlib</p>
<pre><code># 读取压缩文件
import gzip
with gzip.open('/home/joe/file.txt.gz', 'rb') as f:
    file_content = f.read()

# 写入压缩文件
import gzip
content = b&quot;Lots of content here&quot;
with gzip.open('/home/joe/file.txt.gz', 'wb') as f:
    f.write(content)

# 拷贝压缩文件
import gzip
import shutil
with open('/home/joe/file.txt', 'rb') as f_in:
    with gzip.open('/home/joe/file.txt.gz', 'wb') as f_out:
        shutil.copyfileobj(f_in, f_out)

# 压缩二进制字符串
import gzip
s_in = b&quot;Lots of content here&quot;
s_out = gzip.compress(s_in)
</code></pre>
<hr>
<p>ChangeLog:</p>
<ul>
<li><strong>2017-12-20</strong> 初始化本文</li>
</ul>
</div></div><div><ul class="v-article-toc">
<li>
<ul>
<li><a href="#0x00-%E5%89%8D%E8%A8%80">0x00 前言</a></li>
<li><a href="#0x01-%E5%8E%8B%E7%BC%A9%E6%98%AF%E6%80%8E%E4%B9%88%E5%9B%9E%E4%BA%8B">0x01 压缩是怎么回事？</a></li>
<li><a href="#0x02-zlib-%E4%B8%8E-gzip">0x02 zlib 与 gzip</a></li>
</ul>
</li>
</ul>
</div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"tags":["Python"],"path":"20180123_PythonCompression.md","title":"Python 中的数据压缩和存档","slug":"Python 中的数据压缩和存档","date":"2018-01-23","category":"Python","lastMod":"2020-01-01","description":"这篇文章展示了基本的 Markdown 语法和格式.","thumbnail":"","content":"\u003ch2 id=\"0x00-前言\"\u003e\u003ca class=\"v-toc-item\" href=\"#0x00-前言\"\u003e#\u003c/a\u003e 0x00 前言\u003c/h2\u003e\n\u003cp\u003e在一次数据分析过程中，对方扔过来 40GB 的数据 – data.tar.gz .\u003c/p\u003e\n\u003cp\u003e我想着能不能直接用 pandas 直接读取这个文件呢？查找了一些资料，于是有了本文。\u003c/p\u003e\n\u003cp\u003ePython 中支持如下：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e数据压缩算法：zlib, gzip, bzip2 and lzma\u003c/li\u003e\n\u003cli\u003e存档格式：zip 以及 tar\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"0x01-压缩是怎么回事\"\u003e\u003ca class=\"v-toc-item\" href=\"#0x01-压缩是怎么回事\"\u003e#\u003c/a\u003e 0x01 压缩是怎么回事？\u003c/h2\u003e\n\u003ch2 id=\"0x02-zlib-与-gzip\"\u003e\u003ca class=\"v-toc-item\" href=\"#0x02-zlib-与-gzip\"\u003e#\u003c/a\u003e 0x02 zlib 与 gzip\u003c/h2\u003e\n\u003cp\u003egzip 依赖于 zlib\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e# 读取压缩文件\nimport gzip\nwith gzip.open('/home/joe/file.txt.gz', 'rb') as f:\n    file_content = f.read()\n\n# 写入压缩文件\nimport gzip\ncontent = b\u0026quot;Lots of content here\u0026quot;\nwith gzip.open('/home/joe/file.txt.gz', 'wb') as f:\n    f.write(content)\n\n# 拷贝压缩文件\nimport gzip\nimport shutil\nwith open('/home/joe/file.txt', 'rb') as f_in:\n    with gzip.open('/home/joe/file.txt.gz', 'wb') as f_out:\n        shutil.copyfileobj(f_in, f_out)\n\n# 压缩二进制字符串\nimport gzip\ns_in = b\u0026quot;Lots of content here\u0026quot;\ns_out = gzip.compress(s_in)\n\u003c/code\u003e\u003c/pre\u003e\n\u003chr\u003e\n\u003cp\u003eChangeLog:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003e2017-12-20\u003c/strong\u003e 初始化本文\u003c/li\u003e\n\u003c/ul\u003e\n","toc":"\u003cul class=\"v-article-toc\"\u003e\n\u003cli\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#0x00-%E5%89%8D%E8%A8%80\"\u003e0x00 前言\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#0x01-%E5%8E%8B%E7%BC%A9%E6%98%AF%E6%80%8E%E4%B9%88%E5%9B%9E%E4%BA%8B\"\u003e0x01 压缩是怎么回事？\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#0x02-zlib-%E4%B8%8E-gzip\"\u003e0x02 zlib 与 gzip\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n"}},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"Python 中的数据压缩和存档"},"buildId":"uCwe9m-iio9bnoWMgWDqE","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>