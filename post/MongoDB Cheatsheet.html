<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>MongoDB Cheatsheet | 海拉鲁编程客</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/49455a07b6dd33600cdf.css" as="style"/><link rel="stylesheet" href="/_next/static/css/49455a07b6dd33600cdf.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a54b4f32bdc1ef890ddd.js"></script><script src="/_next/static/chunks/webpack-20d43e08bea62467b090.js" defer=""></script><script src="/_next/static/chunks/framework-0441fae7fd130f37dee1.js" defer=""></script><script src="/_next/static/chunks/main-4777350f2a9ff73ea2b0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-3050679c6e5142ffcaf5.js" defer=""></script><script src="/_next/static/chunks/ea88be26-9bcf6ead520f4ac26973.js" defer=""></script><script src="/_next/static/chunks/421-f2f33a86b546237f0325.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-173fe2de48c90365db9d.js" defer=""></script><script src="/_next/static/oDi_oBCBuu3qj6v7hDnrL/_buildManifest.js" defer=""></script><script src="/_next/static/oDi_oBCBuu3qj6v7hDnrL/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="v-page"><nav class="shadow"><div class="flex flex-col container mx-auto h-12 px-40 md:flex-row md:items-center md:justify-between"><div class="flex justify-between items-center"><div><a class="text-gray-800 text-xl md:text-xl leading-5" href="/">海拉鲁编程客</a></div><div><button type="button" class="block text-gray-800 hover:text-gray-600 focus:text-gray-600 focus:outline-none md:hidden"><svg viewBox="0 0 24 24" class="h-6 w-6 fill-current"><path d="M4 5h16a1 1 0 0 1 0 2H4a1 1 0 1 1 0-2zm0 6h16a1 1 0 0 1 0 2H4a1 1 0 0 1 0-2zm0 6h16a1 1 0 0 1 0 2H4a1 1 0 0 1 0-2z"></path></svg></button></div></div><div class="md:flex flex-col md:flex-row md:-mx-4 hidden"><a class="my-1 text-gray-800 hover:text-blue-500 md:mx-4 md:my-0" href="/">首页</a><a class="my-1 text-gray-800 hover:text-blue-500 md:mx-4 md:my-0" href="/archive">归档</a><a class="my-1 text-gray-800 hover:text-blue-500 md:mx-4 md:my-0" href="/about">关于我</a><button style="cursor:pointer;overflow:hidden;width:50px;height:23.5px;appearance:none;-moz-appearance:none;-webkit-appearance:none;border:none;background-color:transparent;padding:0" aria-hidden="true"><div style="display:flex;align-items:center;justify-content:center;margin-top:-28.749999999999996px;margin-left:-16px;width:82.5px;height:82.5px"><div></div></div></button></div></div></nav><div class="v-article"><div class="v-article-main" style="margin:auto;width:786px"><div><h1 id="mongodb-cheatsheet"><a class="v-toc-item" href="#mongodb-cheatsheet">#</a> MongoDB Cheatsheet</h1>
<h2 id="0x01-前言"><a class="v-toc-item" href="#0x01-前言">#</a> 0x01 前言</h2>
<p>本文为 Cheatsheet 类型文章，用于记录我在日常编程中经常使用的 MongoDB 相关命令。</p>
<ul>
<li>Mongo Shell</li>
<li>Mongo 配套工具</li>
<li>Python API</li>
</ul>
<p>不定期更新。</p>
<!-- more -->
<h2 id="0x02-安装"><a class="v-toc-item" href="#0x02-安装">#</a> 0x02 安装</h2>
<pre><code class="language-bash"># MacOS 安装
brew install mongodb
brew services start mongodb
# Ubuntu Server <span class="token number">16.04</span>
sudo apt<span class="token operator">-</span>key adv <span class="token operator">--</span>keyserver hkp<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>keyserver<span class="token punctuation">.</span>ubuntu<span class="token punctuation">.</span>com<span class="token operator">:</span><span class="token number">80</span> <span class="token operator">--</span>recv <span class="token constant">EA312927</span>
echo <span class="token string">"deb http://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/3.2 multiverse"</span> <span class="token operator">|</span> sudo tee <span class="token operator">/</span>etc<span class="token operator">/</span>apt<span class="token operator">/</span>sources<span class="token punctuation">.</span>list<span class="token punctuation">.</span>d<span class="token operator">/</span>mongodb<span class="token operator">-</span>org<span class="token operator">-</span><span class="token number">3.2</span><span class="token punctuation">.</span>list
apt<span class="token operator">-</span><span class="token keyword">get</span> update <span class="token operator">-</span>y
apt<span class="token operator">-</span><span class="token keyword">get</span> install <span class="token operator">-</span>y mongodb<span class="token operator">-</span>org
service mongod start
</code></pre>
<h2 id="0x03-配置"><a class="v-toc-item" href="#0x03-配置">#</a> 0x03 配置</h2>
<h3 id="ip-地址"><a class="v-toc-item" href="#ip-地址">#</a> IP 地址</h3>
<h2 id="mongodb-配套工具"><a class="v-toc-item" href="#mongodb-配套工具">#</a> MongoDB 配套工具</h2>
<ul>
<li>RoboMongo</li>
<li>通过网络或者 Dash 查看文档</li>
<li>Mongo 官方自带工具</li>
</ul>
<h2 id="mongodb-shell"><a class="v-toc-item" href="#mongodb-shell">#</a> MongoDB Shell</h2>
<h2 id="基本查询"><a class="v-toc-item" href="#基本查询">#</a> 基本查询</h2>
<p>db.users.find({“name”: /.<em>m.</em>/})<br>
db.users.find({‘name’: {‘$regex’: ‘sometext’}})</p>
<p><a href="https://docs.mongodb.com/manual/">https://docs.mongodb.com/manual/</a></p>
<h3 id="增删改查"><a class="v-toc-item" href="#增删改查">#</a> 增删改查</h3>
<p>use myNewDatabase<br>
db.myCollection.insert( { x: 1 } );</p>
<h3 id="聚合操作"><a class="v-toc-item" href="#聚合操作">#</a> 聚合操作</h3>
<h2 id="pymongo"><a class="v-toc-item" href="#pymongo">#</a> PyMongo</h2>
<pre><code class="language-bash"># 建索引的时候，会阻塞当前的操作，甚至是查询操作
# 据说转为 background 方式不会阻塞但是，没有实践过
<span class="token string">"msg"</span> <span class="token operator">:</span> <span class="token string">"Index Build Index Build: 167413/751748 22%"</span><span class="token punctuation">,</span>
<span class="token string">"progress"</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
	<span class="token string">"done"</span> <span class="token operator">:</span> <span class="token number">167413</span><span class="token punctuation">,</span>
	<span class="token string">"total"</span> <span class="token operator">:</span> <span class="token number">751748</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
</div></div><div><ul class="v-article-toc">
<li><a href="#mongodb-cheatsheet">MongoDB Cheatsheet</a>
<ul>
<li><a href="#0x01-%E5%89%8D%E8%A8%80">0x01 前言</a></li>
<li><a href="#0x02-%E5%AE%89%E8%A3%85">0x02 安装</a></li>
<li><a href="#0x03-%E9%85%8D%E7%BD%AE">0x03 配置</a>
<ul>
<li><a href="#ip-%E5%9C%B0%E5%9D%80">IP 地址</a></li>
</ul>
</li>
<li><a href="#mongodb-%E9%85%8D%E5%A5%97%E5%B7%A5%E5%85%B7">MongoDB 配套工具</a></li>
<li><a href="#mongodb-shell">MongoDB Shell</a></li>
<li><a href="#%E5%9F%BA%E6%9C%AC%E6%9F%A5%E8%AF%A2">基本查询</a>
<ul>
<li><a href="#%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5">增删改查</a></li>
<li><a href="#%E8%81%9A%E5%90%88%E6%93%8D%E4%BD%9C">聚合操作</a></li>
</ul>
</li>
<li><a href="#pymongo">PyMongo</a></li>
</ul>
</li>
</ul>
</div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"tags":["PostgreSQL"],"path":"20161209_MongoCheatSheet.md","title":"MongoDB Cheatsheet","slug":"MongoDB Cheatsheet","date":"2016-12-09","category":"DevOps","lastMod":"2020-01-01","description":"这篇文章展示了基本的 Markdown 语法和格式.","thumbnail":"","content":"\u003ch1 id=\"mongodb-cheatsheet\"\u003e\u003ca class=\"v-toc-item\" href=\"#mongodb-cheatsheet\"\u003e#\u003c/a\u003e MongoDB Cheatsheet\u003c/h1\u003e\n\u003ch2 id=\"0x01-前言\"\u003e\u003ca class=\"v-toc-item\" href=\"#0x01-前言\"\u003e#\u003c/a\u003e 0x01 前言\u003c/h2\u003e\n\u003cp\u003e本文为 Cheatsheet 类型文章，用于记录我在日常编程中经常使用的 MongoDB 相关命令。\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eMongo Shell\u003c/li\u003e\n\u003cli\u003eMongo 配套工具\u003c/li\u003e\n\u003cli\u003ePython API\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e不定期更新。\u003c/p\u003e\n\u003c!-- more --\u003e\n\u003ch2 id=\"0x02-安装\"\u003e\u003ca class=\"v-toc-item\" href=\"#0x02-安装\"\u003e#\u003c/a\u003e 0x02 安装\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# MacOS 安装\nbrew install mongodb\nbrew services start mongodb\n# Ubuntu Server \u003cspan class=\"token number\"\u003e16.04\u003c/span\u003e\nsudo apt\u003cspan class=\"token operator\"\u003e-\u003c/span\u003ekey adv \u003cspan class=\"token operator\"\u003e--\u003c/span\u003ekeyserver hkp\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e\u003cspan class=\"token operator\"\u003e/\u003c/span\u003e\u003cspan class=\"token operator\"\u003e/\u003c/span\u003ekeyserver\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eubuntu\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ecom\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e\u003cspan class=\"token number\"\u003e80\u003c/span\u003e \u003cspan class=\"token operator\"\u003e--\u003c/span\u003erecv \u003cspan class=\"token constant\"\u003eEA312927\u003c/span\u003e\necho \u003cspan class=\"token string\"\u003e\"deb http://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/3.2 multiverse\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e|\u003c/span\u003e sudo tee \u003cspan class=\"token operator\"\u003e/\u003c/span\u003eetc\u003cspan class=\"token operator\"\u003e/\u003c/span\u003eapt\u003cspan class=\"token operator\"\u003e/\u003c/span\u003esources\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elist\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ed\u003cspan class=\"token operator\"\u003e/\u003c/span\u003emongodb\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eorg\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e3.2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elist\napt\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eget\u003c/span\u003e update \u003cspan class=\"token operator\"\u003e-\u003c/span\u003ey\napt\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eget\u003c/span\u003e install \u003cspan class=\"token operator\"\u003e-\u003c/span\u003ey mongodb\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eorg\nservice mongod start\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"0x03-配置\"\u003e\u003ca class=\"v-toc-item\" href=\"#0x03-配置\"\u003e#\u003c/a\u003e 0x03 配置\u003c/h2\u003e\n\u003ch3 id=\"ip-地址\"\u003e\u003ca class=\"v-toc-item\" href=\"#ip-地址\"\u003e#\u003c/a\u003e IP 地址\u003c/h3\u003e\n\u003ch2 id=\"mongodb-配套工具\"\u003e\u003ca class=\"v-toc-item\" href=\"#mongodb-配套工具\"\u003e#\u003c/a\u003e MongoDB 配套工具\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eRoboMongo\u003c/li\u003e\n\u003cli\u003e通过网络或者 Dash 查看文档\u003c/li\u003e\n\u003cli\u003eMongo 官方自带工具\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"mongodb-shell\"\u003e\u003ca class=\"v-toc-item\" href=\"#mongodb-shell\"\u003e#\u003c/a\u003e MongoDB Shell\u003c/h2\u003e\n\u003ch2 id=\"基本查询\"\u003e\u003ca class=\"v-toc-item\" href=\"#基本查询\"\u003e#\u003c/a\u003e 基本查询\u003c/h2\u003e\n\u003cp\u003edb.users.find({“name”: /.\u003cem\u003em.\u003c/em\u003e/})\u003cbr\u003e\ndb.users.find({‘name’: {‘$regex’: ‘sometext’}})\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://docs.mongodb.com/manual/\"\u003ehttps://docs.mongodb.com/manual/\u003c/a\u003e\u003c/p\u003e\n\u003ch3 id=\"增删改查\"\u003e\u003ca class=\"v-toc-item\" href=\"#增删改查\"\u003e#\u003c/a\u003e 增删改查\u003c/h3\u003e\n\u003cp\u003euse myNewDatabase\u003cbr\u003e\ndb.myCollection.insert( { x: 1 } );\u003c/p\u003e\n\u003ch3 id=\"聚合操作\"\u003e\u003ca class=\"v-toc-item\" href=\"#聚合操作\"\u003e#\u003c/a\u003e 聚合操作\u003c/h3\u003e\n\u003ch2 id=\"pymongo\"\u003e\u003ca class=\"v-toc-item\" href=\"#pymongo\"\u003e#\u003c/a\u003e PyMongo\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# 建索引的时候，会阻塞当前的操作，甚至是查询操作\n# 据说转为 background 方式不会阻塞但是，没有实践过\n\u003cspan class=\"token string\"\u003e\"msg\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"Index Build Index Build: 167413/751748 22%\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token string\"\u003e\"progress\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n\t\u003cspan class=\"token string\"\u003e\"done\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e167413\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\t\u003cspan class=\"token string\"\u003e\"total\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token number\"\u003e751748\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n","toc":"\u003cul class=\"v-article-toc\"\u003e\n\u003cli\u003e\u003ca href=\"#mongodb-cheatsheet\"\u003eMongoDB Cheatsheet\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#0x01-%E5%89%8D%E8%A8%80\"\u003e0x01 前言\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#0x02-%E5%AE%89%E8%A3%85\"\u003e0x02 安装\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#0x03-%E9%85%8D%E7%BD%AE\"\u003e0x03 配置\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#ip-%E5%9C%B0%E5%9D%80\"\u003eIP 地址\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#mongodb-%E9%85%8D%E5%A5%97%E5%B7%A5%E5%85%B7\"\u003eMongoDB 配套工具\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#mongodb-shell\"\u003eMongoDB Shell\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E5%9F%BA%E6%9C%AC%E6%9F%A5%E8%AF%A2\"\u003e基本查询\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5\"\u003e增删改查\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E8%81%9A%E5%90%88%E6%93%8D%E4%BD%9C\"\u003e聚合操作\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#pymongo\"\u003ePyMongo\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n"}},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"MongoDB Cheatsheet"},"buildId":"oDi_oBCBuu3qj6v7hDnrL","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>