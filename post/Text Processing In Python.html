<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Text Processing In Python | 海拉鲁编程客</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/49455a07b6dd33600cdf.css" as="style"/><link rel="stylesheet" href="/_next/static/css/49455a07b6dd33600cdf.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a54b4f32bdc1ef890ddd.js"></script><script src="/_next/static/chunks/webpack-20d43e08bea62467b090.js" defer=""></script><script src="/_next/static/chunks/framework-0441fae7fd130f37dee1.js" defer=""></script><script src="/_next/static/chunks/main-4777350f2a9ff73ea2b0.js" defer=""></script><script src="/_next/static/chunks/pages/_app-3050679c6e5142ffcaf5.js" defer=""></script><script src="/_next/static/chunks/ea88be26-9bcf6ead520f4ac26973.js" defer=""></script><script src="/_next/static/chunks/421-f2f33a86b546237f0325.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-173fe2de48c90365db9d.js" defer=""></script><script src="/_next/static/oDi_oBCBuu3qj6v7hDnrL/_buildManifest.js" defer=""></script><script src="/_next/static/oDi_oBCBuu3qj6v7hDnrL/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="v-page"><nav class="shadow"><div class="flex flex-col container mx-auto h-12 px-40 md:flex-row md:items-center md:justify-between"><div class="flex justify-between items-center"><div><a class="text-gray-800 text-xl md:text-xl leading-5" href="/">海拉鲁编程客</a></div><div><button type="button" class="block text-gray-800 hover:text-gray-600 focus:text-gray-600 focus:outline-none md:hidden"><svg viewBox="0 0 24 24" class="h-6 w-6 fill-current"><path d="M4 5h16a1 1 0 0 1 0 2H4a1 1 0 1 1 0-2zm0 6h16a1 1 0 0 1 0 2H4a1 1 0 0 1 0-2zm0 6h16a1 1 0 0 1 0 2H4a1 1 0 0 1 0-2z"></path></svg></button></div></div><div class="md:flex flex-col md:flex-row md:-mx-4 hidden"><a class="my-1 text-gray-800 hover:text-blue-500 md:mx-4 md:my-0" href="/">首页</a><a class="my-1 text-gray-800 hover:text-blue-500 md:mx-4 md:my-0" href="/archive">归档</a><a class="my-1 text-gray-800 hover:text-blue-500 md:mx-4 md:my-0" href="/about">关于我</a><button style="cursor:pointer;overflow:hidden;width:50px;height:23.5px;appearance:none;-moz-appearance:none;-webkit-appearance:none;border:none;background-color:transparent;padding:0" aria-hidden="true"><div style="display:flex;align-items:center;justify-content:center;margin-top:-28.749999999999996px;margin-left:-16px;width:82.5px;height:82.5px"><div></div></div></button></div></div></nav><div class="v-article"><div class="v-article-main" style="margin:auto;width:786px"><div><h1 id="text-processing-in-python"><a class="v-toc-item" href="#text-processing-in-python">#</a> Text Processing In Python</h1>
<h2 id="0x00-前言"><a class="v-toc-item" href="#0x00-前言">#</a> 0x00 前言</h2>
<p>本文为 Cheatsheet 类型文章，用于记录我在日常编程中的文本处理相关思路。</p>
<p>本文的目录为：</p>
<ul>
<li>正则处理相关</li>
<li>HTML/XML 处理相关</li>
<li>Python 中的文本处理</li>
</ul>
<h2 id="0x01-正则处理相关"><a class="v-toc-item" href="#0x01-正则处理相关">#</a> 0x01 正则处理相关</h2>
<h3 id="11-正则表达式"><a class="v-toc-item" href="#11-正则表达式">#</a> 1.1. 正则表达式</h3>
<p>正则是个很奇葩的名字，为什么叫做正则表达式呢，首先是个表达式，其次，这是一种叫做正则 (regular expression, rational expression) 的表达式。<br>
名称为什么叫做 regular 呢，因为它基于 regular language. 而 regular language 是一种 formal language. 得，现在又开始是编译原理相关概念了。为了逃避概念，通过用途来简单定义正则表达式。</p>
<p>简而言之，就是一种用于字符串搜索的模式。或者就是一种领域专用编程语言。</p>
<p><a href="https://en.wikipedia.org/wiki/Regular_expression">https://en.wikipedia.org/wiki/Regular_expression</a></p>
<h3 id="12-python-中正则表达式语法"><a class="v-toc-item" href="#12-python-中正则表达式语法">#</a> 1.2. Python 中正则表达式语法</h3>
<pre><code class="language-python"># 元字符
<span class="token punctuation">.</span> <span class="token operator">^</span> $ <span class="token operator">*</span> <span class="token operator">+</span> <span class="token operator">?</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span> \ <span class="token operator">|</span> <span class="token punctuation">(</span> <span class="token punctuation">)</span>

<span class="token operator">*</span> # 速记，天上一个星星都没有，<span class="token number">0</span> 到多个。
<span class="token operator">+</span> # 一加手机<span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">1</span> 到多个。
<span class="token operator">?</span> # 有还是没有 即 <span class="token number">0</span> or <span class="token number">1</span>
<span class="token operator">*</span><span class="token operator">?</span> # 没有疑问就是贪婪，有疑问就是非贪婪
<span class="token operator">+</span><span class="token operator">?</span>
<span class="token operator">??</span>

<span class="token punctuation">{</span>m<span class="token punctuation">}</span> # m 份
<span class="token punctuation">{</span>m<span class="token punctuation">,</span>n<span class="token punctuation">}</span> # 优先匹配 a<span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">}</span>b 优先匹配 aaaab 中 aaaab
<span class="token punctuation">{</span>m<span class="token punctuation">,</span>n<span class="token punctuation">}</span><span class="token operator">?</span> # 优先匹配 a<span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">}</span>b 优先匹配 aaaab 中 aab

<span class="token punctuation">[</span><span class="token punctuation">]</span> # <span class="token punctuation">[</span>a\<span class="token operator">-</span>z<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token punctuation">[</span>az<span class="token operator">-</span><span class="token punctuation">]</span>
# <span class="token number">1.</span> <span class="token punctuation">[</span>\w<span class="token punctuation">]</span> <span class="token punctuation">[</span>\<span class="token constant">S</span><span class="token punctuation">]</span>
# <span class="token number">2.</span> <span class="token punctuation">[</span><span class="token operator">^</span><span class="token number">5</span><span class="token punctuation">]</span>
# <span class="token number">3.</span> <span class="token punctuation">[</span>akm$<span class="token punctuation">]</span>  在 <span class="token punctuation">[</span><span class="token punctuation">]</span> 中 $ 并不具备元字符特点

PattenA <span class="token operator">|</span> <span class="token function">PattenB</span>
<span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span> # 捕获 <span class="token punctuation">,</span> 引用可以使用、<span class="token number">1</span> <span class="token punctuation">,</span> <span class="token function">但是还有一种扩展语法</span>

<span class="token punctuation">(</span><span class="token operator">?.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> # 扩展
# <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token operator">?</span>aiLmsux<span class="token punctuation">)</span>
# <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token operator">?</span><span class="token operator">:</span><span class="token operator">...</span><span class="token punctuation">)</span> 不捕获
# <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token operator">?</span><span class="token constant">P</span><span class="token operator">&lt;</span>quote<span class="token operator">></span><span class="token operator">...</span><span class="token punctuation">)</span> <span class="token function">正则内引用</span> <span class="token punctuation">(</span><span class="token operator">?</span><span class="token constant">P</span><span class="token operator">=</span>quote<span class="token punctuation">)</span><span class="token punctuation">;</span>python 内获取 m<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token string">'quote'</span><span class="token punctuation">)</span> <span class="token punctuation">,</span>m<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'quote'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>re<span class="token punctuation">.</span>sub 内 repl 参数为、g<span class="token operator">&lt;</span>quote<span class="token operator">></span> \g<span class="token operator">&lt;</span><span class="token number">1</span><span class="token operator">></span> \<span class="token number">1</span>

</code></pre>
<h3 id="13-python-中使用正则的方法"><a class="v-toc-item" href="#13-python-中使用正则的方法">#</a> 1.3. Python 中使用正则的方法</h3>
<h4 id="131-re-模块的用法"><a class="v-toc-item" href="#131-re-模块的用法">#</a> 1.3.1. re 模块的用法</h4>
<ul>
<li>sub 替换</li>
<li>match / fullmatch 匹配</li>
<li>search 搜索</li>
<li>split 分片</li>
</ul>
<pre><code class="language-python">re<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'(\W+)'</span><span class="token punctuation">,</span> <span class="token string">'...words, words...'</span><span class="token punctuation">)</span>
# <span class="token punctuation">[</span><span class="token string">''</span><span class="token punctuation">,</span> <span class="token string">'...'</span><span class="token punctuation">,</span> <span class="token string">'words'</span><span class="token punctuation">,</span> <span class="token string">', '</span><span class="token punctuation">,</span> <span class="token string">'words'</span><span class="token punctuation">,</span> <span class="token string">'...'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">]</span>
</code></pre>
<blockquote>
<p>match 为匹配起始字符 / fullmatch 为全部字符 / search 为搜索</p>
</blockquote>
<h4 id="132-match-object-的用法"><a class="v-toc-item" href="#132-match-object-的用法">#</a> 1.3.2. match object 的用法</h4>
<pre><code class="language-python">m<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
m<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token operator">>>></span> m <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>r<span class="token string">"(?P&lt;first_name>\w+) (?P&lt;last_name>\w+)"</span><span class="token punctuation">,</span> <span class="token string">"Malcolm Reynolds"</span><span class="token punctuation">)</span>
<span class="token operator">>>></span> m<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token string">'first_name'</span><span class="token punctuation">)</span>
<span class="token string">'Malcolm'</span>
<span class="token operator">>>></span> m<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span><span class="token string">'last_name'</span><span class="token punctuation">)</span>
<span class="token string">'Reynolds'</span>
m<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> # 起始
m<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   # 结尾
</code></pre>
<h2 id="14-正则表达式性能"><a class="v-toc-item" href="#14-正则表达式性能">#</a> 1.4. 正则表达式性能</h2>
<pre><code class="language-python"># 编译优于不编译
prog <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span>pattern<span class="token punctuation">)</span>
result <span class="token operator">=</span> prog<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span>
re<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>pattern<span class="token punctuation">,</span>string<span class="token punctuation">)</span>
</code></pre>
<h2 id="0x02-htmlxml-处理相关"><a class="v-toc-item" href="#0x02-htmlxml-处理相关">#</a> 0x02 HTML/XML 处理相关</h2>
<h3 id="21-beautifulsoup-处理-html"><a class="v-toc-item" href="#21-beautifulsoup-处理-html">#</a> 2.1. Beautifulsoup 处理 HTML</h3>
<p>解析往往伴随着各种各样奇葩的不奇葩的，诡异的不诡异的网页数据抽取，这个过程中，我们常使用两个库来解决问题，一个库叫做 lxml, 另一个库叫做 BeautifulSoup.</p>
<p>beautifulsoup 可是让我们通过直接手动编写遍历 dom 树的方法来快速遍历 dom 树从而获得数据。相比自己写解析器而言，可以算得上非常的节省时间了。</p>
<p>只要能手动遍历 dom 树，基本上所有的数据都是可以获取的。痛点就是手动编写遍历 Dom 树并且完成测试的时间可能长一些。</p>
<p>但是开发效率就比较低了。</p>
<p>举个例子：</p>
<pre><code class="language-html"><span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"lal"</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>span <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"item"</span> itemprop<span class="token operator">=</span><span class="token string">"street-address"</span> title<span class="token operator">=</span><span class="token string">"浦东南路八佰伴西面"</span><span class="token operator">></span>
    地址：浦东南路八佰伴西面
  <span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"item"</span> itemprop<span class="token operator">=</span><span class="token string">"street-address"</span> title<span class="token operator">=</span><span class="token string">"浦东南路"</span><span class="token operator">></span>名称：xxxx<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
</code></pre>
<p>我想要地址属性，如果是 beautifulsoup, 则我们需要先定位到 id 为 lal 的 div 元素。然后获取每个元素的 text 部分，然后使用 if 判断地址属性，然后提取 text.</p>
<p><strong>但是如果用 xpath, 则可以把对元素的简单定位简单判断直接写在 xpath 表达式。</strong></p>
<pre><code class="language-python">sel<span class="token punctuation">.</span><span class="token function">xpath</span><span class="token punctuation">(</span><span class="token string">'//div[@id="lal"]/*[contains(text(),"地址")]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">extract_first</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
# 如果还需要添加筛选名称，则可是使用
sel<span class="token punctuation">.</span><span class="token function">xpath</span><span class="token punctuation">(</span><span class="token string">'//div[@id="lal"]/*[contains(text(),"名称")]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">extract_first</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>这样可以极大的提升开发效率。</p>
<p>页面的结构越复杂，则 xpath 带来的开发效率越高。</p>
<h3 id="22-xpath-处理-html"><a class="v-toc-item" href="#22-xpath-处理-html">#</a> 2.2. XPath 处理 HTML</h3>
<h4 id="221-概念"><a class="v-toc-item" href="#221-概念">#</a> 2.2.1. 概念</h4>
<p>XPath 是一种通过路径表达式定位 XML 文档内容的语法。<br>
由于内置了大量的表达式函数，可以通过极少的代码完成定位。<br>
有七种<strong>节点类型</strong>:</p>
<ul>
<li>element</li>
<li>attribute</li>
<li>text</li>
<li>namespace</li>
<li>processing-instruction</li>
<li>comment</li>
<li>document nodes</li>
</ul>
<p>有五种<strong>节点间关系</strong>:</p>
<ul>
<li>父节点 Parent</li>
<li>子节点 Children</li>
<li>兄弟节点 Siblings</li>
<li>先祖节点，即父与父父节点。Ancestors</li>
<li>后代节点，即子与子子节点。Descendants</li>
</ul>
<table>
<thead>
<tr>
<th>语法</th>
<th>描述</th>
<th>例子</th>
</tr>
</thead>
<tbody>
<tr>
<td>nodename</td>
<td>节点名称</td>
<td>a</td>
</tr>
<tr>
<td>/</td>
<td>根节点</td>
<td>/</td>
</tr>
<tr>
<td>//</td>
<td>匹配所有</td>
<td>bookstore//book</td>
</tr>
<tr>
<td>.</td>
<td>当前节点</td>
<td></td>
</tr>
<tr>
<td>…</td>
<td>父节点</td>
<td>a/…/a/…</td>
</tr>
<tr>
<td>@</td>
<td>属性</td>
<td>a/@href</td>
</tr>
<tr>
<td>[]</td>
<td>谓语</td>
<td>book[1] , book[last()-1]</td>
</tr>
<tr>
<td>func()</td>
<td>表达式函数</td>
<td>postion()</td>
</tr>
</tbody>
</table>
<pre><code class="language-python">response<span class="token punctuation">.</span><span class="token function">xpath</span><span class="token punctuation">(</span><span class="token string">"//*[@id=\"landlb_B04_04\"]/span[2]/a[contains(@href,'market')]"</span><span class="token punctuation">)</span>
response<span class="token punctuation">.</span><span class="token function">xpath</span><span class="token punctuation">(</span><span class="token string">"//*[@id=\"landlb_B04_04\"]/span[2]/a[not(@class)]"</span><span class="token punctuation">)</span>
response<span class="token punctuation">.</span><span class="token function">xpath</span><span class="token punctuation">(</span><span class="token string">"//ul/li/b[contains(text(),'什么玩意')]/following-sibling::span/text()"</span><span class="token punctuation">)</span>
response<span class="token punctuation">.</span><span class="token function">xpath</span><span class="token punctuation">(</span><span class="token string">"//div[@class='address']/text()[preceding::span[@class='item' and contains(text(),'地址：')]]"</span><span class="token punctuation">)</span>
response<span class="token punctuation">.</span><span class="token function">xpath</span><span class="token punctuation">(</span><span class="token string">"//ul/li/b[contains(text(),'什么玩意：')]/following-sibling::a/text()"</span><span class="token punctuation">)</span>
</code></pre>
<pre><code class="language-bash"><span class="token comment">//*[contains(text(),'ABC')]</span>
# http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>stackoverflow<span class="token punctuation">.</span>com<span class="token operator">/</span>questions<span class="token operator">/</span><span class="token number">3655549</span><span class="token operator">/</span>xpath<span class="token operator">-</span>containstext<span class="token operator">-</span>some<span class="token operator">-</span>string<span class="token operator">-</span>doesnt<span class="token operator">-</span>work<span class="token operator">-</span>when<span class="token operator">-</span>used<span class="token operator">-</span><span class="token keyword">with</span><span class="token operator">-</span>node<span class="token operator">-</span><span class="token keyword">with</span><span class="token operator">-</span>more<span class="token operator">/</span><span class="token number">3655588</span>#<span class="token number">3655588</span>

<span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"atag btag"</span> <span class="token operator">/</span><span class="token operator">></span>
<span class="token comment">//div[contains(@class, 'atag') and contains(@class ,'btag')]</span>
</code></pre>
<h4 id="222-lxml-parsel"><a class="v-toc-item" href="#222-lxml-parsel">#</a> 2.2.2. lxml parsel</h4>
<p>这两个库是 Python 中常用的解析表达式， parsel 依赖于 lxml , 安装完 lxml 后直接安装即可。</p>
<h4 id="223-lxml-的番外"><a class="v-toc-item" href="#223-lxml-的番外">#</a> 2.2.3. lxml 的番外</h4>
<p>众所周知，Mac 的 Homebrew 很方便，每一次遇到需要下载编译的组件的时候，只需要执行 brew install xxx, 很快就可以使用了。</p>
<p>但 homebrew 安装的软件都是最新的，这很容易导致部分软件由于版本更新带来的兼容性问题。</p>
<p>这不，最近在 Mac 上进行开发的时候每次调用初始化 lxml 的时候总是无法进行解析，最后经过排查发现问题是 lxml 在编译的时候使用的 libxml 2.9.4 但是 使用的版本为 2.9.2 , 于是每当我使用 lxml 的时候，就会报错。</p>
<p>不得已，找到 lxml 的 F&amp;Q 部分发现提 issue 之前需要先查看依赖版本。</p>
<p>于是进入 IPython 排查。</p>
<pre><code class="language-Python"><span class="token keyword">import</span> sys
from lxml <span class="token keyword">import</span> etree

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"%-20s: %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token string">'Python'</span><span class="token punctuation">,</span> sys<span class="token punctuation">.</span>version_info<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"%-20s: %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token string">'lxml.etree'</span><span class="token punctuation">,</span> etree<span class="token punctuation">.</span><span class="token constant">LXML_VERSION</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"%-20s: %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token string">'libxml used'</span><span class="token punctuation">,</span> etree<span class="token punctuation">.</span><span class="token constant">LIBXML_VERSION</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"%-20s: %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token string">'libxml compiled'</span><span class="token punctuation">,</span> etree<span class="token punctuation">.</span><span class="token constant">LIBXML_COMPILED_VERSION</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"%-20s: %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token string">'libxslt used'</span><span class="token punctuation">,</span> etree<span class="token punctuation">.</span><span class="token constant">LIBXSLT_VERSION</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"%-20s: %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token string">'libxslt compiled'</span><span class="token punctuation">,</span> etree<span class="token punctuation">.</span><span class="token constant">LIBXSLT_COMPILED_VERSION</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

# Python <span class="token operator">:</span> sys<span class="token punctuation">.</span><span class="token function">version_info</span><span class="token punctuation">(</span>major<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> minor<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> micro<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> releaselevel<span class="token operator">=</span><span class="token string">'final'</span><span class="token punctuation">,</span> serial<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
# lxml<span class="token punctuation">.</span>etree <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
# libxml used <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
# libxml compiled <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> # 注意问题出在这里。
# libxslt used <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span>
# libxslt compiled <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span>
</code></pre>
<p>于是使用 pip 强制进行安装升级。</p>
<pre><code>STATIC_DEPS=true pip install -i http://pypi.douban.com/simple/ –trusted-host pypi.douban.com lxml –ignore-installed –no-cache-dir –upgrade -vvv
</code></pre>
<p>安装完毕即可。</p>
<h3 id="23-标准库处理-html"><a class="v-toc-item" href="#23-标准库处理-html">#</a> 2.3. 标准库处理 HTML</h3>
</div></div><div><ul class="v-article-toc">
<li><a href="#text-processing-in-python">Text Processing In Python</a>
<ul>
<li><a href="#0x00-%E5%89%8D%E8%A8%80">0x00 前言</a></li>
<li><a href="#0x01-%E6%AD%A3%E5%88%99%E5%A4%84%E7%90%86%E7%9B%B8%E5%85%B3">0x01 正则处理相关</a>
<ul>
<li><a href="#11-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F">1.1. 正则表达式</a></li>
<li><a href="#12-python-%E4%B8%AD%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%AD%E6%B3%95">1.2. Python 中正则表达式语法</a></li>
<li><a href="#13-python-%E4%B8%AD%E4%BD%BF%E7%94%A8%E6%AD%A3%E5%88%99%E7%9A%84%E6%96%B9%E6%B3%95">1.3. Python 中使用正则的方法</a>
<ul>
<li><a href="#131-re-%E6%A8%A1%E5%9D%97%E7%9A%84%E7%94%A8%E6%B3%95">1.3.1. re 模块的用法</a></li>
<li><a href="#132-match-object-%E7%9A%84%E7%94%A8%E6%B3%95">1.3.2. match object 的用法</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#14-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%80%A7%E8%83%BD">1.4. 正则表达式性能</a></li>
<li><a href="#0x02-htmlxml-%E5%A4%84%E7%90%86%E7%9B%B8%E5%85%B3">0x02 HTML/XML 处理相关</a>
<ul>
<li><a href="#21-beautifulsoup-%E5%A4%84%E7%90%86-html">2.1. Beautifulsoup 处理 HTML</a></li>
<li><a href="#22-xpath-%E5%A4%84%E7%90%86-html">2.2. XPath 处理 HTML</a>
<ul>
<li><a href="#221-%E6%A6%82%E5%BF%B5">2.2.1. 概念</a></li>
<li><a href="#222-lxml-parsel">2.2.2. lxml parsel</a></li>
<li><a href="#223-lxml-%E7%9A%84%E7%95%AA%E5%A4%96">2.2.3. lxml 的番外</a></li>
</ul>
</li>
<li><a href="#23-%E6%A0%87%E5%87%86%E5%BA%93%E5%A4%84%E7%90%86-html">2.3. 标准库处理 HTML</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"tags":["Python"],"path":"20161203_Python文本处理.md","title":"Text Processing In Python","slug":"Text Processing In Python","date":"2016-12-03","category":"Python","lastMod":"2020-01-01","description":"这篇文章展示了基本的 Markdown 语法和格式.","thumbnail":"","content":"\u003ch1 id=\"text-processing-in-python\"\u003e\u003ca class=\"v-toc-item\" href=\"#text-processing-in-python\"\u003e#\u003c/a\u003e Text Processing In Python\u003c/h1\u003e\n\u003ch2 id=\"0x00-前言\"\u003e\u003ca class=\"v-toc-item\" href=\"#0x00-前言\"\u003e#\u003c/a\u003e 0x00 前言\u003c/h2\u003e\n\u003cp\u003e本文为 Cheatsheet 类型文章，用于记录我在日常编程中的文本处理相关思路。\u003c/p\u003e\n\u003cp\u003e本文的目录为：\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e正则处理相关\u003c/li\u003e\n\u003cli\u003eHTML/XML 处理相关\u003c/li\u003e\n\u003cli\u003ePython 中的文本处理\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"0x01-正则处理相关\"\u003e\u003ca class=\"v-toc-item\" href=\"#0x01-正则处理相关\"\u003e#\u003c/a\u003e 0x01 正则处理相关\u003c/h2\u003e\n\u003ch3 id=\"11-正则表达式\"\u003e\u003ca class=\"v-toc-item\" href=\"#11-正则表达式\"\u003e#\u003c/a\u003e 1.1. 正则表达式\u003c/h3\u003e\n\u003cp\u003e正则是个很奇葩的名字，为什么叫做正则表达式呢，首先是个表达式，其次，这是一种叫做正则 (regular expression, rational expression) 的表达式。\u003cbr\u003e\n名称为什么叫做 regular 呢，因为它基于 regular language. 而 regular language 是一种 formal language. 得，现在又开始是编译原理相关概念了。为了逃避概念，通过用途来简单定义正则表达式。\u003c/p\u003e\n\u003cp\u003e简而言之，就是一种用于字符串搜索的模式。或者就是一种领域专用编程语言。\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://en.wikipedia.org/wiki/Regular_expression\"\u003ehttps://en.wikipedia.org/wiki/Regular_expression\u003c/a\u003e\u003c/p\u003e\n\u003ch3 id=\"12-python-中正则表达式语法\"\u003e\u003ca class=\"v-toc-item\" href=\"#12-python-中正则表达式语法\"\u003e#\u003c/a\u003e 1.2. Python 中正则表达式语法\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"language-python\"\u003e# 元字符\n\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e \u003cspan class=\"token operator\"\u003e^\u003c/span\u003e $ \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token operator\"\u003e?\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \\ \u003cspan class=\"token operator\"\u003e|\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e # 速记，天上一个星星都没有，\u003cspan class=\"token number\"\u003e0\u003c/span\u003e 到多个。\n\u003cspan class=\"token operator\"\u003e+\u003c/span\u003e # 一加手机\u003cspan class=\"token operator\"\u003e...\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e 到多个。\n\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e # 有还是没有 即 \u003cspan class=\"token number\"\u003e0\u003c/span\u003e or \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\n\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e # 没有疑问就是贪婪，有疑问就是非贪婪\n\u003cspan class=\"token operator\"\u003e+\u003c/span\u003e\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\n\u003cspan class=\"token operator\"\u003e??\u003c/span\u003e\n\n\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003em\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e # m 份\n\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003em\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003en\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e # 优先匹配 a\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003eb 优先匹配 aaaab 中 aaaab\n\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003em\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003en\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e # 优先匹配 a\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003eb 优先匹配 aaaab 中 aab\n\n\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e # \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003ea\\\u003cspan class=\"token operator\"\u003e-\u003c/span\u003ez\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token operator\"\u003e==\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eaz\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n# \u003cspan class=\"token number\"\u003e1.\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\\w\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\\\u003cspan class=\"token constant\"\u003eS\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n# \u003cspan class=\"token number\"\u003e2.\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token operator\"\u003e^\u003c/span\u003e\u003cspan class=\"token number\"\u003e5\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n# \u003cspan class=\"token number\"\u003e3.\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eakm$\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e  在 \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e 中 $ 并不具备元字符特点\n\nPattenA \u003cspan class=\"token operator\"\u003e|\u003c/span\u003e \u003cspan class=\"token function\"\u003ePattenB\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e...\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e # 捕获 \u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e 引用可以使用、\u003cspan class=\"token number\"\u003e1\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token function\"\u003e但是还有一种扩展语法\u003c/span\u003e\n\n\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e?.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e # 扩展\n# \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e?\u003c/span\u003eaiLmsux\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n# \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e\u003cspan class=\"token operator\"\u003e...\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e 不捕获\n# \u003cspan class=\"token operator\"\u003e-\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token constant\"\u003eP\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003equote\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003cspan class=\"token operator\"\u003e...\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token function\"\u003e正则内引用\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token constant\"\u003eP\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003equote\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003epython 内获取 m\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egroup\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'quote'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003em\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'quote'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003ere\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003esub 内 repl 参数为、g\u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003equote\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \\g\u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \\\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\n\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"13-python-中使用正则的方法\"\u003e\u003ca class=\"v-toc-item\" href=\"#13-python-中使用正则的方法\"\u003e#\u003c/a\u003e 1.3. Python 中使用正则的方法\u003c/h3\u003e\n\u003ch4 id=\"131-re-模块的用法\"\u003e\u003ca class=\"v-toc-item\" href=\"#131-re-模块的用法\"\u003e#\u003c/a\u003e 1.3.1. re 模块的用法\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003esub 替换\u003c/li\u003e\n\u003cli\u003ematch / fullmatch 匹配\u003c/li\u003e\n\u003cli\u003esearch 搜索\u003c/li\u003e\n\u003cli\u003esplit 分片\u003c/li\u003e\n\u003c/ul\u003e\n\u003cpre\u003e\u003ccode class=\"language-python\"\u003ere\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003esplit\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'(\\W+)'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'...words, words...'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n# \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e''\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'...'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'words'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e', '\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'words'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'...'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e''\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cblockquote\u003e\n\u003cp\u003ematch 为匹配起始字符 / fullmatch 为全部字符 / search 为搜索\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch4 id=\"132-match-object-的用法\"\u003e\u003ca class=\"v-toc-item\" href=\"#132-match-object-的用法\"\u003e#\u003c/a\u003e 1.3.2. match object 的用法\u003c/h4\u003e\n\u003cpre\u003e\u003ccode class=\"language-python\"\u003em\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egroup\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nm\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egroup\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token operator\"\u003e\u003e\u003e\u003e\u003c/span\u003e m \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e re\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ematch\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003er\u003cspan class=\"token string\"\u003e\"(?P\u0026lt;first_name\u003e\\w+) (?P\u0026lt;last_name\u003e\\w+)\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"Malcolm Reynolds\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token operator\"\u003e\u003e\u003e\u003e\u003c/span\u003e m\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egroup\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'first_name'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token string\"\u003e'Malcolm'\u003c/span\u003e\n\u003cspan class=\"token operator\"\u003e\u003e\u003e\u003e\u003c/span\u003e m\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003egroup\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'last_name'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token string\"\u003e'Reynolds'\u003c/span\u003e\nm\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003estart\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e # 起始\nm\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eend\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e   # 结尾\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"14-正则表达式性能\"\u003e\u003ca class=\"v-toc-item\" href=\"#14-正则表达式性能\"\u003e#\u003c/a\u003e 1.4. 正则表达式性能\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"language-python\"\u003e# 编译优于不编译\nprog \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e re\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ecompile\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epattern\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nresult \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e prog\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ematch\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003estring\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nre\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003ematch\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epattern\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003estring\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"0x02-htmlxml-处理相关\"\u003e\u003ca class=\"v-toc-item\" href=\"#0x02-htmlxml-处理相关\"\u003e#\u003c/a\u003e 0x02 HTML/XML 处理相关\u003c/h2\u003e\n\u003ch3 id=\"21-beautifulsoup-处理-html\"\u003e\u003ca class=\"v-toc-item\" href=\"#21-beautifulsoup-处理-html\"\u003e#\u003c/a\u003e 2.1. Beautifulsoup 处理 HTML\u003c/h3\u003e\n\u003cp\u003e解析往往伴随着各种各样奇葩的不奇葩的，诡异的不诡异的网页数据抽取，这个过程中，我们常使用两个库来解决问题，一个库叫做 lxml, 另一个库叫做 BeautifulSoup.\u003c/p\u003e\n\u003cp\u003ebeautifulsoup 可是让我们通过直接手动编写遍历 dom 树的方法来快速遍历 dom 树从而获得数据。相比自己写解析器而言，可以算得上非常的节省时间了。\u003c/p\u003e\n\u003cp\u003e只要能手动遍历 dom 树，基本上所有的数据都是可以获取的。痛点就是手动编写遍历 Dom 树并且完成测试的时间可能长一些。\u003c/p\u003e\n\u003cp\u003e但是开发效率就比较低了。\u003c/p\u003e\n\u003cp\u003e举个例子：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003ediv id\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"lal\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\n  \u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003espan \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"item\"\u003c/span\u003e itemprop\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"street-address\"\u003c/span\u003e title\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"浦东南路八佰伴西面\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\n    地址：浦东南路八佰伴西面\n  \u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"token operator\"\u003e/\u003c/span\u003espan\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\n  \u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003ediv \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"item\"\u003c/span\u003e itemprop\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"street-address\"\u003c/span\u003e title\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"浦东南路\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e名称：xxxx\u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"token operator\"\u003e/\u003c/span\u003ediv\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\n\u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"token operator\"\u003e/\u003c/span\u003ediv\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e我想要地址属性，如果是 beautifulsoup, 则我们需要先定位到 id 为 lal 的 div 元素。然后获取每个元素的 text 部分，然后使用 if 判断地址属性，然后提取 text.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e但是如果用 xpath, 则可以把对元素的简单定位简单判断直接写在 xpath 表达式。\u003c/strong\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-python\"\u003esel\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003expath\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'//div[@id=\"lal\"]/*[contains(text(),\"地址\")]/text()'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eextract_first\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n# 如果还需要添加筛选名称，则可是使用\nsel\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003expath\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'//div[@id=\"lal\"]/*[contains(text(),\"名称\")]/text()'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eextract_first\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e这样可以极大的提升开发效率。\u003c/p\u003e\n\u003cp\u003e页面的结构越复杂，则 xpath 带来的开发效率越高。\u003c/p\u003e\n\u003ch3 id=\"22-xpath-处理-html\"\u003e\u003ca class=\"v-toc-item\" href=\"#22-xpath-处理-html\"\u003e#\u003c/a\u003e 2.2. XPath 处理 HTML\u003c/h3\u003e\n\u003ch4 id=\"221-概念\"\u003e\u003ca class=\"v-toc-item\" href=\"#221-概念\"\u003e#\u003c/a\u003e 2.2.1. 概念\u003c/h4\u003e\n\u003cp\u003eXPath 是一种通过路径表达式定位 XML 文档内容的语法。\u003cbr\u003e\n由于内置了大量的表达式函数，可以通过极少的代码完成定位。\u003cbr\u003e\n有七种\u003cstrong\u003e节点类型\u003c/strong\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eelement\u003c/li\u003e\n\u003cli\u003eattribute\u003c/li\u003e\n\u003cli\u003etext\u003c/li\u003e\n\u003cli\u003enamespace\u003c/li\u003e\n\u003cli\u003eprocessing-instruction\u003c/li\u003e\n\u003cli\u003ecomment\u003c/li\u003e\n\u003cli\u003edocument nodes\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e有五种\u003cstrong\u003e节点间关系\u003c/strong\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e父节点 Parent\u003c/li\u003e\n\u003cli\u003e子节点 Children\u003c/li\u003e\n\u003cli\u003e兄弟节点 Siblings\u003c/li\u003e\n\u003cli\u003e先祖节点，即父与父父节点。Ancestors\u003c/li\u003e\n\u003cli\u003e后代节点，即子与子子节点。Descendants\u003c/li\u003e\n\u003c/ul\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003e语法\u003c/th\u003e\n\u003cth\u003e描述\u003c/th\u003e\n\u003cth\u003e例子\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003enodename\u003c/td\u003e\n\u003ctd\u003e节点名称\u003c/td\u003e\n\u003ctd\u003ea\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e/\u003c/td\u003e\n\u003ctd\u003e根节点\u003c/td\u003e\n\u003ctd\u003e/\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e//\u003c/td\u003e\n\u003ctd\u003e匹配所有\u003c/td\u003e\n\u003ctd\u003ebookstore//book\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e.\u003c/td\u003e\n\u003ctd\u003e当前节点\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e…\u003c/td\u003e\n\u003ctd\u003e父节点\u003c/td\u003e\n\u003ctd\u003ea/…/a/…\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e@\u003c/td\u003e\n\u003ctd\u003e属性\u003c/td\u003e\n\u003ctd\u003ea/@href\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e[]\u003c/td\u003e\n\u003ctd\u003e谓语\u003c/td\u003e\n\u003ctd\u003ebook[1] , book[last()-1]\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003efunc()\u003c/td\u003e\n\u003ctd\u003e表达式函数\u003c/td\u003e\n\u003ctd\u003epostion()\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cpre\u003e\u003ccode class=\"language-python\"\u003eresponse\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003expath\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"//*[@id=\\\"landlb_B04_04\\\"]/span[2]/a[contains(@href,'market')]\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nresponse\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003expath\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"//*[@id=\\\"landlb_B04_04\\\"]/span[2]/a[not(@class)]\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nresponse\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003expath\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"//ul/li/b[contains(text(),'什么玩意')]/following-sibling::span/text()\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nresponse\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003expath\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"//div[@class='address']/text()[preceding::span[@class='item' and contains(text(),'地址：')]]\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nresponse\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003expath\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"//ul/li/b[contains(text(),'什么玩意：')]/following-sibling::a/text()\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003e\u003cspan class=\"token comment\"\u003e//*[contains(text(),'ABC')]\u003c/span\u003e\n# http\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e\u003cspan class=\"token operator\"\u003e/\u003c/span\u003e\u003cspan class=\"token operator\"\u003e/\u003c/span\u003estackoverflow\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ecom\u003cspan class=\"token operator\"\u003e/\u003c/span\u003equestions\u003cspan class=\"token operator\"\u003e/\u003c/span\u003e\u003cspan class=\"token number\"\u003e3655549\u003c/span\u003e\u003cspan class=\"token operator\"\u003e/\u003c/span\u003expath\u003cspan class=\"token operator\"\u003e-\u003c/span\u003econtainstext\u003cspan class=\"token operator\"\u003e-\u003c/span\u003esome\u003cspan class=\"token operator\"\u003e-\u003c/span\u003estring\u003cspan class=\"token operator\"\u003e-\u003c/span\u003edoesnt\u003cspan class=\"token operator\"\u003e-\u003c/span\u003ework\u003cspan class=\"token operator\"\u003e-\u003c/span\u003ewhen\u003cspan class=\"token operator\"\u003e-\u003c/span\u003eused\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ewith\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003c/span\u003enode\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token keyword\"\u003ewith\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003c/span\u003emore\u003cspan class=\"token operator\"\u003e/\u003c/span\u003e\u003cspan class=\"token number\"\u003e3655588\u003c/span\u003e#\u003cspan class=\"token number\"\u003e3655588\u003c/span\u003e\n\n\u003cspan class=\"token operator\"\u003e\u0026lt;\u003c/span\u003ediv \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"atag btag\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e/\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e//div[contains(@class, 'atag') and contains(@class ,'btag')]\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"222-lxml-parsel\"\u003e\u003ca class=\"v-toc-item\" href=\"#222-lxml-parsel\"\u003e#\u003c/a\u003e 2.2.2. lxml parsel\u003c/h4\u003e\n\u003cp\u003e这两个库是 Python 中常用的解析表达式， parsel 依赖于 lxml , 安装完 lxml 后直接安装即可。\u003c/p\u003e\n\u003ch4 id=\"223-lxml-的番外\"\u003e\u003ca class=\"v-toc-item\" href=\"#223-lxml-的番外\"\u003e#\u003c/a\u003e 2.2.3. lxml 的番外\u003c/h4\u003e\n\u003cp\u003e众所周知，Mac 的 Homebrew 很方便，每一次遇到需要下载编译的组件的时候，只需要执行 brew install xxx, 很快就可以使用了。\u003c/p\u003e\n\u003cp\u003e但 homebrew 安装的软件都是最新的，这很容易导致部分软件由于版本更新带来的兼容性问题。\u003c/p\u003e\n\u003cp\u003e这不，最近在 Mac 上进行开发的时候每次调用初始化 lxml 的时候总是无法进行解析，最后经过排查发现问题是 lxml 在编译的时候使用的 libxml 2.9.4 但是 使用的版本为 2.9.2 , 于是每当我使用 lxml 的时候，就会报错。\u003c/p\u003e\n\u003cp\u003e不得已，找到 lxml 的 F\u0026amp;Q 部分发现提 issue 之前需要先查看依赖版本。\u003c/p\u003e\n\u003cp\u003e于是进入 IPython 排查。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-Python\"\u003e\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e sys\nfrom lxml \u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e etree\n\n\u003cspan class=\"token function\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"%-20s: %s\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e%\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'Python'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e sys\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eversion_info\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token function\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"%-20s: %s\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e%\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'lxml.etree'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e etree\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token constant\"\u003eLXML_VERSION\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token function\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"%-20s: %s\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e%\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'libxml used'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e etree\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token constant\"\u003eLIBXML_VERSION\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token function\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"%-20s: %s\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e%\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'libxml compiled'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e etree\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token constant\"\u003eLIBXML_COMPILED_VERSION\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token function\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"%-20s: %s\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e%\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'libxslt used'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e etree\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token constant\"\u003eLIBXSLT_VERSION\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token function\"\u003eprint\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"%-20s: %s\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e%\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'libxslt compiled'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e etree\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token constant\"\u003eLIBXSLT_COMPILED_VERSION\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n# Python \u003cspan class=\"token operator\"\u003e:\u003c/span\u003e sys\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token function\"\u003eversion_info\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003emajor\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token number\"\u003e3\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e minor\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token number\"\u003e5\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e micro\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e releaselevel\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e'final'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e serial\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n# lxml\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eetree \u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e3\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e6\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n# libxml used \u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e9\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n# libxml compiled \u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e2\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e9\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e # 注意问题出在这里。\n# libxslt used \u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e28\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n# libxslt compiled \u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token number\"\u003e28\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e于是使用 pip 强制进行安装升级。\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eSTATIC_DEPS=true pip install -i http://pypi.douban.com/simple/ –trusted-host pypi.douban.com lxml –ignore-installed –no-cache-dir –upgrade -vvv\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e安装完毕即可。\u003c/p\u003e\n\u003ch3 id=\"23-标准库处理-html\"\u003e\u003ca class=\"v-toc-item\" href=\"#23-标准库处理-html\"\u003e#\u003c/a\u003e 2.3. 标准库处理 HTML\u003c/h3\u003e\n","toc":"\u003cul class=\"v-article-toc\"\u003e\n\u003cli\u003e\u003ca href=\"#text-processing-in-python\"\u003eText Processing In Python\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#0x00-%E5%89%8D%E8%A8%80\"\u003e0x00 前言\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#0x01-%E6%AD%A3%E5%88%99%E5%A4%84%E7%90%86%E7%9B%B8%E5%85%B3\"\u003e0x01 正则处理相关\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#11-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F\"\u003e1.1. 正则表达式\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#12-python-%E4%B8%AD%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%AD%E6%B3%95\"\u003e1.2. Python 中正则表达式语法\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#13-python-%E4%B8%AD%E4%BD%BF%E7%94%A8%E6%AD%A3%E5%88%99%E7%9A%84%E6%96%B9%E6%B3%95\"\u003e1.3. Python 中使用正则的方法\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#131-re-%E6%A8%A1%E5%9D%97%E7%9A%84%E7%94%A8%E6%B3%95\"\u003e1.3.1. re 模块的用法\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#132-match-object-%E7%9A%84%E7%94%A8%E6%B3%95\"\u003e1.3.2. match object 的用法\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#14-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%80%A7%E8%83%BD\"\u003e1.4. 正则表达式性能\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#0x02-htmlxml-%E5%A4%84%E7%90%86%E7%9B%B8%E5%85%B3\"\u003e0x02 HTML/XML 处理相关\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#21-beautifulsoup-%E5%A4%84%E7%90%86-html\"\u003e2.1. Beautifulsoup 处理 HTML\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#22-xpath-%E5%A4%84%E7%90%86-html\"\u003e2.2. XPath 处理 HTML\u003c/a\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#221-%E6%A6%82%E5%BF%B5\"\u003e2.2.1. 概念\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#222-lxml-parsel\"\u003e2.2.2. lxml parsel\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#223-lxml-%E7%9A%84%E7%95%AA%E5%A4%96\"\u003e2.2.3. lxml 的番外\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#23-%E6%A0%87%E5%87%86%E5%BA%93%E5%A4%84%E7%90%86-html\"\u003e2.3. 标准库处理 HTML\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n"}},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"Text Processing In Python"},"buildId":"oDi_oBCBuu3qj6v7hDnrL","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>