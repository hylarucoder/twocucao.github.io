<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
    
  
  <link href="//cdn.jsdelivr.net/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






  

<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="CheatSheet,ElasticSearch,搜索排序,搜索引擎," />





  <link rel="alternate" href="/atom.xml" title="MG的编程小屋" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="0x00 前言本文为 Cheatsheet 类型文章，用于记录我在日常编程中经常使用的 ElasticSearch 相关和命令。  最早使用 ElasticSearch 是两年前了。最近准备用 Django 写一个全栈式的应用，借用强大的 ES 来做搜索。  这是我在写程序之余写这篇笔记的原因。最近因为换工作的事情耽误了教程更新，就把这篇笔记放出来吧。不定期更新。 官网介绍 ElasticSear">
<meta name="keywords" content="CheatSheet,ElasticSearch,搜索排序,搜索引擎">
<meta property="og:type" content="article">
<meta property="og:title" content="ElasticSearch CheatSheet">
<meta property="og:url" content="http://twocucao.xyz/2018/02/10/ElasticSearchCheatSheet/index.html">
<meta property="og:site_name" content="MG的编程小屋">
<meta property="og:description" content="0x00 前言本文为 Cheatsheet 类型文章，用于记录我在日常编程中经常使用的 ElasticSearch 相关和命令。  最早使用 ElasticSearch 是两年前了。最近准备用 Django 写一个全栈式的应用，借用强大的 ES 来做搜索。  这是我在写程序之余写这篇笔记的原因。最近因为换工作的事情耽误了教程更新，就把这篇笔记放出来吧。不定期更新。 官网介绍 ElasticSear">
<meta property="og:updated_time" content="2018-08-24T09:19:42.338Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ElasticSearch CheatSheet">
<meta name="twitter:description" content="0x00 前言本文为 Cheatsheet 类型文章，用于记录我在日常编程中经常使用的 ElasticSearch 相关和命令。  最早使用 ElasticSearch 是两年前了。最近准备用 Django 写一个全栈式的应用，借用强大的 ES 来做搜索。  这是我在写程序之余写这篇笔记的原因。最近因为换工作的事情耽误了教程更新，就把这篇笔记放出来吧。不定期更新。 官网介绍 ElasticSear">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://twocucao.xyz/2018/02/10/ElasticSearchCheatSheet/"/>





  <title>ElasticSearch CheatSheet | MG的编程小屋</title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  





  <!-- hexo-inject:begin --><!-- hexo-inject:end --><script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?299254d95898cdfa110fc6d914eba9c4";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>











  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">MG的编程小屋</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">Get Busy Living, Or Get Busy Dying</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            站点地图
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://twocucao.xyz/2018/02/10/ElasticSearchCheatSheet/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Micheal Gardner">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://oh1n2bfoj.bkt.clouddn.com/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="MG的编程小屋">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">ElasticSearch CheatSheet</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-10T10:25:39+08:00">
                2018-02-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/后台组件/" itemprop="url" rel="index">
                    <span itemprop="name">后台组件</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  4,354
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  16
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h2><p>本文为 Cheatsheet 类型文章，用于记录我在日常编程中经常使用的 ElasticSearch 相关和命令。</p>
<blockquote>
<p>最早使用 ElasticSearch 是两年前了。最近准备用 Django 写一个全栈式的应用，借用强大的 ES 来做搜索。</p>
</blockquote>
<p>这是我在写程序之余写这篇笔记的原因。最近因为换工作的事情耽误了教程更新，就把这篇笔记放出来吧。不定期更新。</p>
<p>官网介绍 ElasticSearch 不仅仅是全文搜索，也可以结构化搜索（这里用结构化查询会更准确一些），处理人类语言，地理位置，以及关系。</p>
<p>然而，我在项目使用过程中还是主要用到了全文搜索以及推荐。</p>
<p>不用其他的主要原因是因为 ES 尺有所短寸有所长：</p>
<ol>
<li>geo 处理方面 postgis 完全就是神一般的存在。为什么还要用 ES 呢？</li>
<li>关系型数据库的核心不就是处理关系？复杂的关系肯定还是放在关系数据库里面。</li>
</ol>
<ul>
<li>highlighted search</li>
<li>search-as-you-type</li>
<li>did-you-mean suggestions</li>
</ul>
<p>我对 ElasticSearch 在后台组件里的作用在于搜索与推荐：</p>
<ol>
<li>整站的搜索功能<ul>
<li>全文搜索</li>
</ul>
</li>
<li>推荐<ul>
<li>依据某几个维度的数据进行排序</li>
</ul>
</li>
</ol>
<p>知乎的文章居然不支持 toc, 实在是太蛋疼了。</p>
<p>文章目录如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">▼ 0x00 前言 : section</div><div class="line">▼ 0x01 安装，配置，基本 shell 命令 : section</div><div class="line">    1. 安装 : section</div><div class="line">    2. 配置 : section</div><div class="line">    3. 插件 : section</div><div class="line">  0x02 ElasticSearch 配套工具 : section</div><div class="line">▼ 0x03 ElasticSearch 基础概念 : section</div><div class="line">  ▼ 3.1 Elasticsearch CRUDE 以及基本操作 : section</div><div class="line">      CURDE : section</div><div class="line">      普通搜索 : section</div><div class="line">      聚集搜索 : section</div><div class="line">▼ 0x04 全文搜索的基本概念 : section</div><div class="line">    4.1 全文搜索遇到的挑战 : section</div><div class="line">  ▼ 4.2 全文搜索的索引时与查询时 : section</div><div class="line">      1. 索引时 ES 做了什么？ : section</div><div class="line">      2. 查询时 ES 做了什么？ : section</div><div class="line">      3. 全文搜索调优之中文分词 : section</div><div class="line">      4. 全文搜索调优之停止词 : section</div><div class="line">      5. 全文搜索调优之同义词 : section</div><div class="line">      6. 全文搜索调优之拼写错误 : section</div><div class="line">    ▼ 7. 全文搜索调优之相关性 : section</div><div class="line">        索引时三因素 : section</div><div class="line">        查询时 : section</div><div class="line">        计算公式 : section</div><div class="line">  0x05 搜索语法 : section</div><div class="line">  0x06 Python SDK : section</div><div class="line">  0x07 踩坑集 : section</div><div class="line">  0xEE 参考链接 : section</div></pre></td></tr></table></figure>
<a id="more"></a>
<h2 id="0x01-安装，配置，基本-shell-命令"><a href="#0x01-安装，配置，基本-shell-命令" class="headerlink" title="0x01 安装，配置，基本 shell 命令"></a>0x01 安装，配置，基本 shell 命令</h2><h3 id="1-安装"><a href="#1-安装" class="headerlink" title="1. 安装"></a>1. 安装</h3><p>具体在项目中的配置建议看一下我写的配置文章 <a href="https://zhuanlan.zhihu.com/p/33920401" target="_blank" rel="external">https://zhuanlan.zhihu.com/p/33920401</a> 和并且参考现有代码 <a href="https://github.com/twocucao/YaDjangoBlog" target="_blank" rel="external">https://github.com/twocucao/YaDjangoBlog</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"># 执行如下的命令</div><div class="line">curl &apos;http://localhost:9200/?pretty&apos;</div><div class="line"># 输出结果</div><div class="line">&#123;</div><div class="line">  &quot;name&quot; : &quot;XOGvo8a&quot;,</div><div class="line">  &quot;cluster_name&quot; : &quot;docker-cluster&quot;,</div><div class="line">  &quot;cluster_uuid&quot; : &quot;fAwp341bQzalzBxRFyD1YA&quot;,</div><div class="line">  &quot;version&quot; : &#123;</div><div class="line">    &quot;number&quot; : &quot;6.2.1&quot;,</div><div class="line">    &quot;build_hash&quot; : &quot;7299dc3&quot;,</div><div class="line">    &quot;build_date&quot; : &quot;2018-02-07T19:34:26.990113Z&quot;,</div><div class="line">    &quot;build_snapshot&quot; : false,</div><div class="line">    &quot;lucene_version&quot; : &quot;7.2.1&quot;,</div><div class="line">    &quot;minimum_wire_compatibility_version&quot; : &quot;5.6.0&quot;,</div><div class="line">    &quot;minimum_index_compatibility_version&quot; : &quot;5.0.0&quot;</div><div class="line">  &#125;,</div><div class="line">  &quot;tagline&quot; : &quot;You Know, for Search&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="2-配置"><a href="#2-配置" class="headerlink" title="2. 配置"></a>2. 配置</h3><p>配置略</p>
<h3 id="3-插件"><a href="#3-插件" class="headerlink" title="3. 插件"></a>3. 插件</h3><p>ES 的插件有很多，截止笔者写这篇文章的时候，ES 最新的版本是 6.2.1 版本。</p>
<blockquote>
<p>PS: 两年前我用的还是 2.3.3 版本。新版本有很多插件配置起来已经有所不同了。比如说 head 现在已经被独立出来作为一个单纯的网页，chrome 商店可以直接下载。</p>
</blockquote>
<p>需要配 ik-analyser. 如果你在 YaDjangoBlog 中起了这个命令，则已经配置完毕。</p>
<h2 id="0x02-ElasticSearch-配套工具"><a href="#0x02-ElasticSearch-配套工具" class="headerlink" title="0x02 ElasticSearch 配套工具"></a>0x02 ElasticSearch 配套工具</h2><p>建议使用 Head 插件来进行简单的查询与调试。</p>
<h2 id="0x03-ElasticSearch-基础概念"><a href="#0x03-ElasticSearch-基础概念" class="headerlink" title="0x03 ElasticSearch 基础概念"></a>0x03 ElasticSearch 基础概念</h2><h3 id="3-1-Elasticsearch-CRUDE-以及基本操作"><a href="#3-1-Elasticsearch-CRUDE-以及基本操作" class="headerlink" title="3.1 Elasticsearch CRUDE 以及基本操作"></a>3.1 Elasticsearch CRUDE 以及基本操作</h3><p>详细的搜索见 Python SDK</p>
<h4 id="CURDE"><a href="#CURDE" class="headerlink" title="CURDE"></a>CURDE</h4><p>ES 使用的是 RESTFUL API 接口</p>
<p>这也就意味着：</p>
<ul>
<li>PUT 创建记录</li>
<li>GET 获取记录</li>
<li>POST 更新记录</li>
<li>DELETE 删除记录</li>
<li>HEAD 是否存在</li>
</ul>
<h4 id="结构化搜索"><a href="#结构化搜索" class="headerlink" title="结构化搜索"></a>结构化搜索</h4><p>ES 写复杂查询的时候，语法乱，这个过程需要多翻看 guide 和手册。</p>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/guide/current/structured-search.html" target="_blank" rel="external">https://www.elastic.co/guide/en/elasticsearch/guide/current/structured-search.html</a></p>
<h4 id="全文搜索"><a href="#全文搜索" class="headerlink" title="全文搜索"></a>全文搜索</h4><p>全文搜索包含两个重要方面：</p>
<ul>
<li>相关性：通过 TF/IDF , 距离 , 模糊相似度，以及其他算法</li>
<li>分析：大文本 token 化，用于形成倒排索引。这个过程见 4.2</li>
</ul>
<p><a href="https://www.elastic.co/guide/en/elasticsearch/guide/current/full-text-search.html" target="_blank" rel="external">https://www.elastic.co/guide/en/elasticsearch/guide/current/full-text-search.html</a></p>
<h4 id="聚集搜索"><a href="#聚集搜索" class="headerlink" title="聚集搜索"></a>聚集搜索</h4><p><a href="https://www.elastic.co/guide/en/elasticsearch/guide/current/aggregations.html" target="_blank" rel="external">https://www.elastic.co/guide/en/elasticsearch/guide/current/aggregations.html</a></p>
<h2 id="0x04-全文搜索的基本概念"><a href="#0x04-全文搜索的基本概念" class="headerlink" title="0x04 全文搜索的基本概念"></a>0x04 全文搜索的基本概念</h2><h3 id="4-1-全文搜索遇到的挑战"><a href="#4-1-全文搜索遇到的挑战" class="headerlink" title="4.1 全文搜索遇到的挑战"></a>4.1 全文搜索遇到的挑战</h3><p>在最初开源搜索引擎技术还不是很成熟的时候，我们一般都会使用 RDBMS 进行简单搜索。</p>
<p>简单搜索，也就是我们常常使用的 like 查询（当然，有的数据库可以使用正则表达式）</p>
<p>这种方式是简单暴力的查询方式，优点是实现起来简单暴力。缺点是在这个场景下性能和准确度很差。</p>
<p>举例：</p>
<ul>
<li>假如站点里文章数量比较大，并且文章内容比较长，则进行一次全表查询，效率可想而知。当然，做好分库分表读写分离也是能用的。</li>
<li>如果我要对搜索到的词语进行高亮，则实现方式就只能是把查询到的文章放在应用层里面进行批量替换。</li>
<li>RDBMS 似乎完全不懂语言与语言之间的区别。比如说：<ul>
<li>『停止词 / 常用词』有的字我是不需要的，比如南京的狗，其实我想搜的是南京狗，这里的『的』就不是我需要的。</li>
<li>『同义词』有的字我需要的是他的同义词，比如日本黄狗，其实我想搜的是柴犬。</li>
<li>『附加符号』假如说我们搜索一个声调 [nǐ], 总不能让用户打出 [nǐ] 进行搜索吧？总归要转为 ni 才能方便搜索</li>
<li>『词根形式』对于一个单词，假如是动词可能有时态上的区分，如果是名词，可能有单复数的区分。假如我搜 mice, 其实同样的 mouse 也应该被搜索出来。但有事用这种方式也会矫枉过正，比如 organizations 的 原型其实并不是 organization 而是，organ. （当然，overstemming 和 understemming 也是两个不可忽视的问题）<ul>
<li>Number: fox, foxes</li>
<li>Tense: pay, paid, paying</li>
<li>Gender: waiter, waitress</li>
<li>Person: hear, hears</li>
<li>Case: I, me, my</li>
<li>Aspect: ate, eaten</li>
<li>Mood: so be it, were it so</li>
<li>PS: 万幸的是，中文处理中木词根这个概念。我也就不深入这块了。</li>
</ul>
</li>
<li>『拼写问题』 周杰棍与周杰伦</li>
<li>『分词 / 识别词』中文不像英文，词和词之间是完全没有空格的，也就是说，中文天然要比英文多一个关于分词的步骤。</li>
</ul>
</li>
</ul>
<p>是的，我们需要一种新的姿势，来进行搜索。也就是本文所说的全文搜索。</p>
<h3 id="4-2-全文搜索的索引时与查询时"><a href="#4-2-全文搜索的索引时与查询时" class="headerlink" title="4.2 全文搜索的索引时与查询时"></a>4.2 全文搜索的索引时与查询时</h3><p>本小节先搞清楚两个点，</p>
<ol>
<li>索引时 ES 做了什么？</li>
<li>查询时 ES 做了什么？</li>
</ol>
<ul>
<li>索引时，指的是 ElasticSearch 在存储文档的阶段。</li>
<li>查询时，指的是 ElasticSearch 在查询文档的阶段。</li>
</ul>
<h4 id="1-索引时-ES-做了什么？"><a href="#1-索引时-ES-做了什么？" class="headerlink" title="1. 索引时 ES 做了什么？"></a>1. 索引时 ES 做了什么？</h4><blockquote>
<p>这里我们略过定义 index,type,document 仅仅指某个 field 被赋值 document 被保存的时候针对这个被赋值的 text 类型 field 的处理。</p>
</blockquote>
<ul>
<li>第一步：<strong>文本经过 analyzer 处理</strong></li>
<li>第二步：<strong>形成倒排索引</strong></li>
</ul>
<p>先看第一步：</p>
<p>通常在定义 field 的时候显式指定 analyzer（分析器）.</p>
<p>这个 analyzer 一般的作用如下：</p>
<ul>
<li>STEP 1: 令牌化文本为独立的词</li>
<li>STEP 2: 词语转小写</li>
<li>STEP 3: 去除常见的停止词</li>
<li>STEP 4: 获取词的词根的原型</li>
</ul>
<p>不同的 analyzer 作用大同小异，拿我们常用的 <a href="https://github.com/medcl/elasticsearch-analysis-ik" target="_blank" rel="external">https://github.com/medcl/elasticsearch-analysis-ik</a> 的话，则也是类似的步骤（下面步骤是我猜测的，没看源码）</p>
<ol>
<li>令牌化文本为独立的词语 - 分词，并且令牌化文本为独立的词汇</li>
<li>除去常见的停止词</li>
<li>匹配同义词</li>
<li>….</li>
</ol>
<p>可以定义字段的时候可以指定 analyzer（索引时） 与 search_analyzer（查询时）</p>
<p>先看经过第一步之后，就可以进入第二步形成倒排索引了，此时，倒排索引之于 ElasticSearch 可以类比于 btree 之于 MySQL 或者 Gist 之于 PostgreSQL.</p>
<p>那么，倒排索引包含哪些东西呢？</p>
<ul>
<li><strong>Terms dictionary</strong><ul>
<li>已排序完毕的 terms, 以及包含这些 terms 的 documents 的数量。</li>
</ul>
</li>
<li><strong>Postings List</strong><ul>
<li>哪些 document 包含这些词</li>
</ul>
</li>
<li><strong>Terms frequency</strong><ul>
<li>每个 term 在这些文章的频率</li>
</ul>
</li>
<li><strong>Position</strong><ul>
<li>每个 term 在每个 document 的位置，这是为了便于 phrase query 和 proximity query</li>
<li>高频词的 phrase query 可能导致 上 G 的数据被读取。虽然有 cache, 但是远远不够。</li>
</ul>
</li>
<li><strong>Offsets</strong><ul>
<li>每个 term 在每个 document 的开始和结束，便于高亮</li>
</ul>
</li>
<li><strong>Norms</strong><ul>
<li>用于给短 field 更多权重的因素.(TODO: 啥玩意）</li>
</ul>
</li>
</ul>
<p>减少停止词仅仅可以减少少部分 terms dictionary 和 postings list , 但是 positions 和 offsets data 对 index 的影响则是非常大的。</p>
<h4 id="2-查询时-ES-做了什么？"><a href="#2-查询时-ES-做了什么？" class="headerlink" title="2. 查询时 ES 做了什么？"></a>2. 查询时 ES 做了什么？</h4><ul>
<li>第一步：<strong>文本经过 analyzer 处理</strong></li>
<li>第二步：<strong>查询倒排索引</strong></li>
</ul>
<p>其实搜索的就是这个玩意。</p>
<ul>
<li><strong>Terms dictionary</strong></li>
<li><strong>Postings List</strong></li>
<li><strong>Terms frequency</strong></li>
<li><strong>Position</strong></li>
<li><strong>Offsets</strong></li>
<li><strong>Norms</strong></li>
</ul>
<p>于是，我们就必须关注如何更好的查询文档了。下面几个小节，你就知道全文搜索是比较难调优的了。好，一个一个来。</p>
<h4 id="3-全文搜索调优之中文分词"><a href="#3-全文搜索调优之中文分词" class="headerlink" title="3. 全文搜索调优之中文分词"></a>3. 全文搜索调优之中文分词</h4><p>中文分词以前是个难点，现在基本有成熟的解决方案，在没有更加牛逼的分词技术解决方案之前，现在分词效果主要是拼词典。</p>
<blockquote>
<p>TODO: 这个话题可能比较大，先挖坑，以后填</p>
</blockquote>
<h4 id="4-全文搜索调优之停止词"><a href="#4-全文搜索调优之停止词" class="headerlink" title="4. 全文搜索调优之停止词"></a>4. 全文搜索调优之停止词</h4><p>使用停止词是减少索引大小的一种方式（减小索引效果不明显），那么，哪些词语可以呗当做停止词呢？</p>
<ul>
<li>低频词语：低频词语具备高权重</li>
<li>高频词语：高频词语具备低权重</li>
</ul>
<p>当然，是否是高频词语依据个人经验主要依据两点来判断：</p>
<ul>
<li>具体场景：比如在英文中，and/the 之类的会比较多，但是中文会比较少。同样的，中文里面其他语言的东西会少一些。正文八经的文章出现不正经的词汇的概率会低。在技术问里面，『数据库』属于高频词汇，但是在比如简书之类的，可能梦想 / 鸡汤 / 超级 / 震惊会多一些。掘金的『前端』两个字绝壁是高频词。</li>
<li>抽样跑新词发现的程序。社区里多的是新词发现的脚本。对文章内容或者从搜索框记录下来的搜索词跑一下新词发现的程序，然后人工筛选，应该可以发现更多的高频和低频的词汇。</li>
</ul>
<p>是不是用上停止词就好了呢？并不是。</p>
<p>比如：</p>
<ul>
<li>假如停止词里面包含了 not , 那么 happy 和 not happy 搜索出来的结果则一致。</li>
<li>假如停止词里面包含了或，那么，如果有个乐队名字叫做『或或』, 则搜索不出来。</li>
<li>假如停止词里面包含了 to / be / not / or , 则莎士比亚的名言 『To be, or not to be』 则搜索不出来。</li>
</ul>
<h4 id="5-全文搜索调优之同义词"><a href="#5-全文搜索调优之同义词" class="headerlink" title="5. 全文搜索调优之同义词"></a>5. 全文搜索调优之同义词</h4><p>同义词也有很多种：</p>
<ol>
<li>平级关系：插、戳、刺、扎</li>
<li>包含关系：成人包含男人和女人</li>
<li>不容易分清楚关系：<ul>
<li>炒，煎，贴，烹，炸，溜<br>　- 汆，涮，煮，炖，煨，焐<br>　- 蒸，鲊<br>　- 卤，酱，熏，烤，炝，腌，拌，焗</li>
</ul>
</li>
</ol>
<p>随着场景的不同，上面有些同义词也是不能轻而易举同义的。</p>
<table>
<thead>
<tr>
<th>-</th>
<th>索引时</th>
<th>查询时</th>
</tr>
</thead>
<tbody>
<tr>
<td>索引大小</td>
<td>耗时变多，同义词被索引，大小更大</td>
<td>耗时几乎不变</td>
</tr>
<tr>
<td>相关性</td>
<td>准确度下降，所有同义词相同 IDF, 则在所有文档的索引记录中，常用词和冷门词权重相同</td>
<td>准确度提升，每个同义词的 IDF 将被校正</td>
</tr>
<tr>
<td>性能</td>
<td>性能下降，查询需要涨到</td>
<td>性能下降，查询被重写，用于查找同义词</td>
</tr>
<tr>
<td>灵活性</td>
<td>变差，同义词法则不改变已存在记录，需重新索引</td>
<td>不变，同义词法则可被更新，无需重新索引</td>
</tr>
</tbody>
</table>
<p>由此可见，大部分场景下的索引时如果没有特别的需求，<strong>谨慎使用同义词</strong>。</p>
<blockquote>
<p>同义词使用自定义 filter , 并且在新建 analyzer 并指定 filter 即可。</p>
</blockquote>
<h4 id="6-全文搜索调优之拼写错误"><a href="#6-全文搜索调优之拼写错误" class="headerlink" title="6. 全文搜索调优之拼写错误"></a>6. 全文搜索调优之拼写错误</h4><p>有的时候，用户也会输入错误：</p>
<ul>
<li>手误，把『周杰伦』拼成『周杰棍』</li>
</ul>
<p>这个时候，搜索引擎应该提示一下，您搜索的是不是『周杰伦』呢？</p>
<p>这里面就遇到了一个问题，我们显然知道周杰棍和周杰伦是是相似的，为什么呢？或者说，直观上感知的详细，能用数学方式表达出来吗？</p>
<p>有人说，正则匹配 / 通配符匹配呗。这是一个思路。</p>
<p>Vladimir Levenshtein 和 frederic damerau 给出了一种相似度算法 <a href="https://en.wikipedia.org/wiki/Damerau%E2%80%93Levenshtein_distance" target="_blank" rel="external">https://en.wikipedia.org/wiki/Damerau%E2%80%93Levenshtein_distance</a></p>
<p>一个词组通过转换到另一个词的步数就是其距离：</p>
<ul>
<li>替换：『周杰伦』到『周杰棍』</li>
<li>插入：『周杰』到『周杰棍』</li>
<li>删除：『周杰伦』到『周杰』</li>
<li>相邻字符转换：『周伦杰』和『周杰伦』 , 但是『周杰棍的双节伦』到『周杰伦的双节棍』 并不是相邻字符转换</li>
</ul>
<p>用法：</p>
<blockquote>
<p>指定 “fuzziness”: step 即可</p>
</blockquote>
<p>当 step &gt;=2 的时候，ES 进行查询的时候，每次查询都会遍历 terms 字典，所以，如果 fuzziness 大于 2 的时候遍历 terms 的数量则非常惊人了。</p>
<ul>
<li>方法一：设置 prefix_length, 单词的前面一定长度不进行 fuzzy 匹配。一般设置为 3 （估计这是属于英文的匹配，中文环境做不了参考）;</li>
<li>方法二：设置 max_expansins, 类似于 RDBMS 的 limit, 查询到一定记录之后停止查询。</li>
</ul>
<p>fuzzy match query 也是支持的，比如说，假如你指定 “fuzziness” 为 1, 搜索周杰棍，则将周杰伦，周杰全搜索出来了。似乎搜索的很全面呀，但是问题来了：</p>
<blockquote>
<p>依据 TF/IDF 的高频低权重，低频高权重的计算方式，<strong>周杰棍由于出现次数极少，反而获得了极高的权重。</strong></p>
</blockquote>
<p>跑个题，这种因为『出现次数少，查询的时候反而显得权重较高』的情况。并不仅仅出现在 TF/IDF 算法上。</p>
<p>这方面搜索引擎和人是一样一样的</p>
<ul>
<li>小孩子听腻了家长们所说的『带着脑子去学习』, 反而觉得以前没出现的新词叫『刻意学习』牛逼到爆。</li>
<li>美女听腻了直男癌说的『漂亮』, 反而觉得夸她『品质 / 品味』的话语词词入心。</li>
</ul>
<p>回到正题</p>
<p>所以，一般情况下还是建议拼写错误主要还是用于：</p>
<ul>
<li>Search as you type : completion suggester</li>
<li>Did you mean : phrase suggester</li>
</ul>
<h4 id="7-全文搜索调优之相关性"><a href="#7-全文搜索调优之相关性" class="headerlink" title="7. 全文搜索调优之相关性"></a>7. 全文搜索调优之相关性</h4><p>我们在接触 RDBMS 的时候系统是没有相关性的说法的，比如说，2017 年 12 月份 xxx 用户的订单，就是直接 select 出来这些订单。因为 where 语句后面包含了界限明确的条件，而全文搜索则不然。</p>
<p>这个时候一个人拍着桌子站起来，说：不对呀，我要搜索包含周杰伦的所有文章。这咋没有条件边界。</p>
<p>嗯，稍等，『选出所有包含周杰伦的文章』条件很清晰。但问题是，排序怎么做？按照日期排？按照点击率排？这篇文章上周已经在在搜索靠前了，已经『长江后浪推前浪了』上了，这周是不是该差不多『前浪死在沙滩上』了？</p>
<p>Elasticsearch 中使用的计算 score 的公式叫做 practical scoring function, 这个公式借鉴于 TF/TDF 以及 矢量空间模型，但有更多的特征比如，条件因素，字段长度正态化，term / query clause boosting</p>
<p>全文搜索不仅仅找到匹配的 documents, 并且按照相关性进行排序（其实就是打分 score)。</p>
<p>为什么需要打分呢？从相亲角度来说，上海内环有房肯定是个超级大加分项。同样是录入信息，在上海内环有房的权重值可是设置的高一些。</p>
<p>嗯，其实相关性的调优是最难的部分。</p>
<h5 id="索引时三因素"><a href="#索引时三因素" class="headerlink" title="索引时三因素"></a>索引时三因素</h5><p>先看前两个因素 TF/IDF</p>
<ul>
<li>tf(t in d) = sqrt(frequency)</li>
<li>idf(t) = 1 + log (numDocs / (docFreq + 1))</li>
</ul>
<p>再看后一个因素 Field-Length norm</p>
<p>标题越短，这个词对这个 field 的代表性越强</p>
<ul>
<li>norm(d) = 1 / sqrt(numTerms)</li>
</ul>
<h5 id="查询时"><a href="#查询时" class="headerlink" title="查询时"></a>查询时</h5><p>几个词 -&gt; 几维度 -&gt; 寻求最佳匹配以及近似匹配</p>
<ul>
<li>最佳匹配应该是通过计算长度（应该是，但不确定）</li>
<li>近似匹配，计算距离最近的 cos 值。</li>
</ul>
<h5 id="计算公式"><a href="#计算公式" class="headerlink" title="计算公式"></a>计算公式</h5><p>这个公式调优的时候需要用到</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">score(q,d)  = queryNorm(q)</div><div class="line">                ·coord(q,d)</div><div class="line">                ·∑(tf(t <span class="keyword">in</span> d)·idf(t)²·t.getBoost()·norm(t,d)) (t <span class="keyword">in</span> q)</div></pre></td></tr></table></figure>
<h2 id="0x05-搜索语法"><a href="#0x05-搜索语法" class="headerlink" title="0x05 搜索语法"></a>0x05 搜索语法</h2><p>Single document APIs</p>
<ul>
<li>Index API</li>
<li>Get API</li>
<li>Delete API</li>
<li>Update API</li>
<li>Multi-document APIs</li>
</ul>
<p>Multi Get API</p>
<ul>
<li>Bulk API</li>
<li>Delete By Query API</li>
<li>Update By Query API</li>
<li>Reindex API</li>
</ul>
<h2 id="0x06-Python-SDK"><a href="#0x06-Python-SDK" class="headerlink" title="0x06 Python SDK"></a>0x06 Python SDK</h2><p>官方提供了两个 SDK 方便我们进行日常的开发：</p>
<ul>
<li>elasticsearch</li>
<li>elasticsearch_dsl</li>
</ul>
<p>我更喜欢 elasticsearch , 而不是 elasticsearch_dsl, 因为写起来更容易结合 elasticsearch-head 进行 profile</p>
<p>前者偏底层一些，后者偏高层一些，高底层关系的有点类似于 sql 和 sqlalchemy core 之间的关系。</p>
<h2 id="0x07-踩坑集"><a href="#0x07-踩坑集" class="headerlink" title="0x07 踩坑集"></a>0x07 踩坑集</h2><h2 id="0xEE-参考链接"><a href="#0xEE-参考链接" class="headerlink" title="0xEE 参考链接"></a>0xEE 参考链接</h2><ul>
<li><a href="https://www.zhihu.com/question/19645541" target="_blank" rel="external">https://www.zhihu.com/question/19645541</a></li>
</ul>
<hr>
<p>ChangeLog:</p>
<ul>
<li><strong>2018-02-15</strong> 重修文字</li>
</ul>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/CheatSheet/" rel="tag"># CheatSheet</a>
          
            <a href="/tags/ElasticSearch/" rel="tag"># ElasticSearch</a>
          
            <a href="/tags/搜索排序/" rel="tag"># 搜索排序</a>
          
            <a href="/tags/搜索引擎/" rel="tag"># 搜索引擎</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/02/20/CeleryCheatSheet/" rel="next" title="Celery CheatSheet">
                <i class="fa fa-chevron-left"></i> Celery CheatSheet
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/02/10/DockerCheatSheet/" rel="prev" title="Docker CheatSheet">
                Docker CheatSheet <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://oh1n2bfoj.bkt.clouddn.com/avatar.png"
               alt="Micheal Gardner" />
          <p class="site-author-name" itemprop="name">Micheal Gardner</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
           
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">86</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">15</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">97</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/twocucao" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/twocucao" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  微博
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.zhihu.com/people/twocucao" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  知乎
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#0x00-前言"><span class="nav-number">1.</span> <span class="nav-text">0x00 前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x01-安装，配置，基本-shell-命令"><span class="nav-number">2.</span> <span class="nav-text">0x01 安装，配置，基本 shell 命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-安装"><span class="nav-number">2.1.</span> <span class="nav-text">1. 安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-配置"><span class="nav-number">2.2.</span> <span class="nav-text">2. 配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-插件"><span class="nav-number">2.3.</span> <span class="nav-text">3. 插件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x02-ElasticSearch-配套工具"><span class="nav-number">3.</span> <span class="nav-text">0x02 ElasticSearch 配套工具</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x03-ElasticSearch-基础概念"><span class="nav-number">4.</span> <span class="nav-text">0x03 ElasticSearch 基础概念</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-Elasticsearch-CRUDE-以及基本操作"><span class="nav-number">4.1.</span> <span class="nav-text">3.1 Elasticsearch CRUDE 以及基本操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#CURDE"><span class="nav-number">4.1.1.</span> <span class="nav-text">CURDE</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#结构化搜索"><span class="nav-number">4.1.2.</span> <span class="nav-text">结构化搜索</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#全文搜索"><span class="nav-number">4.1.3.</span> <span class="nav-text">全文搜索</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#聚集搜索"><span class="nav-number">4.1.4.</span> <span class="nav-text">聚集搜索</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x04-全文搜索的基本概念"><span class="nav-number">5.</span> <span class="nav-text">0x04 全文搜索的基本概念</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-全文搜索遇到的挑战"><span class="nav-number">5.1.</span> <span class="nav-text">4.1 全文搜索遇到的挑战</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-全文搜索的索引时与查询时"><span class="nav-number">5.2.</span> <span class="nav-text">4.2 全文搜索的索引时与查询时</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-索引时-ES-做了什么？"><span class="nav-number">5.2.1.</span> <span class="nav-text">1. 索引时 ES 做了什么？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-查询时-ES-做了什么？"><span class="nav-number">5.2.2.</span> <span class="nav-text">2. 查询时 ES 做了什么？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-全文搜索调优之中文分词"><span class="nav-number">5.2.3.</span> <span class="nav-text">3. 全文搜索调优之中文分词</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-全文搜索调优之停止词"><span class="nav-number">5.2.4.</span> <span class="nav-text">4. 全文搜索调优之停止词</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-全文搜索调优之同义词"><span class="nav-number">5.2.5.</span> <span class="nav-text">5. 全文搜索调优之同义词</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-全文搜索调优之拼写错误"><span class="nav-number">5.2.6.</span> <span class="nav-text">6. 全文搜索调优之拼写错误</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-全文搜索调优之相关性"><span class="nav-number">5.2.7.</span> <span class="nav-text">7. 全文搜索调优之相关性</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#索引时三因素"><span class="nav-number">5.2.7.1.</span> <span class="nav-text">索引时三因素</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#查询时"><span class="nav-number">5.2.7.2.</span> <span class="nav-text">查询时</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#计算公式"><span class="nav-number">5.2.7.3.</span> <span class="nav-text">计算公式</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x05-搜索语法"><span class="nav-number">6.</span> <span class="nav-text">0x05 搜索语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x06-Python-SDK"><span class="nav-number">7.</span> <span class="nav-text">0x06 Python SDK</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x07-踩坑集"><span class="nav-number">8.</span> <span class="nav-text">0x07 踩坑集</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0xEE-参考链接"><span class="nav-number">9.</span> <span class="nav-text">0xEE 参考链接</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2014 - 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Micheal Gardner</span>
</div>



        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="//cdn.jsdelivr.net/jquery/2.1.3/jquery.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/fastclick/1.0.6/fastclick.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/jquery.lazyload/1.9.3/jquery.lazyload.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/velocity/1.2.3/velocity.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/velocity/1.2.3/velocity.ui.min.js"></script>

  
  <script type="text/javascript" src="//cdn.jsdelivr.net/fancybox/2.1.5/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.1"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  





  






  





  

  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  
  <script type="text/javascript" src="/js/src/js.cookie.js?v=5.1.1"></script>
  <script type="text/javascript" src="/js/src/scroll-cookie.js?v=5.1.1"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->


  

</body>
</html>
