<!DOCTYPE html>
<html lang="zh-cn">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Shell CheatSheat - 海拉鲁编程客</title><meta name="Description" content="这篇文章展示了基本的 Markdown 语法和格式."><meta property="og:title" content="Shell CheatSheat" />
<meta property="og:description" content="这篇文章展示了基本的 Markdown 语法和格式." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://twocucao.xyz/posts/20150418_shellcheatsheet/" />
<meta property="article:published_time" content="2017-12-01T21:57:40+08:00" />
<meta property="article:modified_time" content="2020-01-01T16:45:40+08:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Shell CheatSheat"/>
<meta name="twitter:description" content="这篇文章展示了基本的 Markdown 语法和格式."/>
<meta name="application-name" content="海拉鲁编程客">
<meta name="apple-mobile-web-app-title" content="海拉鲁编程客"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://twocucao.xyz/posts/20150418_shellcheatsheet/" /><link rel="prev" href="http://twocucao.xyz/posts/20150317_%E6%89%87%E8%B4%9D%E8%83%8C%E5%8D%95%E8%AF%8D%E5%B0%8F%E5%8A%A9%E6%89%8B/" /><link rel="next" href="http://twocucao.xyz/posts/20150309_%E5%9B%BE%E7%89%87%E7%88%AC%E8%99%AB/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Shell CheatSheat",
        "inLanguage": "zh-cn",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/twocucao.xyz\/posts\/20150418_shellcheatsheet\/"
        },"genre": "posts","keywords": "Shell","wordcount":  1427 ,
        "url": "http:\/\/twocucao.xyz\/posts\/20150418_shellcheatsheet\/","datePublished": "2017-12-01T21:57:40+08:00","dateModified": "2020-01-01T16:45:40+08:00","publisher": {
            "@type": "Organization",
            "name": "twocucao"},"author": {
                "@type": "Person",
                "name": "twocucao"
            },"description": "这篇文章展示了基本的 Markdown 语法和格式."
    }
    </script></head>
    <body header-desktop="" header-mobile=""><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : '' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="海拉鲁编程客">海拉鲁编程客</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/categories/"> 分类 </a><a class="menu-item" href="/posts/"> 存档 </a><a class="menu-item" href="/tags/"> 标签 </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="海拉鲁编程客">海拉鲁编程客</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/categories/" title="">分类</a><a class="menu-item" href="/posts/" title="">存档</a><a class="menu-item" href="/tags/" title="">标签</a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">Shell CheatSheat</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="http://twocucao.xyz" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas"></i>twocucao</a></span>&nbsp;<span class="post-category">收录于 <a href="/categories/%E5%96%84%E7%94%A8%E4%BD%B3%E8%BD%AF/"><i class="far fa-folder fa-fw"></i>善用佳软</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2017-12-01">2017-12-01</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 1427 字&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 7 分钟&nbsp;</div>
        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://user-images.githubusercontent.com/5625783/100601457-8efe8a80-333d-11eb-803e-861352bd1715.jpg"
        data-srcset="https://user-images.githubusercontent.com/5625783/100601457-8efe8a80-333d-11eb-803e-861352bd1715.jpg, https://user-images.githubusercontent.com/5625783/100601457-8efe8a80-333d-11eb-803e-861352bd1715.jpg 1.5x, https://user-images.githubusercontent.com/5625783/100601457-8efe8a80-333d-11eb-803e-861352bd1715.jpg 2x"
        data-sizes="auto"
        alt="https://user-images.githubusercontent.com/5625783/100601457-8efe8a80-333d-11eb-803e-861352bd1715.jpg"
        title="这篇文章展示了基本的 Markdown 语法和格式." /></div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#0x00-前言">0x00 前言</a></li>
    <li><a href="#0x01-快捷键">0x01 快捷键</a></li>
    <li><a href="#0x02-帮助">0x02 帮助</a></li>
    <li><a href="#0x03-macos-用户">0x03 macOS 用户</a></li>
    <li><a href="#0x04-基本命令---old-fashion">0x04 基本命令 - old fashion</a>
      <ul>
        <li><a href="#文本篇">文本篇</a></li>
        <li><a href="#用户篇">用户篇</a></li>
        <li><a href="#网络篇">网络篇</a></li>
        <li><a href="#磁盘篇">磁盘篇</a></li>
        <li><a href="#进程管理">进程管理</a></li>
        <li><a href="#性能监控">性能监控</a></li>
        <li><a href="#内存瓶颈">内存瓶颈</a></li>
      </ul>
    </li>
    <li><a href="#0x06-资料推荐">0x06 资料推荐</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="0x00-前言">0x00 前言</h2>
<p>本文为 Cheatsheet 类型文章，用于记录我在日常编程中经常使用的 Shell 单行命令。</p>
<h2 id="0x01-快捷键">0x01 快捷键</h2>
<pre><code>- 「c-c」 : 中断当前命令。
- 「c-z」 : 当前程序暂停，bg 切换后台运行，使用 fg 可以调回
- 「tab」 : 补全
- 「tabx2」 : 补全提示
- 「c-r」 : 搜索命令行
- 「c-w」 : 同 vim
- 「c-u」 : 删除整行
- 「a-b/a-f」 : 移动一个词
- 「c-a」 : 移动至行首
- 「c-e」 : 移动至行尾
- 「c-k」 : 删除光标到行尾
- 「c-l」 : 清屏
- 「c-x,c-e」 : 用默认编辑器编辑当前命令（这样就可以把其他文本移动扔掉了。)
</code></pre><h2 id="0x02-帮助">0x02 帮助</h2>
<p>查找帮助</p>
<pre><code>- man
- whatis / which / where
- tldr
</code></pre><p>值得一提的就是 tldr, 直接可以在上面查看命令的常规使用。实在是碉堡了。</p>
<pre><code>&gt; tldr ssh
Local data is older than two weeks, use --update to update it.

ssh

Secure Shell is a protocol used to securely log onto remote systems.
It can be used for logging or executing commands on a remote server.

- Connect to a remote server:
    ssh username@remote_host

- Connect to a remote server with a specific identity (private key):
    ssh -i path/to/key_file username@remote_host

- Connect to a remote server using a specific port:
    ssh username@remote_host -p 2222

- Run a command on a remote server:
    ssh remote_host command -with -flags

- SSH tunneling: Dynamic port forwarding (SOCKS proxy on localhost:9999):
    ssh -D 9999 -C username@remote_host

- SSH tunneling: Forward a specific port (localhost:9999 to slashdot.org:80) along with disabling pseudo-[t]ty allocation and executio[n] of remote commands:
    ssh -L 9999:slashdot.org:80 -N -T username@remote_host

- SSH jumping: Connect through a jumphost to a remote server (Multiple jump hops may be specified separated by comma characters):
    ssh -J username@jump_host username@remote_host

- Agent forwarding: Forward the authentication information to the remote machine (see `man ssh_config` for available options):
    ssh -A username@remote_host
</code></pre><h2 id="0x03-macos-用户">0x03 macOS 用户</h2>
<p>如果你和我一样使用的是 mac 系统</p>
<p>可以考虑将部分 FreeBSD 的工具换成 gnu</p>
<pre><code>brew install autoconf bash binutils coreutils diffutils ed findutils flex gawk \
    gnu-indent gnu-sed gnu-tar gnu-which gpatch grep gzip less m4 make nano \
    screen watch wdiff wget
</code></pre><p>bashrc/zshrc 加上如下命令</p>
<pre><code>if type brew &amp;&gt;/dev/null; then
  HOMEBREW_PREFIX=$(brew --prefix)
  # gnubin; gnuman
  for d in ${HOMEBREW_PREFIX}/opt/*/libexec/gnubin; do export PATH=$d:$PATH; done
  # I actually like that man grep gives the BSD grep man page
  #for d in ${HOMEBREW_PREFIX}/opt/*/libexec/gnuman; do export MANPATH=$d:$MANPATH; done
fi
</code></pre><p>经过上面一步，则基本上 find sed tar which 这些命令使用的 gnu 版本 (linux 版本）, 而非系统自带的 unix 版本了。</p>
<h2 id="0x04-基本命令---old-fashion">0x04 基本命令 - old fashion</h2>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">文件 / 目录 mkdir / rm
查找文件 <span class="nb">cd</span> / cp / <span class="nb">pwd</span> / find
查看文件 more / less / tail / diff / cat / grep
用户权限 chown / chmod
复制 / 粘贴 / 同步 / 链接 cp / rsync / ln
挂载 mount
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 创建和删除</span>
mkdir
mkdir -p a/b/c

rm
rm -rf dir/file/regex
rm *log# 等价 find ./ -name <span class="s2">&#34;*log&#34;</span> -exec rm <span class="o">{}</span><span class="p">;</span>

mv
cp
cp -r source_dir dest_dir
rsync --progress -a source_dir dest_dir
rsync -vr --progress you_folder_here twocucao@192.168.2.151:/Users/twocucao/Codes/# 目录切换 ls -lrt
find ./ -name <span class="s2">&#34;*.o&#34;</span> -exec rm <span class="o">{}</span> <span class="se">\;</span>
more
head
tail
tail -f filename
diff
chown
chmod
chown -R tuxapp source/chmod a+x myscript
ln cc ccA
ln -s cc ccTo
cat -v record.log <span class="p">|</span> grep AAA <span class="p">|</span> grep -v BBB <span class="p">|</span> wc -l
find ./ <span class="p">|</span> wc -l
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">查找文件之 find <span class="o">(</span>gfind<span class="o">)</span>
<span class="c1">## Find</span>
find . <span class="se">\(</span> -name <span class="s2">&#34;*.txt&#34;</span> -o -name <span class="s2">&#34;*.pdf&#34;</span> <span class="se">\)</span> -print
<span class="c1"># 正则方式查找 txt 和 pdf</span>
find . -regex  <span class="s2">&#34;.*\(\.txt|\.pdf\)</span>$<span class="s2">&#34;</span>
find . ! -name <span class="s2">&#34;*.txt&#34;</span> -print
find . -maxdepth <span class="m">1</span> -type f
<span class="c1"># 定制搜索</span>
<span class="c1">## 按照类型搜索</span>
find . -type f -print  <span class="c1">#只列出所有文件</span>
find . -type d -print  <span class="c1">#只列出所有目录</span>
find . -type l -print  <span class="c1">#只列出所有符号链接</span>
<span class="c1">## 按照时间搜索</span>
find . -atime <span class="m">7</span> -type f -print
<span class="c1"># 最近第 7 天被访问过的所有文件：</span>
find . -atime -7 -type f -print
<span class="c1"># 最近 7 天内被访问过的所有文件：</span>
find . -atime +7 <span class="nb">type</span> f -print
<span class="c1"># 查询 7 天前被访问过的所有文件：</span>
<span class="c1"># w,k,M,Gfind . -type f -size +2kfind . -type f -perm 644 -print </span>
<span class="c1"># 找具有可执行权限的所有文件 find . -type f -user weber -print</span>
<span class="c1"># 找用户 weber 所拥有的文件</span>
<span class="c1"># 后续动作</span>
<span class="c1">## 删除 find . -type f -name &#34;*.swp&#34; -delete</span>
<span class="c1">## 执行动作</span>
find . -type f -name <span class="s2">&#34;*.swp&#34;</span> <span class="p">|</span> xargs rmfind . -type f -user root -exec chown weber <span class="o">{}</span> <span class="se">\;</span>
<span class="c1">## eg: copy 到另一个目录</span>
find . -type f -mtime +10 -name <span class="s2">&#34;*.txt&#34;</span> -exec cp <span class="o">{}</span> OLD <span class="se">\;</span>
<span class="c1">##  -exec ./commands.sh {} \;</span>
<span class="c1"># 2. 删除内部为空的文件夹# 递归删除 a/b/c</span>
find . -type d -empty -delete
<span class="c1"># 使用.gitkeep 进行填充</span>
find . -type d -empty -exec touch <span class="o">{}</span>/.gitkeep <span class="se">\;</span>
find . -type d -empty -not -path <span class="s1">&#39;*/\.*&#39;</span> -exec touch <span class="o">{}</span>/.gitkeep <span class="se">\;</span>
<span class="c1"># 不初始化.git/</span>
<span class="c1"># 3. 寻找 TOP 10</span>
find . -type f -printf <span class="s1">&#39;%s %p\n&#39;</span><span class="p">|</span> sort -nr <span class="p">|</span> head -10 <span class="p">|</span> awk <span class="s1">&#39;{$1/=1024*1024;printf &#34;%.2fMB - %s\n&#34;,$1,$2}&#39;</span>
<span class="c1"># 4. 寻找文件夹 TOP 10</span>
<span class="o">{}</span>: A placeholder token that will be replaced with the path of the search result <span class="o">(</span>documents/images/party.jpg<span class="o">)</span>.<span class="o">{</span>.<span class="o">}</span>: Like <span class="o">{}</span>, but without the file extension <span class="o">(</span>documents/images/party<span class="o">)</span>.<span class="o">{</span>/<span class="o">}</span>: A placeholder that will be replaced by the basename of the search result <span class="o">(</span>party.jpg<span class="o">)</span>.<span class="o">{</span>//<span class="o">}</span>: Uses the parent of the discovered path <span class="o">(</span>documents/images<span class="o">)</span>.<span class="o">{</span>/.<span class="o">}</span>: Uses the basename, with the extension removed <span class="o">(</span>party<span class="o">)</span>.# Convert all jpg files to png files:fd -e jpg -x convert <span class="o">{}</span> <span class="o">{</span>.<span class="o">}</span>.png# Unpack all zip files <span class="o">(</span><span class="k">if</span> no placeholder is given, the path is appended<span class="o">)</span>:fd -e zip -x unzip# Convert all flac files into opus files:fd -e flac -x ffmpeg -i <span class="o">{}</span> -c:a libopus <span class="o">{</span>.<span class="o">}</span>.opus# Count the number of lines in Rust files <span class="o">(</span>the <span class="nb">command</span> template can be terminated with <span class="s1">&#39;;&#39;</span><span class="o">)</span>:fd -x wc -l <span class="se">\;</span> -e rs
</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 压缩 / 解压缩</span>
7z / 7za /7zr
tar / gzip / unzip/ unrar
<span class="c1"># 打包</span>
tar -cvf
<span class="c1"># 解包</span>
tar -xvf
<span class="c1"># 压缩</span>
gzip
<span class="c1"># 解压缩</span>
gunzip
bzip
tar 是将多个文件放在一起变成一个 tar 文件 <span class="o">(</span>Tape Archiver<span class="o">)</span>
gzip 是讲一个文件变成一个压缩文件
则 foo.tar.gz 指的是 先把文件转为 tar 文件，然后 gzip 之
</code></pre></div><h3 id="文本篇">文本篇</h3>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">grep match_pattern file

	-o 只输出匹配的文本行
	-v 只输出没有匹配的文本行
	-c 统计文件中包含文本的次数
	-n 打印匹配行号
	-i 搜索时符合大小写
	-l 之打印文件名

grep <span class="s2">&#34;class&#34;</span> . -R -n <span class="c1"># 多级目录中对文本递归搜索</span>
grep -e <span class="s2">&#34;class&#34;</span> -e <span class="s2">&#34;vitural&#34;</span> file <span class="c1"># 匹配多个模式</span>
grep <span class="s2">&#34;test&#34;</span> file* -lZ<span class="p">|</span> xargs -0 rm <span class="c1"># grep 输出以、0 作为结尾符的文件名：（-z）-d 定义定界符-n 输出为多行-l {} 指定替换字符串 cat file.txt | xargs # 打印多行 cat file.txt | xargs -n 3 # 分割多行</span>
cat file.txt <span class="p">|</span> xargs -I <span class="o">{}</span> ./command.sh -p <span class="o">{}</span> -1-0 指定、0 为输入定界符
find source_dir/ -type f -name <span class="s2">&#34;*.cpp&#34;</span> -print0 <span class="p">|</span>xargs -0 wc -l

<span class="c1"># sort 排序</span>

-n 按数字进行排序
-d 按字典序进行排序
-r 逆序排序
-k N 指定按照第 N 列排序
sort -nrk <span class="m">1</span> data.txtsort -bd data // 忽略像空格之类的前导空白字符
sort unsort.txt <span class="p">|</span> uniq &gt; sorted.txt <span class="c1"># 消除重复行</span>
sort unsort.txt <span class="p">|</span> uniq -c <span class="c1"># 统计各行在文件中出现的次数</span>
sort unsort.txt <span class="p">|</span> uniq -d <span class="c1"># 找出重复行# 用 tr 进行转换</span>

<span class="c1"># cut 按列切分文本 cut -f2,4 filename</span>
<span class="c1"># 截取文件的第 2 列和第 4 列 cut -f3 --complement filename #去文件除第 3 列的所有列 cut -f2 -d&#34;;&#34; filename -d #指定定界符 cut -c1-5 file</span>
<span class="c1"># 打印第一到 5 个字符 cut -c-2 file </span>
<span class="c1"># 打印前 2 个字符# paste 按列拼接文本 paste file1 file2 -d &#34;,&#34;</span>

<span class="c1"># wc 统计行和字符的工具 wc -l file # 统计行数 wc -w file # 统计单词数 wc -c file # 统计字符数</span>

<span class="c1"># sed 文本替换利器 sed &#39;s/text/replace_text/&#39; file </span>
<span class="c1"># 首处替换 sed &#39;s/text/replace_text/g&#39; file </span>
<span class="c1"># 全局替换 sed -i &#39;s/text/repalce_text/g&#39; file # 替换文件 sed &#39;/^$/d&#39; file </span>
<span class="c1"># 移除空白行 sed -i &#39;s/twocucao/micheal/g&#39; xx.dump.sqlsed -n 634428,887831p insert_doc_ids_new.sql &gt; uninserted_sql.sql</span>
</code></pre></div><h3 id="用户篇">用户篇</h3>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 添加 yaweb 为 sudo 用户</span>
usermod -aG sudo yaweb
所有用户和用户组信息保存在：/etc/passwd , /etc/group
用户
useradd -m yaweb <span class="c1"># 创建相关账号，和用户目录 /home/yawebpasswd yawebuserdel -r yaweb # 删除</span>
用户组
usermod -g groupName username <span class="c1"># 变更组 usermod -G groupName username # 添加到组 usermod -aG sudo yaweb # 添加 yaweb 到 sudo 组</span>
用户权限
chown userMark<span class="o">(</span>+<span class="p">|</span>-<span class="o">)</span>PermissionsMark
userMark 取值： - u：用户 - g：组 - o：其它用户 - a：所有用户
PermissionsMark 取值： - r: 读 - w：写 - x：执行
chmod a+x main         对所有用户给文件 main 增加可执行权限 chmod g+w blogs        对组用户给文件 blogs 增加可写权限 chown -R weber server/
远程登录
ssh -l root 192.168.2.253
ssh-copy-id root@192.168.2.253
</code></pre></div><h3 id="网络篇">网络篇</h3>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">/etc/hostname
/etc/hosts
netstat -a
</code></pre></div><h3 id="磁盘篇">磁盘篇</h3>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 查看当前目录大小</span>
du -sh
du -sh <span class="sb">`</span>ls<span class="sb">`</span> <span class="p">|</span> sort
<span class="c1"># 查看当前目录的下一级文件和子目录的磁盘容量</span>
du -lh --max-depth<span class="o">=</span><span class="m">1</span>
</code></pre></div><h3 id="进程管理">进程管理</h3>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">ps -ef <span class="p">|</span> grep twocucao ps -lu twocucao <span class="c1"># 完整显示</span>
ps -ajx
ps au <span class="p">|</span> grep phantomjs <span class="p">|</span> awk <span class="s1">&#39;{ print $2 }&#39;</span> <span class="p">|</span> xargs <span class="nb">kill</span> -9 
top htop 
lsof -i:3306
lsof -u twocucao 
<span class="nb">kill</span> -9 pidnum 
<span class="c1"># 将用户 colin115 下的所有进程名以 av_开头的进程终止</span>
ps -u colin115 <span class="p">|</span>  awk <span class="s1">&#39;/av_/ {print &#34;kill -9 &#34; $1}&#39;</span> <span class="p">|</span> sh
<span class="c1"># 将用户 colin115 下所有进程名中包含 HOST 的进程终止：</span>
ps -fe <span class="p">|</span> grep colin115 <span class="p">|</span> grep HOST <span class="p">|</span> awk <span class="s1">&#39;{print $2}&#39;</span> <span class="p">|</span> xargs <span class="nb">kill</span> -9<span class="p">;</span>
</code></pre></div><p>Systemd
创建一个 Systemd 服务</p>
<pre><code># /etc/systemd/system/gunicorn.service: 

[Unit]
Description=gunicorn daemon
Requires=gunicorn.socket
After=network.target 

[Service]
PIDFile=/run/gunicorn/pid
User=someuser
Group=someuser
RuntimeDirectory=gunicorn
WorkingDirectory=/home/someuser/applicationroot
ExecStart=/usr/bin/gunicorn --pid /run/gunicorn/pid  
\\           --bind unix:/run/gunicorn/socket applicationname.wsgi
ExecReload=/bin/kill -s HUP $MAINPID
ExecStop=/bin/kill -s TERM $MAINPID PrivateTmp=true 

[Install]
WantedBy=multi-user.target
</code></pre><h3 id="性能监控">性能监控</h3>
<h3 id="内存瓶颈">内存瓶颈</h3>
<pre><code>htop
free # 从 /proc/meminfo 读取数据
IO 瓶颈
# ubuntu 下 可以 mac 下不可以 iostat -d -x -k 1 1
如果 %iowait 的值过高，表示硬盘存在 I/O 瓶颈。
如果 %util 接近 100%，说明产生的 I/O 请求太多，I/O 系统已经满负荷，该磁盘可能存在瓶颈。
如果 svctm 比较接近 await，说明 I/O 几乎没有等待时间；
如果 await 远大于 svctm，说明 I/O 队列太长，io 响应太慢，则需要进行必要优化。
如果 avgqu-sz 比较大，也表示有大量 io 在等待。
</code></pre><h2 id="0x06-资料推荐">0x06 资料推荐</h2>
<ul>
<li>一个关于 Linux 命令的各种奇技的网站 <a href="http://www.commandlinefu.com/commands/browse">http://www.commandlinefu.com/commands/browse</a></li>
<li>Linux 工具快速教程 <a href="http://linuxtools-rst.readthedocs.org/zh_CN/latest/index.html">http://linuxtools-rst.readthedocs.org/zh_CN/latest/index.html</a></li>
<li>一个 Awesome List, <a href="https://github.com/jaywcjlove/linux-command">https://github.com/jaywcjlove/linux-command</a></li>
<li>命令行的艺术 <a href="https://github.com/jlevy/the-art-of-command-line">https://github.com/jlevy/the-art-of-command-line</a></li>
<li>man command 需要好好研读，特别是 man bash 至少要研读几遍</li>
</ul>
<hr>
<p>ChangeLog:</p>
<ul>
<li><strong>2015-04-18</strong> 初始化本文</li>
<li><strong>2018-08-28</strong> 重修文字</li>
<li><strong>2020-10-24</strong> 重修文字</li>
</ul>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2020-01-01</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/shell/">Shell</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/20150317_%E6%89%87%E8%B4%9D%E8%83%8C%E5%8D%95%E8%AF%8D%E5%B0%8F%E5%8A%A9%E6%89%8B/" class="prev" rel="prev" title="背单词小助手"><i class="fas fa-angle-left fa-fw"></i>背单词小助手</a>
            <a href="/posts/20150309_%E5%9B%BE%E7%89%87%E7%88%AC%E8%99%AB/" class="next" rel="next" title="Python 图片爬虫">Python 图片爬虫<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.79.0">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2020</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="http://twocucao.xyz" target="_blank">twocucao</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":10},"comment":{}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
