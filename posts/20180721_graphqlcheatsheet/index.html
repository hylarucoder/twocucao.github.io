<!DOCTYPE html>
<html lang="zh-cn">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>GraphQL CheetSheet - 海拉鲁编程客</title><meta name="Description" content="这篇文章展示了基本的 Markdown 语法和格式."><meta property="og:title" content="GraphQL CheetSheet" />
<meta property="og:description" content="这篇文章展示了基本的 Markdown 语法和格式." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://twocucao.xyz/posts/20180721_graphqlcheatsheet/" />
<meta property="article:published_time" content="2018-07-21T21:57:40+08:00" />
<meta property="article:modified_time" content="2020-01-01T16:45:40+08:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="GraphQL CheetSheet"/>
<meta name="twitter:description" content="这篇文章展示了基本的 Markdown 语法和格式."/>
<meta name="application-name" content="海拉鲁编程客">
<meta name="apple-mobile-web-app-title" content="海拉鲁编程客"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://twocucao.xyz/posts/20180721_graphqlcheatsheet/" /><link rel="prev" href="http://twocucao.xyz/posts/20180718_portrait/" /><link rel="next" href="http://twocucao.xyz/posts/20180727_tonecolor/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "GraphQL CheetSheet",
        "inLanguage": "zh-cn",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/twocucao.xyz\/posts\/20180721_graphqlcheatsheet\/"
        },"genre": "posts","keywords": "GraphQL, Restful","wordcount":  328 ,
        "url": "http:\/\/twocucao.xyz\/posts\/20180721_graphqlcheatsheet\/","datePublished": "2018-07-21T21:57:40+08:00","dateModified": "2020-01-01T16:45:40+08:00","publisher": {
            "@type": "Organization",
            "name": "twocucao"},"author": {
                "@type": "Person",
                "name": "twocucao"
            },"description": "这篇文章展示了基本的 Markdown 语法和格式."
    }
    </script></head>
    <body header-desktop="" header-mobile=""><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : '' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="海拉鲁编程客">海拉鲁编程客</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/categories/"> 分类 </a><a class="menu-item" href="/posts/"> 存档 </a><a class="menu-item" href="/tags/"> 标签 </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="海拉鲁编程客">海拉鲁编程客</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/categories/" title="">分类</a><a class="menu-item" href="/posts/" title="">存档</a><a class="menu-item" href="/tags/" title="">标签</a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">GraphQL CheetSheet</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="http://twocucao.xyz" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas"></i>twocucao</a></span>&nbsp;<span class="post-category">收录于 <a href="/categories/web-%E5%BC%80%E5%8F%91/"><i class="far fa-folder fa-fw"></i>Web 开发</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2018-07-21">2018-07-21</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 328 字&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 2 分钟&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#0x00-前言">0x00 前言</a></li>
    <li><a href="#0x01-开接口这件小事情">0x01 开接口这件小事情</a>
      <ul>
        <li><a href="#开接口注意点">开接口注意点</a></li>
        <li><a href="#开接口不能解决的问题">开接口不能解决的问题</a></li>
      </ul>
    </li>
    <li><a href="#0x02-graphql-相关概念">0x02 GraphQL 相关概念</a>
      <ul>
        <li><a href="#graphql-是什么">GraphQL 是什么？</a></li>
        <li><a href="#graphql-好处">GraphQL 好处</a></li>
      </ul>
    </li>
    <li><a href="#0x03-graphql-客户端怎么做">0x03 GraphQL 客户端怎么做？</a></li>
    <li><a href="#0x04-graphql-python-服务端怎么做">0x04 GraphQL Python 服务端怎么做？</a></li>
    <li><a href="#0x05-graphql-解决的痛点与坑">0x05 GraphQL 解决的痛点与坑</a></li>
    <li><a href="#0x06-其他思考点">0x06 其他思考点</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="0x00-前言">0x00 前言</h2>
<p>不定期更新。</p>
<!-- raw HTML omitted -->
<h2 id="0x01-开接口这件小事情">0x01 开接口这件小事情</h2>
<p>开接口，究竟什么样的接口才是一个好接口？</p>
<ol>
<li>刚开始的时候，后台开接口都是比较随便，本着方便，快速的方式一个一个接口的开。</li>
<li>后来呢？觉得接口开出来没有最佳实践，所以有人提出 Restful 的开接口姿势。 Swagger, DjangorestFramework, 以及 Apistar 便是这种最佳实践的代表性项目</li>
<li>再后来呢？Facebook 又搞了套自己的开接口姿势叫做 GraphQL, graphene-python , graphene-js , apollo-client , apollo-server 便是这种最佳实践的代表性项目</li>
</ol>
<h3 id="开接口注意点">开接口注意点</h3>
<ol>
<li>尽量做到代码即文档。</li>
<li>便于前端调试。</li>
<li>分页处理。</li>
<li>API 版本管理。</li>
<li>额外的语义。</li>
<li>校验。</li>
<li>权限。</li>
</ol>
<p>不管是 Restful 的实现，还是 GraphQL 的实现，在 1/2/5 上面做的非常优秀了。</p>
<p>拿 Restful 的实现 DjangoRestframework 来说，直接可以在 ApiView 的注释里面写 Markdown 语法，兼容 payload 和 form 表单调试。内置 Serializer 进行序列化和校验。</p>
<p>DRF 还是一个功能非常全面的框架。 PS: 如果你是不折腾的 Django 用户，DRF 绝对让你欲罢不能。</p>
<h3 id="开接口不能解决的问题">开接口不能解决的问题</h3>
<blockquote>
<p>业务逻辑的沟通问题</p>
</blockquote>
<p>抛开前后端分离所带来的优点，前后端分离的一大问题就是，前后端人员的分离。</p>
<p>如果你的公司规模不是很大，开发的项目需要一定的背景知识，团队开发比较（经常）敏（调整）捷（需求）, 沟通上就会有些问题，</p>
<p>具体表现为，后端理解了需求，还需要和前端讲清楚，而刚讲清楚没几天，产品又跑过来说，这个业务我们需要调整一下。几次折腾下来，就会出现一个尴尬的局面。</p>
<p>前后端有的时候对业务理解出现来偏差。在以前不区分前后端的时候，一个东西到实现基本上一个人就可以 Cover 掉，只要这个人理解了业务逻辑，就行了。现在前后端分离，就要求前后端对需求的理解</p>
<p>如果需求不明确，就会出现如下情况，前端一脸懵逼的问后端与产品『眼前的黑不是黑，你说的白是什么白』</p>
<p>当然，这个不属于技术问题，只是提一下。</p>
<h2 id="0x02-graphql-相关概念">0x02 GraphQL 相关概念</h2>
<h3 id="graphql-是什么">GraphQL 是什么？</h3>
<p>GraphQL 也不是什么革命性的产品，不过是一种新的开 Web 接口的方式罢了。</p>
<p>而请求接口提交的参数也变成了包含参数的一种查询语言。</p>
<p>官方宣传的 GraphQL 搞好了，只需如此：</p>
<pre><code># Step1. 描述你的数据

type Project {
  name: String
  tagline: String
  contributors: [User]
}

# Step2. 请求所需数据。

{
  project(name: &quot;GraphQL&quot;) {
    tagline
  }
}

# Step3. 拿到所需数据。

{
  &quot;project&quot;: {
    &quot;tagline&quot;: &quot;A query language for APIs&quot;
  }
}
</code></pre><p>嗯，是不是和 SQL 看起来有点像？当然咯，都是查询语言 (QL) 嘛。</p>
<h3 id="graphql-好处">GraphQL 好处</h3>
<p>GraphQL 的好处，自然是前端写起来就是一个字，爽。</p>
<p>比如我们使用 Github 的 API 做一个简单的查询</p>
<p>地址如下 <a href="https://developer.github.com/v4/explorer/">https://developer.github.com/v4/explorer/</a></p>
<p>查询如下</p>
<pre><code>query {
  viewer {
    login
    bio
    repositories(first:10, orderBy : { field: STARGAZERS, direction: DESC}   ) {
      nodes {
        nameWithOwner
        viewerHasStarred
        watchers {
          totalCount
        }
        stargazers {
          totalCount
        }
      }
      totalCount
    }
  }
}
</code></pre><p>结果如下</p>
<pre><code>{
  &quot;data&quot;: {
    &quot;viewer&quot;: {
      &quot;login&quot;: &quot;twocucao&quot;,
      &quot;bio&quot;: &quot;Pythonist In Shanghai.&quot;,
      &quot;repositories&quot;: {
        &quot;nodes&quot;: [
          {
            &quot;nameWithOwner&quot;: &quot;twocucao/danmu.fm&quot;,
            &quot;viewerHasStarred&quot;: true,
            &quot;watchers&quot;: {
              &quot;totalCount&quot;: 22
            },
            &quot;stargazers&quot;: {
              &quot;totalCount&quot;: 282
            }
          },
          {
            &quot;nameWithOwner&quot;: &quot;twocucao/YaDjangoBlog&quot;,
            &quot;viewerHasStarred&quot;: true,
            &quot;watchers&quot;: {
              &quot;totalCount&quot;: 9
            },
            &quot;stargazers&quot;: {
              &quot;totalCount&quot;: 120
            }
          },
          {
            &quot;nameWithOwner&quot;: &quot;twocucao/danmu&quot;,
            &quot;viewerHasStarred&quot;: true,
            &quot;watchers&quot;: {
              &quot;totalCount&quot;: 5
            },
            &quot;stargazers&quot;: {
              &quot;totalCount&quot;: 64
            }
          }
        ],
        &quot;totalCount&quot;: 33
      }
    }
  }
}
</code></pre><p>如果你说，我还要看看这个 repo 的主要语言，那么增加一行查询即可。</p>
<pre><code>query {
  viewer {
    login
    bio
    repositories(first:3, orderBy : { field: STARGAZERS, direction: DESC}   ) {
      nodes {
        nameWithOwner
        viewerHasStarred
        languages(first: 3) { # 在这里增加查询编程语言
          nodes {
            name
          }
        }
        watchers {
          totalCount
        }
        stargazers {
          totalCount
        }
      }
      totalCount
    }
  }
}
</code></pre><p>依照这个简单的查询，可以看出 GraphQL 的便捷之处。后端编写完毕之后，前端基本上就可以对着 Schemas 里面的 query 查询完毕了。</p>
<p>查询这么搞可以，增删改查之类的操作呢？GraphQL 里面还有 Mutation 可以帮你解决这个问题，在后端定义完 Mutation , 前端在 Mutation 里面可以直接传参。</p>
<p>就像这样。</p>
<h2 id="0x03-graphql-客户端怎么做">0x03 GraphQL 客户端怎么做？</h2>
<h2 id="0x04-graphql-python-服务端怎么做">0x04 GraphQL Python 服务端怎么做？</h2>
<h2 id="0x05-graphql-解决的痛点与坑">0x05 GraphQL 解决的痛点与坑</h2>
<h2 id="0x06-其他思考点">0x06 其他思考点</h2>
<ul>
<li>埋点</li>
</ul>
<h1 id="0xee-参考链接">0xEE 参考链接</h1>
<ul>
<li><a href="https://github.com/wsargent/docker-cheat-sheet">https://github.com/wsargent/docker-cheat-sheet</a></li>
</ul>
<hr>
<p>ChangeLog:</p>
<ul>
<li><strong>2017-01-20</strong> 初始化本文</li>
</ul>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2020-01-01</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/graphql/">GraphQL</a>,&nbsp;<a href="/tags/restful/">Restful</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/20180718_portrait/" class="prev" rel="prev" title="人像摄影指北"><i class="fas fa-angle-left fa-fw"></i>人像摄影指北</a>
            <a href="/posts/20180727_tonecolor/" class="next" rel="next" title="Tone Color">Tone Color<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.79.0">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2020</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="http://twocucao.xyz" target="_blank">twocucao</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":10},"comment":{}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
